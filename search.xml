<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>ES6特性</title>
    <url>/2020/07/23/ES6%E7%89%B9%E6%80%A7/</url>
    <content><![CDATA[<p><img src="https://cdn.jsdelivr.net/gh/liebexiao/myImgs/20200727103629.png" alt="bf096b63f6246b6096ef25d8e7f81a4c500fa2bd"></p>
<a id="more"></a>

<h3 id="一、let、var、const"><a href="#一、let、var、const" class="headerlink" title="一、let、var、const"></a>一、let、var、const</h3><ul>
<li>const 声明一个只读的常量，一单声明，常量的值不能改变，要初始化常量</li>
</ul>
<h4 id="1、let-和-var区别"><a href="#1、let-和-var区别" class="headerlink" title="1、let 和 var区别"></a>1、let 和 var区别</h4><ul>
<li><p>let不存在变量提升</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(a) </span><br><span class="line"><span class="keyword">var</span> a=<span class="string">'1'</span>; <span class="comment">//输出undefined</span></span><br><span class="line"><span class="comment">//var有一个预解析过程;;相当于</span></span><br><span class="line"><span class="keyword">var</span> a;</span><br><span class="line"><span class="built_in">console</span>.log(a) </span><br><span class="line">a=<span class="string">'1'</span>; <span class="comment">//输出undefined</span></span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(a) </span><br><span class="line"><span class="keyword">let</span> a=<span class="string">'1'</span>; <span class="comment">//报错</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>同一拿作用域下不能重复定义同一个名称</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> b=<span class="number">10</span>;</span><br><span class="line"><span class="keyword">var</span> b=<span class="number">100</span>;<span class="comment">//输出100</span></span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> b=<span class="number">10</span>;</span><br><span class="line"><span class="keyword">let</span> b=<span class="number">100</span>;<span class="comment">//报错</span></span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> b=<span class="number">10</span>;</span><br><span class="line">b=<span class="number">100</span>;<span class="comment">//输出100</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>有着严格的作用域，var 属于函数作用域，let属于块级作用域。</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> c=<span class="number">10</span>;</span><br><span class="line">    <span class="keyword">if</span>(<span class="literal">true</span>)&#123;</span><br><span class="line">       <span class="keyword">var</span> c=<span class="number">100</span>;</span><br><span class="line">       &#125;</span><br><span class="line">    <span class="built_in">console</span>.log(c);</span><br><span class="line">&#125;</span><br><span class="line">test();<span class="comment">//输出100</span></span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="comment">//函数作用域</span></span><br><span class="line">    <span class="keyword">let</span> c=<span class="number">10</span>;</span><br><span class="line">    <span class="keyword">if</span>(<span class="literal">true</span>)&#123;</span><br><span class="line">        <span class="comment">//块级作用域</span></span><br><span class="line">       <span class="keyword">let</span> c=<span class="number">100</span>;</span><br><span class="line">       &#125;</span><br><span class="line">    <span class="built_in">console</span>.log(c);</span><br><span class="line">   </span><br><span class="line">&#125;</span><br><span class="line">test();<span class="comment">//输出10；；此时输出的值为函数作用域的c值，与if中的没有关系。</span></span><br></pre></td></tr></table></figure>

</li>
</ul>
<h3 id="二、函数"><a href="#二、函数" class="headerlink" title="二、函数"></a>二、函数</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> f=<span class="function"><span class="params">v</span>=&gt;</span>v1; <span class="comment">//变量名=参数=&gt;返回值（函数体）</span></span><br><span class="line"><span class="comment">//展开</span></span><br><span class="line"><span class="keyword">let</span> f(v)&#123;</span><br><span class="line">    <span class="keyword">return</span> v1;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



]]></content>
      <categories>
        <category>ES6</category>
      </categories>
      <tags>
        <tag>js</tag>
      </tags>
  </entry>
  <entry>
    <title>WxParse富文本解析</title>
    <url>/2020/09/04/WxParse%E5%AF%8C%E6%96%87%E6%9C%AC%E8%A7%A3%E6%9E%90/</url>
    <content><![CDATA[<p><img src="https://cdn.jsdelivr.net/gh/liebexiao/myImgs/20200904214529.png" alt=""></p>
<a id="more"></a>

<h3 id="一、下载-WxParse"><a href="#一、下载-WxParse" class="headerlink" title="一、下载 WxParse"></a>一、下载 WxParse</h3><p>GitHub 网站 <a href="https://github.com/icindy/wxParse" target="_blank" rel="noopener">https://github.com/icindy/wxParse</a></p>
<p>将下载下来的文件放在 pages 文件夹下面。</p>
<p><img src="https://cdn.jsdelivr.net/gh/liebexiao/myImgs/20200904213130.png" alt=""></p>
<h3 id="二、引用"><a href="#二、引用" class="headerlink" title="二、引用"></a>二、引用</h3><h4 id="1、js"><a href="#1、js" class="headerlink" title="1、js"></a>1、js</h4><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> WxParse = <span class="built_in">require</span>(<span class="string">"../../wxParse/wxParse.js"</span>);</span><br></pre></td></tr></table></figure>

<p>其中 <strong>data.content</strong> 为要解析的文本。</p>
<blockquote>
<p>//**</p>
<ul>
<li><p>WxParse.wxParse(bindName , type, data, target,imagePadding)</p>
</li>
<li><p>1.bindName绑定的数据名(必填)</p>
</li>
<li><p>2.type可以为html或者md(必填)</p>
</li>
<li><p>3.data为传入的具体数据(必填)</p>
</li>
<li><p>4.target为Page对象,一般为this(必填)</p>
</li>
<li><p>5.imagePadding为当图片自适应是左右的单一padding(默认为0,可选)</p>
</li>
</ul>
<p>*/</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">WxParse.wxParse(<span class="string">"content"</span>, <span class="string">"html"</span>, data.content, that, <span class="number">5</span>);</span><br></pre></td></tr></table></figure>

<h4 id="2、wxml"><a href="#2、wxml" class="headerlink" title="2、wxml"></a>2、wxml</h4><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">import</span> <span class="attr">src</span>=<span class="string">"../../wxParse/wxParse.wxml"</span> /&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"news_content"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">template</span> <span class="attr">is</span>=<span class="string">"wxParse"</span> <span class="attr">data</span>=<span class="string">"&#123;&#123;wxParseData:content.nodes&#125;&#125;"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>wx小程序</category>
      </categories>
      <tags>
        <tag>js</tag>
      </tags>
  </entry>
  <entry>
    <title>keep-alive保持页面活性</title>
    <url>/2020/07/15/keep-alive%E4%BF%9D%E6%8C%81%E9%A1%B5%E9%9D%A2%E6%B4%BB%E6%80%A7/</url>
    <content><![CDATA[<p><strong>keep-alive</strong>是 Vue 内置的一个组件，可以使被包含的组件保留状态</p>
<p><img src="https://s1.ax1x.com/2020/07/17/Uyr0UI.png" alt=""></p>
<a id="more"></a>

<h3 id="一、一般的保持活性"><a href="#一、一般的保持活性" class="headerlink" title="一、一般的保持活性"></a><strong>一、一般的保持活性</strong></h3><p>在页面翻页时进入另一页返回之后仍在原始页。</p>
<h4 id="1、在-App-vue-里面"><a href="#1、在-App-vue-里面" class="headerlink" title="1、在 App.vue 里面"></a>1、<strong>在 App.vue 里面</strong></h4><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">router-view</span> <span class="attr">v-if</span>=<span class="string">"!$route.meta.keepAlive"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">keep-alive</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">router-view</span> <span class="attr">v-if</span>=<span class="string">"$route.meta.keepAlive"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">keep-alive</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="2、在-router-js-里面使用-meta"><a href="#2、在-router-js-里面使用-meta" class="headerlink" title="2、在 router.js 里面使用 meta"></a>2、<strong>在 router.js 里面使用 meta</strong></h4><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">           path: <span class="string">"/manage/market/groupSet"</span>,<span class="comment">//拼团设置</span></span><br><span class="line">           name: <span class="string">"groupSet"</span>,</span><br><span class="line">           component: groupSet,</span><br><span class="line">           meta: &#123;</span><br><span class="line">               keepAlive: <span class="literal">true</span></span><br><span class="line">           &#125;,</span><br><span class="line">       &#125;,</span><br></pre></td></tr></table></figure>

<h3 id="二、根据链接选择性保持活性"><a href="#二、根据链接选择性保持活性" class="headerlink" title="二、根据链接选择性保持活性"></a><strong>二、根据链接选择性保持活性</strong></h3><p>从 /test 链接过来的保持页面活性。配合上面<strong>keepAlive</strong>一起使用</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">beforeRouteEnter(to, <span class="keyword">from</span>, next) &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">from</span>.path == <span class="string">"/test"</span>) &#123;</span><br><span class="line">                to.meta.isBack = <span class="literal">true</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                to.meta.isBack = <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            next();</span><br><span class="line">        &#125;,</span><br><span class="line">activated() &#123;</span><br><span class="line">            <span class="keyword">if</span> (!<span class="keyword">this</span>.$route.meta.isBack) &#123;</span><br><span class="line">                <span class="comment">//不保持页面活性</span></span><br><span class="line">                <span class="keyword">this</span>.keyword=<span class="string">''</span>;<span class="comment">/*清空查询条件*/</span></span><br><span class="line">                <span class="keyword">this</span>.loadList();<span class="comment">/*列表重新加载*/</span></span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="comment">//保持页面活性</span></span><br><span class="line">                <span class="keyword">this</span>.$route.meta.isBack = <span class="literal">false</span>;</span><br><span class="line">                <span class="keyword">this</span>.loadList();<span class="comment">/*列表重新加载*/</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  path: <span class="string">"/test"</span>,</span><br><span class="line">  name: <span class="string">"test"</span>,</span><br><span class="line">  component: test,</span><br><span class="line">  meta: &#123;</span><br><span class="line">        keepAlive: <span class="literal">true</span>,</span><br><span class="line">        isBack: <span class="literal">true</span>,</span><br><span class="line">        &#125;,</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>vue</category>
        <category>配置</category>
      </categories>
      <tags>
        <tag>vue</tag>
      </tags>
  </entry>
  <entry>
    <title>vue-cli4性能优化</title>
    <url>/2020/06/17/vue-cli4%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/</url>
    <content><![CDATA[<p><img src="https://s1.ax1x.com/2020/06/04/t0Rsk8.png" alt=""></p>
<a id="more"></a>

<h3 id="一、Gzip压缩"><a href="#一、Gzip压缩" class="headerlink" title="一、Gzip压缩"></a><strong>一、Gzip压缩</strong></h3><p>gizp 压缩是一种 http 请求优化方式，通过减少文件体积来提高加载速度，对于用户量多的网站，开启 gizp 压缩会大大降低服务器压力，提高加载速度，降低服务器流量成本</p>
<p><strong>压缩完成示例</strong></p>
<p><img src="https://s1.ax1x.com/2020/06/17/NEaSSS.png" alt="NEaSSS.png"></p>
<h4 id="1、安装插件"><a href="#1、安装插件" class="headerlink" title="1、安装插件"></a>1、安装插件</h4><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">cnpm install compression-webpack-plugin --save-de</span><br></pre></td></tr></table></figure>

<h4 id="2、在vue-config-js中配置"><a href="#2、在vue-config-js中配置" class="headerlink" title="2、在vue.config.js中配置"></a>2、在vue.config.js中配置</h4><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 导入compression-webpack-plugin</span></span><br><span class="line"><span class="keyword">const</span> CompressionWebpackPlugin = <span class="built_in">require</span>(<span class="string">"compression-webpack-plugin"</span>);</span><br><span class="line"><span class="comment">// 定义压缩文件类型</span></span><br><span class="line"><span class="keyword">const</span> productionGzipExtensions = [<span class="string">"js"</span>, <span class="string">"css"</span>];</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  <span class="comment">//统一配置打包插件</span></span><br><span class="line">  configureWebpack: &#123;</span><br><span class="line">    plugins: [</span><br><span class="line">      <span class="keyword">new</span> CompressionWebpackPlugin(&#123;</span><br><span class="line">        filename: <span class="string">"[path].gz[query]"</span>,</span><br><span class="line">        algorithm: <span class="string">"gzip"</span>,</span><br><span class="line">        test: <span class="keyword">new</span> <span class="built_in">RegExp</span>(<span class="string">"\\.("</span> + productionGzipExtensions.join(<span class="string">"|"</span>) + <span class="string">")$"</span>), <span class="comment">//匹配文件名</span></span><br><span class="line">        threshold: <span class="number">10240</span>, <span class="comment">//对10K以上的数据进行压缩</span></span><br><span class="line">        minRatio: <span class="number">0.8</span>,</span><br><span class="line">        deleteOriginalAssets: <span class="literal">false</span>, <span class="comment">//是否删除源文件</span></span><br><span class="line">      &#125;),</span><br><span class="line">    ],</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h4 id="3、在服务器的-nginx的http中配置-Gzip"><a href="#3、在服务器的-nginx的http中配置-Gzip" class="headerlink" title="3、在服务器的 nginx的http中配置 Gzip"></a>3、在服务器的 nginx的http中配置 Gzip</h4><figure class="highlight"><table><tr><td class="code"><pre><span class="line">gzip on; #开启或关闭gzip on off</span><br><span class="line">gzip_min_length 5k; #gzip压缩最小文件大小，超出进行压缩（自行调节）</span><br><span class="line">gzip_buffers 4 16k; #buffer 不用修改</span><br><span class="line">gzip_comp_level 4; #压缩级别:1-10，数字越大压缩的越好，时间也越长</span><br><span class="line">gzip_types text/plain application/x-javascript application/javascript text/css application/xml text/javascript application/x-httpd-php image/jpeg image/gif image/png; #  压缩文件类型</span><br><span class="line">gzip_vary on; # 和http头有关系，加个vary头，给代理服务器用的，有的浏览器支持压缩，有的不支持，所以避免浪费不支持的也压缩，所以根据客户端的HTTP头来判断，是否需要压缩</span><br></pre></td></tr></table></figure>

<h4 id="4、修改后记得执行-nginx-s-reload"><a href="#4、修改后记得执行-nginx-s-reload" class="headerlink" title="4、修改后记得执行 nginx -s reload"></a>4、修改后记得执行 nginx -s reload</h4><h3 id="二、去掉打包后的-console"><a href="#二、去掉打包后的-console" class="headerlink" title="二、去掉打包后的 console"></a><strong>二、去掉打包后的 console</strong></h3><h4 id="1、安裝插件"><a href="#1、安裝插件" class="headerlink" title="1、安裝插件"></a>1、安裝插件</h4><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">cnpm install babel-plugin-transform-remove-<span class="built_in">console</span> --save-dev</span><br></pre></td></tr></table></figure>

<h4 id="2、【babel-config-js】配置如下"><a href="#2、【babel-config-js】配置如下" class="headerlink" title="2、【babel.config.js】配置如下"></a>2、【babel.config.js】配置如下</h4><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> plugins = [<span class="string">"@vue/babel-plugin-transform-vue-jsx"</span>];</span><br><span class="line"><span class="comment">// 生产环境移除console</span></span><br><span class="line"><span class="keyword">if</span> (process.env.NODE_ENV === <span class="string">"production"</span>) &#123;</span><br><span class="line">  plugins.push(<span class="string">"transform-remove-console"</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  plugins: plugins,</span><br><span class="line">  presets: [<span class="string">"@vue/cli-plugin-babel/preset"</span>],</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h4 id="3、打包部署后，生产环境的-console-就全部去掉了"><a href="#3、打包部署后，生产环境的-console-就全部去掉了" class="headerlink" title="3、打包部署后，生产环境的 console 就全部去掉了~"></a>3、打包部署后，生产环境的 console 就全部去掉了~</h4><h3 id="三、图片懒加载"><a href="#三、图片懒加载" class="headerlink" title="三、图片懒加载"></a><strong>三、图片懒加载</strong></h3><h4 id="1、安装依赖"><a href="#1、安装依赖" class="headerlink" title="1、安装依赖"></a>1、安装依赖</h4><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">cnpm i vue-lazyload -S</span><br></pre></td></tr></table></figure>

<h4 id="2、main-js-中直接引用"><a href="#2、main-js-中直接引用" class="headerlink" title="2、main.js 中直接引用"></a>2、main.js 中直接引用</h4><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> VueLazyload <span class="keyword">from</span> <span class="string">"vue-lazyload"</span>;</span><br><span class="line"></span><br><span class="line">Vue.use(VueLazyload);</span><br><span class="line"></span><br><span class="line"><span class="comment">// or with options</span></span><br><span class="line">Vue.use(VueLazyload, &#123;</span><br><span class="line">  <span class="comment">//预加载高度</span></span><br><span class="line">  preLoad: <span class="number">1.3</span>,</span><br><span class="line">  <span class="comment">//错误时显示的图片</span></span><br><span class="line">  error: <span class="string">"static/about111.jpg"</span>,</span><br><span class="line">  <span class="comment">//图片加载中显示的图片</span></span><br><span class="line">  loading: <span class="string">"static/img/loading.gif"</span>,</span><br><span class="line">  <span class="comment">//尝试加载次数</span></span><br><span class="line">  attempt: <span class="number">1</span>,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h4 id="3、使用"><a href="#3、使用" class="headerlink" title="3、使用"></a>3、使用</h4><p>在组件中使用时，将 img 标签的 src 换成 v-lazy：</p>
<ol>
<li>未使用懒加载前的代码：<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">class</span>=<span class="string">"g-img1"</span> <span class="attr">src</span>=<span class="string">"static/1.jpg"</span> <span class="attr">alt</span>=<span class="string">""</span> /&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li>使用懒加载后的代码：<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">class</span>=<span class="string">"g-img1"</span> <span class="attr">v-lazy</span>=<span class="string">"'static/1.jpg'"</span> <span class="attr">alt</span>=<span class="string">""</span> /&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br></pre></td></tr></table></figure>


</li>
</ol>
]]></content>
      <categories>
        <category>前端性能优化</category>
      </categories>
      <tags>
        <tag>vue</tag>
      </tags>
  </entry>
  <entry>
    <title>typeScript</title>
    <url>/2020/09/10/typeScript/</url>
    <content><![CDATA[<p><a href="https://img-blog.csdnimg.cn/2020072410392078.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3N1cGVyS00=,size_16,color_FFFFFF,t_70" target="_blank" rel="noopener"><img src="https://img-blog.csdnimg.cn/2020072410392078.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3N1cGVyS00=,size_16,color_FFFFFF,t_70" alt="img"></a></p>
<p>vue3源码采用了大量ts的写法，掌握ts技巧也是前端进阶的必经之路。</p>
<a id="more"></a>



<h3 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h3><h4 id="特点"><a href="#特点" class="headerlink" title="特点"></a>特点</h4><ul>
<li>JavaScript 的超集</li>
<li>增加了静态类型系统</li>
<li>为大型软件开发而设计的</li>
<li>最终编译产生 JavaScript</li>
</ul>
<h4 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h4><p>全局安装typetypescript</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">COPYcnpm install -g typescript</span><br></pre></td></tr></table></figure>

<p>安装成功后使用 <code>tsc -v</code> 查看版本号</p>
<p><a href="https://img-blog.csdnimg.cn/20200724104450318.png" target="_blank" rel="noopener"><img src="https://img-blog.csdnimg.cn/20200724104450318.png" alt="img"></a></p>
<p>编译过程</p>
<ul>
<li>在后缀名为.ts的文件中编写typescript代码</li>
<li>使用tsc 将ts文件编译成js代码</li>
<li>在浏览器中执行或者node中执行</li>
</ul>
<h4 id="vscode-自动编译"><a href="#vscode-自动编译" class="headerlink" title="vscode 自动编译"></a>vscode 自动编译</h4><p><strong>点击菜单 终端-运行任务</strong>或者<strong>在vscode中按 Ctrl + Shift + B</strong>，每次保存后就会自动编译成对应的js文件</p>
<p><a href="https://cdn.jsdelivr.net/gh/superliebe/picGo/20200724144337.png" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/superliebe/picGo/20200724144337.png" alt="img"></a></p>
<h3 id="ts基础语法"><a href="#ts基础语法" class="headerlink" title="ts基础语法"></a>ts基础语法</h3><h4 id="变量"><a href="#变量" class="headerlink" title="变量"></a>变量</h4><p>指定类型后，该值只能是类型的值。</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">COPY<span class="comment">// let 变量名:变量类型 = 值;</span></span><br><span class="line"><span class="keyword">let</span> name1:string=<span class="string">"张三"</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//如果不定义：string，ts会自动根据值来判断类型</span></span><br><span class="line"><span class="keyword">let</span> name2=<span class="string">"张三"</span>;<span class="comment">//等价于 let name2:string="张三";</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//联合类型</span></span><br><span class="line"><span class="keyword">let</span> name3:string|number = <span class="string">"哈哈"</span></span><br></pre></td></tr></table></figure>

<h4 id="常见类型"><a href="#常见类型" class="headerlink" title="常见类型"></a>常见类型</h4><ul>
<li>原有类型</li>
</ul>
<p>string、number、 boolean、array、object、null、undefined、symbol</p>
<ul>
<li>新增类型</li>
</ul>
<p>tuple 元组、enum 枚举 、any 任意类型、never、void</p>
<h4 id="数组"><a href="#数组" class="headerlink" title="数组"></a>数组</h4><p>元素类型固定</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">COPY<span class="comment">// 方式一：let 数组名：类型[] =[值] </span></span><br><span class="line"><span class="keyword">let</span> arr1:string[] = [<span class="string">"jake"</span>,<span class="string">"lilei"</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">//方式二：let 数组名：Array&lt;类型&gt;=[值] </span></span><br><span class="line"><span class="keyword">let</span> arr2:<span class="built_in">Array</span>&lt;string&gt; = [<span class="string">"jake"</span>,<span class="string">"lilei"</span>]</span><br></pre></td></tr></table></figure>

<h4 id="元组"><a href="#元组" class="headerlink" title="元组"></a>元组</h4><p>就是一个规定了 元素数量和元素类型的数组，而每个元素的类型可以不一样</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">COPY<span class="comment">// let 元组名:[类型1,类型2,类型2] = [值1，值2，值2]</span></span><br><span class="line"><span class="keyword">let</span> arr1:[string,number,boolean]=[<span class="string">"啦啦"</span>,<span class="number">10</span>,<span class="literal">true</span>]</span><br></pre></td></tr></table></figure>

<h4 id="枚举"><a href="#枚举" class="headerlink" title="枚举"></a>枚举</h4><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">COPY<span class="comment">/*</span></span><br><span class="line"><span class="comment">enum 枚举名&#123;</span></span><br><span class="line"><span class="comment">    枚举项1=枚举值1，</span></span><br><span class="line"><span class="comment">    枚举项2=枚举值2，</span></span><br><span class="line"><span class="comment">    ...</span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment">枚举项一般用英文，枚举值一般用数字，如果不写枚举值，默认赋值对应的下标0,1,2...</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">enum person&#123;</span><br><span class="line">    man:<span class="number">1</span>,</span><br><span class="line">    woman:<span class="number">2</span>,</span><br><span class="line">    saiban:<span class="number">3</span>,</span><br><span class="line">&#125;   </span><br><span class="line"></span><br><span class="line">enum person2&#123;</span><br><span class="line">    man,<span class="comment">//--&gt;0</span></span><br><span class="line">    woman,<span class="comment">//--&gt;1</span></span><br><span class="line">    saiban,<span class="comment">//--&gt;2</span></span><br><span class="line">&#125;  </span><br><span class="line">    </span><br><span class="line"><span class="comment">//取值</span></span><br><span class="line"><span class="keyword">let</span> usersex:person = person.man;</span><br></pre></td></tr></table></figure>

<h4 id="其他数据类型"><a href="#其他数据类型" class="headerlink" title="其他数据类型"></a>其他数据类型</h4><blockquote>
<p><strong>any</strong> ：any代表任意类型，一般在获取dom时使用</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">COPYlet dom:any = <span class="built_in">document</span>.getElementById(<span class="string">"app"</span>)</span><br></pre></td></tr></table></figure>

<blockquote>
<p><strong>void</strong>：void 代表没有类型，一版用在无返回值函数。</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">COPY<span class="comment">//有返回值</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">say1</span>(<span class="params"></span>):<span class="title">string</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">"hello string"</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> ref1= say1();</span><br><span class="line"></span><br><span class="line"><span class="comment">//无返回值</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">say2</span>(<span class="params"></span>):<span class="title">void</span></span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"hello void"</span>)</span><br><span class="line">&#125;</span><br><span class="line">say2();</span><br></pre></td></tr></table></figure>

<blockquote>
<p><strong>never</strong>：代表不存在的值的类型，常用作抛出异常或者无限循环的函数返回类型</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">COPYfunction test():never&#123;</span><br><span class="line">    <span class="keyword">while</span>(<span class="literal">true</span>)&#123;</span><br><span class="line">        <span class="comment">//无限循环</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test2</span>(<span class="params"></span>):<span class="title">never</span></span>&#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">"hello never"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>补充：never类型是ts中的底部类型，所有类型都是never类型的子类，所以never类型的值可以赋值给任意类型的变量</p>
<h4 id="函数"><a href="#函数" class="headerlink" title="函数"></a>函数</h4><p>特点：实参和形参类型必须保持一致</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">COPYfunction 函数名(形参<span class="number">1</span>:类型,形参<span class="number">2</span>:类型):返回值类型&#123;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> 变量名：变量类型 = 函数名(实参<span class="number">1</span>,实参<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">//可选参数，可传可不传</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> 函数名(<span class="params">形参<span class="number">1</span>?:类型,形参<span class="number">2</span>?:类型</span>):返回值类型</span>&#123;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//默认参数，不传则使用默认值，如果想要第一个默认，第二个传参则 第一个传undefined即可</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> 函数名(<span class="params">形参<span class="number">1</span>:类型=默认值<span class="number">1</span>,形参<span class="number">2</span>:类型=默认值<span class="number">1</span></span>):返回值类型</span>&#123;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//剩余参数,只能定义一个，只能定义为数组，只能写在最后</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> 函数名(<span class="params">形参<span class="number">1</span>:类型,形参<span class="number">2</span>:类型，...形参<span class="number">3</span>:类型<span class="number">3</span>[]</span>):返回值类型</span>&#123;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="类"><a href="#类" class="headerlink" title="类"></a>类</h4><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">COPYclass City&#123;</span><br><span class="line">    <span class="comment">//成员变量定义在类中</span></span><br><span class="line">    cname:string=<span class="string">""</span>;</span><br><span class="line">    clevel:string=<span class="string">""</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">constructor</span>(name:string,level:string)&#123;</span><br><span class="line">        <span class="comment">//构造函数初始化</span></span><br><span class="line">        <span class="keyword">this</span>.cname=name;</span><br><span class="line">        <span class="keyword">this</span>.clevel= level</span><br><span class="line">    &#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//成员方法</span></span><br><span class="line">	about()&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">`城市：<span class="subst">$&#123;<span class="keyword">this</span>.cname&#125;</span>，等级<span class="subst">$&#123;<span class="keyword">this</span>.clevel&#125;</span>`</span>)</span><br><span class="line">    &#125;</span><br><span class="line">     </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> c1 = <span class="keyword">new</span> City(<span class="string">"p1"</span>,<span class="string">"一级"</span>)</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>typeScript</category>
      </categories>
      <tags>
        <tag>ts</tag>
      </tags>
  </entry>
  <entry>
    <title>wangeditor富文本编辑器</title>
    <url>/2020/07/16/wangeditor%E5%AF%8C%E6%96%87%E6%9C%AC%E7%BC%96%E8%BE%91%E5%99%A8/</url>
    <content><![CDATA[<p><img src="https://cdn.jsdelivr.net/gh/liebexiao/myImgs/20200717161621.png" alt=""></p>
<a id="more"></a>

<h3 id="一、封装组件"><a href="#一、封装组件" class="headerlink" title="一、封装组件"></a><strong>一、封装组件</strong></h3><h4 id="1、新建组件名-wangEditor"><a href="#1、新建组件名-wangEditor" class="headerlink" title="1、新建组件名 wangEditor"></a>1、新建组件名 wangEditor</h4><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&lt;template lang=<span class="string">"html"</span>&gt;</span><br><span class="line">    &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"editor"</span>&gt;</span><br><span class="line">        &lt;div ref=<span class="string">"toolbar"</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">"toolbar"</span>&gt;</span><br><span class="line">        &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">        &lt;div ref="editor" class="text"&gt;</span></span><br><span class="line"><span class="regexp">        &lt;/</span>div&gt;</span><br><span class="line">    &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">    <span class="keyword">import</span> E <span class="keyword">from</span> <span class="string">'wangeditor'</span></span><br><span class="line">    <span class="keyword">import</span> &#123;Message, Loading&#125; <span class="keyword">from</span> <span class="string">'element-ui'</span>;<span class="comment">//引入elm组件</span></span><br><span class="line">    <span class="keyword">let</span> loadingInstance;</span><br><span class="line">    <span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">        name: <span class="string">'editoritem'</span>,</span><br><span class="line">        data() &#123;</span><br><span class="line">            <span class="keyword">return</span> &#123;</span><br><span class="line">                <span class="comment">// uploadPath,</span></span><br><span class="line">                editor: <span class="literal">null</span>,</span><br><span class="line">                info_: <span class="literal">null</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        model: &#123;</span><br><span class="line">            prop: <span class="string">'value'</span>,</span><br><span class="line">            event: <span class="string">'change'</span></span><br><span class="line">        &#125;,</span><br><span class="line">        props: &#123;</span><br><span class="line">            value: &#123;</span><br><span class="line">                type: <span class="built_in">String</span>,</span><br><span class="line">                <span class="keyword">default</span>: <span class="string">''</span></span><br><span class="line">            &#125;,</span><br><span class="line">            isClear: &#123;</span><br><span class="line">                type: <span class="built_in">Boolean</span>,</span><br><span class="line">                <span class="keyword">default</span>: <span class="literal">false</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        watch: &#123;</span><br><span class="line">            isClear(val) &#123;</span><br><span class="line">                <span class="comment">// 触发清除文本域内容</span></span><br><span class="line">                <span class="keyword">if</span> (val) &#123;</span><br><span class="line">                    <span class="keyword">this</span>.editor.txt.clear()</span><br><span class="line">                    <span class="keyword">this</span>.info_ = <span class="literal">null</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            value: <span class="function"><span class="keyword">function</span>(<span class="params">value</span>) </span>&#123;</span><br><span class="line">                <span class="keyword">if</span> (value !== <span class="keyword">this</span>.editor.txt.html()) &#123;</span><br><span class="line">                    <span class="keyword">this</span>.editor.txt.html(<span class="keyword">this</span>.value)</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//value为编辑框输入的内容，这里我监听了一下值，当父组件调用得时候，如果给value赋值了，子组件将会显示父组件赋给的值</span></span><br><span class="line">        &#125;,</span><br><span class="line">        mounted() &#123;</span><br><span class="line">            <span class="keyword">this</span>.seteditor()</span><br><span class="line">            <span class="keyword">this</span>.editor.txt.html(<span class="keyword">this</span>.value)</span><br><span class="line">        &#125;,</span><br><span class="line">        methods: &#123;</span><br><span class="line">            seteditor() &#123;</span><br><span class="line">                <span class="comment">// http://192.168.2.125:8080/admin/storage/create</span></span><br><span class="line">                <span class="keyword">this</span>.editor = <span class="keyword">new</span> E(<span class="keyword">this</span>.$refs.toolbar, <span class="keyword">this</span>.$refs.editor)</span><br><span class="line">                <span class="keyword">this</span>.editor.customConfig.uploadImgShowBase64 = <span class="literal">false</span>; <span class="comment">// base 64 存储图片</span></span><br><span class="line">                <span class="keyword">this</span>.editor.customConfig.uploadImgServer = <span class="string">'/upload'</span>;<span class="comment">// 配置服务器端地址</span></span><br><span class="line">                <span class="keyword">this</span>.editor.customConfig.uploadImgHeaders = &#123; &#125;;<span class="comment">// 自定义 header</span></span><br><span class="line">                <span class="keyword">this</span>.editor.customConfig.uploadFileName = <span class="string">'file'</span>; <span class="comment">// 后端接受上传文件的参数名</span></span><br><span class="line">                <span class="keyword">this</span>.editor.customConfig.uploadImgMaxSize = <span class="number">20</span> * <span class="number">1024</span> * <span class="number">1024</span>; <span class="comment">// 将图片大小限制为 20M</span></span><br><span class="line">                <span class="keyword">this</span>.editor.customConfig.uploadImgMaxLength = <span class="number">6</span>; <span class="comment">// 限制一次最多上传 3 张图片</span></span><br><span class="line">                <span class="keyword">this</span>.editor.customConfig.uploadImgTimeout = <span class="number">3</span> * <span class="number">60</span> * <span class="number">1000</span>; <span class="comment">// 设置超时时间</span></span><br><span class="line"></span><br><span class="line">                <span class="comment">// 配置菜单</span></span><br><span class="line">                <span class="keyword">this</span>.editor.customConfig.menus = [</span><br><span class="line">                    <span class="string">'head'</span>, <span class="comment">// 标题</span></span><br><span class="line">                    <span class="string">'bold'</span>, <span class="comment">// 粗体</span></span><br><span class="line">                    <span class="string">'fontSize'</span>, <span class="comment">// 字号</span></span><br><span class="line">                    <span class="string">'fontName'</span>, <span class="comment">// 字体</span></span><br><span class="line">                    <span class="string">'italic'</span>, <span class="comment">// 斜体</span></span><br><span class="line">                    <span class="string">'underline'</span>, <span class="comment">// 下划线</span></span><br><span class="line">                    <span class="string">'strikeThrough'</span>, <span class="comment">// 删除线</span></span><br><span class="line">                    <span class="string">'foreColor'</span>, <span class="comment">// 文字颜色</span></span><br><span class="line">                    <span class="string">'backColor'</span>, <span class="comment">// 背景颜色</span></span><br><span class="line">                    <span class="string">'link'</span>, <span class="comment">// 插入链接</span></span><br><span class="line">                    <span class="string">'list'</span>, <span class="comment">// 列表</span></span><br><span class="line">                    <span class="string">'justify'</span>, <span class="comment">// 对齐方式</span></span><br><span class="line">                    <span class="string">'quote'</span>, <span class="comment">// 引用</span></span><br><span class="line">                    <span class="string">'emoticon'</span>, <span class="comment">// 表情</span></span><br><span class="line">                    <span class="string">'image'</span>, <span class="comment">// 插入图片</span></span><br><span class="line">                    <span class="string">'table'</span>, <span class="comment">// 表格</span></span><br><span class="line">                    <span class="string">'video'</span>, <span class="comment">// 插入视频</span></span><br><span class="line">                    <span class="string">'code'</span>, <span class="comment">// 插入代码</span></span><br><span class="line">                    <span class="string">'undo'</span>, <span class="comment">// 撤销</span></span><br><span class="line">                    <span class="string">'redo'</span>, <span class="comment">// 重复</span></span><br><span class="line">                    <span class="string">'fullscreen'</span> <span class="comment">// 全屏</span></span><br><span class="line">                ]</span><br><span class="line"></span><br><span class="line">                <span class="keyword">this</span>.editor.customConfig.uploadImgHooks = &#123;</span><br><span class="line">                    before: <span class="function"><span class="keyword">function</span> (<span class="params">xhr, editor, files</span>) </span>&#123;</span><br><span class="line">                        <span class="comment">// 图片上传之前触发</span></span><br><span class="line">                        loadingInstance = Loading.service(&#123;</span><br><span class="line">                            lock: <span class="literal">true</span>,</span><br><span class="line">                            text: <span class="string">'图片正在上传，请稍等...'</span>,</span><br><span class="line">                            background: <span class="string">'rgba(255, 255, 255, 0.1)'</span></span><br><span class="line">                        &#125;);</span><br><span class="line">                    &#125;,</span><br><span class="line">                    fail: <span class="function">(<span class="params">xhr, editor, result</span>) =&gt;</span> &#123;</span><br><span class="line">                        <span class="comment">// 插入图片失败回调</span></span><br><span class="line">                    &#125;,</span><br><span class="line">                    success: <span class="function">(<span class="params">xhr, editor, result</span>) =&gt;</span> &#123;</span><br><span class="line">                        <span class="comment">// 图片上传成功回调</span></span><br><span class="line">                    &#125;,</span><br><span class="line">                    timeout: <span class="function">(<span class="params">xhr, editor</span>) =&gt;</span> &#123;</span><br><span class="line">                        <span class="comment">// 网络超时的回调</span></span><br><span class="line">                    &#125;,</span><br><span class="line">                    error: <span class="function">(<span class="params">xhr, editor</span>) =&gt;</span> &#123;</span><br><span class="line">                        <span class="comment">// 图片上传错误的回调</span></span><br><span class="line">                    &#125;,</span><br><span class="line">                    customInsert: <span class="function">(<span class="params">insertImg, result, editor</span>) =&gt;</span> &#123;</span><br><span class="line">                        <span class="comment">// 图片上传成功，插入图片的回调</span></span><br><span class="line">                        loadingInstance.close();</span><br><span class="line">                        <span class="comment">//result为上传图片成功的时候返回的数据，这里我打印了一下发现后台返回的是data：["路径的形式",...]</span></span><br><span class="line">                        <span class="comment">// console.log(result.data[0].url)</span></span><br><span class="line">                        <span class="comment">//insertImg()为插入图片的函数</span></span><br><span class="line">                        <span class="comment">//循环插入图片</span></span><br><span class="line">                        result.data.map(<span class="function"><span class="params">v</span>=&gt;</span>&#123;</span><br><span class="line">                            insertImg(v)</span><br><span class="line">                        &#125;)</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">this</span>.editor.customConfig.onchange = <span class="function">(<span class="params">html</span>) =&gt;</span> &#123;</span><br><span class="line">                    <span class="keyword">this</span>.info_ = html <span class="comment">// 绑定当前逐渐地值</span></span><br><span class="line">                    <span class="keyword">this</span>.$emit(<span class="string">'change'</span>, <span class="keyword">this</span>.info_) <span class="comment">// 将内容同步到父组件中</span></span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">// 创建富文本编辑器</span></span><br><span class="line">                <span class="keyword">this</span>.editor.create()</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">&lt;style lang="css"&gt;</span></span><br><span class="line"><span class="regexp">    .editor &#123;</span></span><br><span class="line"><span class="regexp">        width: 100%;</span></span><br><span class="line"><span class="regexp">        margin: 0 auto;</span></span><br><span class="line"><span class="regexp">        position: relative;</span></span><br><span class="line"><span class="regexp">        z-index: 0;</span></span><br><span class="line"><span class="regexp">    &#125;</span></span><br><span class="line"><span class="regexp">    .toolbar &#123;</span></span><br><span class="line"><span class="regexp">        border: 1px solid #ccc;</span></span><br><span class="line"><span class="regexp">    &#125;</span></span><br><span class="line"><span class="regexp">    .text &#123;</span></span><br><span class="line"><span class="regexp">        border: 1px solid #ccc;</span></span><br><span class="line"><span class="regexp">        height: 600px;</span></span><br><span class="line"><span class="regexp">    &#125;</span></span><br><span class="line"><span class="regexp">&lt;/</span>style&gt;</span><br></pre></td></tr></table></figure>

<h3 id="二、安装使用"><a href="#二、安装使用" class="headerlink" title="二、安装使用"></a><strong>二、安装使用</strong></h3><h4 id="1、安装引用"><a href="#1、安装引用" class="headerlink" title="1、安装引用"></a><strong>1、安装引用</strong></h4><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">cnpm install wangeditor</span><br><span class="line"><span class="keyword">import</span> EditorBar <span class="keyword">from</span> <span class="string">'@/components/wangEditor'</span>;</span><br></pre></td></tr></table></figure>

<h4 id="2、使用"><a href="#2、使用" class="headerlink" title="2、使用"></a><strong>2、使用</strong></h4><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">editor-bar</span> <span class="attr">v-model</span>=<span class="string">"editorDesc"</span> @<span class="attr">change</span>=<span class="string">"changeEditor"</span>&gt;</span><span class="tag">&lt;/<span class="name">editor-bar</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">editorDesc: <span class="string">''</span>,<span class="comment">//富文本编辑器使用方法内容</span></span><br><span class="line">changeEditor(val) &#123;</span><br><span class="line">               <span class="built_in">console</span>.log(val)</span><br><span class="line">           &#125;,</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>vue</category>
        <category>组件</category>
      </categories>
      <tags>
        <tag>vue</tag>
      </tags>
  </entry>
  <entry>
    <title>一、nginx安装与配置</title>
    <url>/2020/07/16/%E4%B8%80%E3%80%81nginx%E5%AE%89%E8%A3%85%E4%B8%8E%E9%85%8D%E7%BD%AE/</url>
    <content><![CDATA[<p><img src="https://s1.ax1x.com/2020/07/17/UyyCYq.jpg" alt=""></p>
<a id="more"></a>

<h3 id="一、下载"><a href="#一、下载" class="headerlink" title="一、下载"></a><strong>一、下载</strong></h3><p>nginx官网 <a href="http://nginx.org/en/download.html" target="_blank" rel="noopener">Nginx</a></p>
<p><img src="https://s1.ax1x.com/2020/07/16/UD8rgf.png" alt="UD8rgf.png"></p>
<h3 id="二、解压下载好的zip包"><a href="#二、解压下载好的zip包" class="headerlink" title="二、解压下载好的zip包"></a><strong>二、解压下载好的zip包</strong></h3><p>打开<strong>nginx.conf</strong>文件，并修改<strong>server</strong>配置片段。</p>
<p><img src="https://img-blog.csdnimg.cn/2019102214283435.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2lubWFycnk=,size_16,color_FFFFFF,t_70" alt="img">)<img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="点击并拖拽以移动"></p>
<h4 id="1、先将注释掉的删除，用默认的路径先运行一下，提示运行成功"><a href="#1、先将注释掉的删除，用默认的路径先运行一下，提示运行成功" class="headerlink" title="1、先将注释掉的删除，用默认的路径先运行一下，提示运行成功"></a>1、先将注释掉的删除，用默认的路径先运行一下，提示运行成功</h4><p><img src="https://img-blog.csdnimg.cn/2019102215245316.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2lubWFycnk=,size_16,color_FFFFFF,t_70" alt="img">)<img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="点击并拖拽以移动"></p>
<h4 id="2、然后可以填写自己的ip和项目路径再次运行，即可进入项目。"><a href="#2、然后可以填写自己的ip和项目路径再次运行，即可进入项目。" class="headerlink" title="2、然后可以填写自己的ip和项目路径再次运行，即可进入项目。"></a>2、然后可以填写自己的ip和项目路径再次运行，即可进入项目。</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">worker_processes  1;</span><br><span class="line">events &#123;</span><br><span class="line">    worker_connections  1024;</span><br><span class="line">&#125;</span><br><span class="line">http &#123;</span><br><span class="line">    include       mime.types;</span><br><span class="line">    default_type  application&#x2F;octet-stream;</span><br><span class="line"></span><br><span class="line">    sendfile        on;</span><br><span class="line">   </span><br><span class="line">    keepalive_timeout  65;</span><br><span class="line"></span><br><span class="line">    server &#123;</span><br><span class="line">        listen       80;</span><br><span class="line">        server_name   192.168.3.9;</span><br><span class="line"></span><br><span class="line">        location &#x2F; &#123;</span><br><span class="line">            root  E:&#x2F;vueProject&#x2F;npjyVueManager&#x2F;dist;</span><br><span class="line">            index  index.html index.htm;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        error_page   500 502 503 504  &#x2F;50x.html;</span><br><span class="line">        location &#x3D; &#x2F;50x.html &#123;</span><br><span class="line">            root   html;</span><br><span class="line">        &#125;       </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="3、在本地服务器运行，切换到nginx路径下运行nginx"><a href="#3、在本地服务器运行，切换到nginx路径下运行nginx" class="headerlink" title="3、在本地服务器运行，切换到nginx路径下运行nginx"></a>3、在本地服务器运行，切换到nginx路径下运行nginx</h4><p><img src="https://img-blog.csdnimg.cn/2019102215273495.png" alt="img">)<img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="点击并拖拽以移动"></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">启动：start nginx.exe </span><br><span class="line"> </span><br><span class="line">停止：nginx.exe -s stop </span><br><span class="line"> </span><br><span class="line">重新加载：nginx.exe -s reload</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>vue</category>
        <category>配置</category>
      </categories>
      <tags>
        <tag>vue</tag>
      </tags>
  </entry>
  <entry>
    <title>wx支付</title>
    <url>/2020/09/04/wx%E6%94%AF%E4%BB%98/</url>
    <content><![CDATA[<p><img src="https://cdn.jsdelivr.net/gh/liebexiao/myImgs/20200904220626.jpg" alt=""></p>
<a id="more"></a>

<h3 id="一、wx-支付"><a href="#一、wx-支付" class="headerlink" title="一、wx 支付"></a><strong>一、wx 支付</strong></h3><h4 id="1、请求后台接口获取-wx-需要数据"><a href="#1、请求后台接口获取-wx-需要数据" class="headerlink" title="1、请求后台接口获取 wx 需要数据"></a>1、请求后台接口获取 wx 需要数据</h4><p>将请求接口得来的数据存到全局变量里面  payData 。</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">Ajax(<span class="string">"post"</span>, <span class="string">"/api"</span>, obj)</span><br><span class="line">  .then(<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> data = res.data;</span><br><span class="line">    <span class="keyword">this</span>.payData = data;</span><br><span class="line">    <span class="comment">//wx判断支付环境是否可用，若环境准备好接着调用 onBridgeReady()方法</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> WeixinJSBridge == <span class="string">"undefined"</span>) &#123;</span><br><span class="line">      <span class="keyword">if</span> (<span class="built_in">document</span>.addEventListener) &#123;</span><br><span class="line">        <span class="built_in">document</span>.addEventListener(<span class="string">"WeixinJSBridgeReady"</span>, onBridgeReady, <span class="literal">false</span>);</span><br><span class="line">      &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="built_in">document</span>.attachEvent) &#123;</span><br><span class="line">        <span class="built_in">document</span>.attachEvent(<span class="string">"WeixinJSBridgeReady"</span>, onBridgeReady);</span><br><span class="line">        <span class="built_in">document</span>.attachEvent(<span class="string">"onWeixinJSBridgeReady"</span>, onBridgeReady);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">this</span>.onBridgeReady();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">  .catch(<span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span><br><span class="line">    alert(e);</span><br><span class="line">    <span class="keyword">this</span>.canSubmit = <span class="literal">true</span>;</span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure>

<h4 id="2、将后台返回的参数传到-wx"><a href="#2、将后台返回的参数传到-wx" class="headerlink" title="2、将后台返回的参数传到 wx"></a>2、将后台返回的参数传到 wx</h4><p>调用 wx 支付方法，将上面请求后台接口返回的参数传给 wx 。在用户支付成功后进行下一步操作。</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//微信支付</span></span><br><span class="line">          onBridgeReady() &#123;</span><br><span class="line">              <span class="keyword">let</span> that = <span class="keyword">this</span>;</span><br><span class="line">              WeixinJSBridge.invoke(</span><br><span class="line">                  <span class="string">'getBrandWCPayRequest'</span>, &#123;</span><br><span class="line">                      <span class="string">"appId"</span>: <span class="keyword">this</span>.payData.appId,     <span class="comment">//公众号名称，由商户传入</span></span><br><span class="line">                      <span class="string">"timeStamp"</span>: <span class="keyword">this</span>.payData.timeStamp,         <span class="comment">//时间戳，自1970年以来的秒数</span></span><br><span class="line">                      <span class="string">"nonceStr"</span>: <span class="keyword">this</span>.payData.nonceStr, <span class="comment">//随机串</span></span><br><span class="line">                      <span class="string">"package"</span>: <span class="keyword">this</span>.payData.package,</span><br><span class="line">                      <span class="string">"signType"</span>: <span class="keyword">this</span>.payData.signType,         <span class="comment">//微信签名方式：</span></span><br><span class="line">                      <span class="string">"paySign"</span>: <span class="keyword">this</span>.payData.paySign <span class="comment">//微信签名</span></span><br><span class="line">                  &#125;,</span><br><span class="line">                  <span class="function"><span class="keyword">function</span> (<span class="params">res</span>) </span>&#123;</span><br><span class="line">                      <span class="keyword">if</span> (res.err_msg == <span class="string">"get_brand_wcpay_request:ok"</span>) &#123;</span><br><span class="line">                          <span class="comment">//支付成功</span></span><br><span class="line">                          <span class="built_in">window</span>.location.href=<span class="string">"/activity"</span>;</span><br><span class="line"></span><br><span class="line">                      &#125;<span class="keyword">else</span> <span class="keyword">if</span> (res.err_msg == <span class="string">"get_brand_wcpay_request:fail"</span>) &#123;</span><br><span class="line">                          <span class="comment">// 使用以上方式判断前端返回,微信团队郑重提示：</span></span><br><span class="line">                          <span class="comment">//res.err_msg将在用户支付成功后返回ok，但并不保证它绝对可靠。</span></span><br><span class="line">                          alert(res.err_msg);</span><br><span class="line">                      &#125;</span><br><span class="line">                  &#125;);</span><br><span class="line">          &#125;,</span><br></pre></td></tr></table></figure>

<h3 id="二、wx-扫码支付-QRcode-二维码"><a href="#二、wx-扫码支付-QRcode-二维码" class="headerlink" title="二、wx 扫码支付-QRcode 二维码"></a><strong>二、wx 扫码支付-QRcode 二维码</strong></h3><h4 id="1、引入-QRcode"><a href="#1、引入-QRcode" class="headerlink" title="1、引入 QRcode"></a>1、引入 QRcode</h4><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">cnpm install qrcodejs2</span><br><span class="line"><span class="keyword">import</span> QRCode <span class="keyword">from</span> <span class="string">"qrcodejs2"</span>; <span class="comment">// 引入qrcode</span></span><br><span class="line"><span class="keyword">let</span> qrcode;</span><br><span class="line">&lt;div id=<span class="string">"qrcode"</span>&gt;&lt;<span class="regexp">/div&gt;;</span></span><br></pre></td></tr></table></figure>

<h4 id="2、从接口获取二维码地址-并生成二维码"><a href="#2、从接口获取二维码地址-并生成二维码" class="headerlink" title="2、从接口获取二维码地址 并生成二维码"></a>2、从接口获取二维码地址 并生成二维码</h4><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">document</span>.getElementById(<span class="string">"qrcode"</span>).innerHTML = <span class="string">""</span>;</span><br><span class="line">  qrcode = <span class="keyword">new</span> QRCode(<span class="string">"qrcode"</span>, &#123;</span><br><span class="line">    width: <span class="number">280</span>,</span><br><span class="line">    height: <span class="number">280</span>,</span><br><span class="line">    text: res.data.data, <span class="comment">// 二维码地址</span></span><br><span class="line">    colorDark: <span class="string">"#000"</span>,</span><br><span class="line">    colorLight: <span class="string">"#fff"</span>,</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;, <span class="number">100</span>);</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>wx</category>
        <category>wx支付</category>
      </categories>
      <tags>
        <tag>js</tag>
      </tags>
  </entry>
  <entry>
    <title>二、vue安装配置</title>
    <url>/2020/07/16/%E4%BA%8C%E3%80%81vue%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AE/</url>
    <content><![CDATA[<p><img src="https://cdn.jsdelivr.net/gh/liebexiao/myImgs/20200717172409.png" alt=""></p>
<a id="more"></a>

<h5 id="1、首先安装node-js作为开发环境"><a href="#1、首先安装node-js作为开发环境" class="headerlink" title="1、首先安装node.js作为开发环境"></a><strong>1、首先安装node.js作为开发环境</strong></h5><blockquote>
<p>打开<a href="http://nodejs.org/" target="_blank" rel="noopener">nodejs官网</a>进行安装。最好安装在C盘。</p>
</blockquote>
<h5 id="2、打开管理员终端——接下来就在终端里面操作"><a href="#2、打开管理员终端——接下来就在终端里面操作" class="headerlink" title="2、打开管理员终端——接下来就在终端里面操作"></a>2、打开管理员终端——接下来就在终端里面操作</h5><blockquote>
<p> 输入<strong>node -v</strong>查看node的版本号；输入<strong>npm -v</strong>查看npm的版本号；</p>
</blockquote>
<h5 id="3、安装淘宝镜像cnpm"><a href="#3、安装淘宝镜像cnpm" class="headerlink" title="3、安装淘宝镜像cnpm"></a><strong>3、安装淘宝镜像cnpm</strong></h5><blockquote>
<p>因为npm安装插件是从国外<a href="https://www.baidu.com/s?wd=服务器&tn=24004469_oem_dg&rsv_dl=gh_pl_sl_csd" target="_blank" rel="noopener">服务器</a>下载，受网络影响大，可能出现异常，使用定制的 <a href="https://github.com/cnpm/cnpm" target="_blank" rel="noopener">cnpm</a> (gzip 压缩支持) 命令行工具代替默认的 <code>npm</code>:</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">npm install -g cnpm --registry&#x3D;https:&#x2F;&#x2F;registry.npm.taobao.org</span><br></pre></td></tr></table></figure>

<blockquote>
<p>cnpm跟npm用法完全一致，只是在执行命令时将npm改为cnpm。</p>
</blockquote>
<h5 id="4、检查cnpm是否安装成功"><a href="#4、检查cnpm是否安装成功" class="headerlink" title="4、检查cnpm是否安装成功"></a><strong>4、检查cnpm是否安装成功</strong></h5><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">cnpm -v</span><br></pre></td></tr></table></figure>

<h5 id="5、安装-cli3"><a href="#5、安装-cli3" class="headerlink" title="5、安装 cli3"></a><strong>5、安装 cli3</strong></h5><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">cnpm install -g @vue&#x2F;cli</span><br></pre></td></tr></table></figure>

<h5 id="6、检查vue有没有安装成功"><a href="#6、检查vue有没有安装成功" class="headerlink" title="6、检查vue有没有安装成功"></a><strong>6、检查vue有没有安装成功</strong></h5><blockquote>
<p><strong>vue -V</strong>检查版本号</p>
</blockquote>
<h5 id="7、安装webpack打包工具"><a href="#7、安装webpack打包工具" class="headerlink" title="7、安装webpack打包工具"></a><strong>7、安装webpack打包工具</strong></h5><blockquote>
<p><strong>cnpm install webpack -g ；</strong>继续安装webpack-cli：<strong>cnpm install webpack-cli -g -d</strong></p>
<p>输入 <strong>webpack -v</strong>检查是否安装成功</p>
</blockquote>
]]></content>
      <categories>
        <category>vue</category>
        <category>配置</category>
      </categories>
      <tags>
        <tag>vue</tag>
      </tags>
  </entry>
  <entry>
    <title>下拉分页</title>
    <url>/2020/07/15/%E4%B8%8B%E6%8B%89%E5%88%86%E9%A1%B5/</url>
    <content><![CDATA[<p><img src="https://cdn.jsdelivr.net/gh/liebexiao/myImgs/20200717165343.png" alt=""></p>
<a id="more"></a>

<h4 id="1、定义变量"><a href="#1、定义变量" class="headerlink" title="1、定义变量"></a>1、定义变量</h4><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">allLIst:[],<span class="comment">//列表数据</span></span><br><span class="line">page:<span class="number">0</span>,</span><br><span class="line">loadNextPage:<span class="literal">true</span>,<span class="comment">//是否请求下一页</span></span><br></pre></td></tr></table></figure>

<h4 id="2、监听滚动条"><a href="#2、监听滚动条" class="headerlink" title="2、监听滚动条"></a>2、监听滚动条</h4><p>在 mounted 里面监听分页滚动条</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//分页监听滚动条</span></span><br><span class="line"><span class="built_in">window</span>.addEventListener(<span class="string">"scroll"</span>, <span class="keyword">this</span>.handleScroll);</span><br></pre></td></tr></table></figure>

<h4 id="3、定义方法"><a href="#3、定义方法" class="headerlink" title="3、定义方法"></a>3、定义方法</h4><p>在 methods 里面写 handleScroll 方法</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//分页——滚动条触碰到底部</span></span><br><span class="line">handleScroll() &#123;</span><br><span class="line">    <span class="keyword">let</span> scrollTop = <span class="built_in">document</span>.documentElement.scrollTop || <span class="built_in">document</span>.body.scrollTop;</span><br><span class="line">    <span class="comment">//判断 如果文档的距离减200小于  屏幕可视距离  加上  滚动条距离顶部的距离，并且 loadNextPage为true ，则page++；</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">document</span>.documentElement.scrollHeight - <span class="number">200</span> &lt; <span class="built_in">document</span>.documentElement.clientHeight + scrollTop) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">this</span>.loadNextPage) &#123;</span><br><span class="line">            <span class="comment">// console.log("下一页");</span></span><br><span class="line">            <span class="keyword">this</span>.loadNextPage = <span class="literal">false</span>;</span><br><span class="line">            <span class="keyword">this</span>.page++;</span><br><span class="line">            <span class="keyword">this</span>.getList();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<h4 id="4、赋值"><a href="#4、赋值" class="headerlink" title="4、赋值"></a>4、赋值</h4><p>请求数据列表之后给变量 list 赋值</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//请求数据列表</span></span><br><span class="line">getList() &#123;</span><br><span class="line"><span class="keyword">let</span> obj = &#123;</span><br><span class="line">page: <span class="keyword">this</span>.page,</span><br><span class="line">size: <span class="number">10</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">this</span>.$http.post(<span class="string">"/api/"</span>, obj).then(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line"><span class="comment">//分页进入下一页</span></span><br><span class="line"><span class="keyword">let</span> data = res.data.result.data;</span><br><span class="line"><span class="comment">//判断 如果数据个数小于10，不进入下一页，否则loadNextPage设为true进入下一页</span></span><br><span class="line">data.length &lt; <span class="number">10</span> ? <span class="keyword">this</span>.loadNextPage = <span class="literal">false</span> : <span class="keyword">this</span>.loadNextPage = <span class="literal">true</span>;</span><br><span class="line"><span class="comment">//分页连接数组</span></span><br><span class="line"><span class="keyword">this</span>.allList = [...this.allList, ...data];</span><br><span class="line"><span class="comment">// console.log(JSON.stringify(this.allList));</span></span><br><span class="line">&#125;);</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>常用</category>
        <category>常用工具</category>
      </categories>
      <tags>
        <tag>js</tag>
      </tags>
  </entry>
  <entry>
    <title>三、cli3创建新项目</title>
    <url>/2020/07/16/%E4%B8%89%E3%80%81cli3%E5%88%9B%E5%BB%BA%E6%96%B0%E9%A1%B9%E7%9B%AE/</url>
    <content><![CDATA[<p><img src="https://cdn.jsdelivr.net/gh/liebexiao/myImgs/20200717172409.png" alt=""></p>
<a id="more"></a>

<h3 id="一、在控制台通过cli3创建项目"><a href="#一、在控制台通过cli3创建项目" class="headerlink" title="一、在控制台通过cli3创建项目"></a><strong>一、在控制台通过cli3创建项目</strong></h3><h4 id="1、在控制台通过cli3创建项目"><a href="#1、在控制台通过cli3创建项目" class="headerlink" title="1、在控制台通过cli3创建项目"></a><strong>1、在控制台通过cli3创建项目</strong></h4><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">vue create first-cli3</span><br></pre></td></tr></table></figure>

<h4 id="2、配置"><a href="#2、配置" class="headerlink" title="2、配置"></a><strong>2、配置</strong></h4><p>1、</p>
<p><img src="https://s1.ax1x.com/2020/07/16/UDcNNt.png" alt="UDcNNt.png"></p>
<blockquote>
<p>填y 回车</p>
</blockquote>
<p>2、</p>
<p><img src="https://s1.ax1x.com/2020/07/16/UDcWCV.png" alt="UDcWCV.png"></p>
<p>3、</p>
<p><img src="https://s1.ax1x.com/2020/07/16/UDcOC6.png" alt="UDcOC6.png"></p>
<p>4、</p>
<p>选y 回车 然后选Sass/SCSS</p>
<p><img src="https://s1.ax1x.com/2020/07/16/UDgQ5q.png" alt="UDgQ5q.png"></p>
<p>5、</p>
<p><img src="https://s1.ax1x.com/2020/07/16/UDg82T.png" alt="UDg82T.png"></p>
<p>6、</p>
<p><img src="https://s1.ax1x.com/2020/07/16/UDgBPx.png" alt="UDgBPx.png"></p>
<p>7、</p>
<p><img src="https://s1.ax1x.com/2020/07/16/UDgRZd.png" alt="UDgRZd.png"></p>
<p>8、</p>
<p>Save this as a preset for furture projects? 这个 是否保存现在的配置 以后创建项目时候依旧使用目前配置？ </p>
<p><img src="https://s1.ax1x.com/2020/07/16/UDgOds.png" alt="UDgOds.png"></p>
<h3 id="二、在网页创建vue项目"><a href="#二、在网页创建vue项目" class="headerlink" title="二、在网页创建vue项目"></a><strong>二、在网页创建vue项目</strong></h3><p>1、</p>
<p>在控制台输入 <strong>vue ui</strong>  命令 ；；打开网页 在此处创建项目</p>
<p><img src="https://s1.ax1x.com/2020/07/16/UD2GFI.png" alt="UD2GFI.png"></p>
<p>2、</p>
<p><img src="https://s1.ax1x.com/2020/07/16/UD2a6S.png" alt="UD2a6S.png"></p>
<p>3、</p>
<p>输入 <strong>项目名</strong> 后 选 <strong>npm</strong> ，，其他默认</p>
<p><img src="https://s1.ax1x.com/2020/07/16/UD2yYq.png" alt="UD2yYq.png"></p>
<p>4、</p>
<p>选择 <strong>手动配置</strong>  之后从 上一大节里面第三步开始配置；； 其中第三步增加 选择 <strong>使用配置文件</strong> 选项</p>
<p><img src="https://s1.ax1x.com/2020/07/16/UD2hm4.png" alt="UD2hm4.png"></p>
<p>5、</p>
<p>保存预设名 目的 与第一部分第8步相同</p>
<p><img src="https://s1.ax1x.com/2020/07/16/UD2Tt1.png" alt="UD2Tt1.png"></p>
]]></content>
      <categories>
        <category>vue</category>
        <category>配置</category>
      </categories>
      <tags>
        <tag>vue</tag>
      </tags>
  </entry>
  <entry>
    <title>导出excel表格</title>
    <url>/2020/07/15/%E5%AF%BC%E5%87%BAexcel%E8%A1%A8%E6%A0%BC/</url>
    <content><![CDATA[<p><img src="https://cdn.jsdelivr.net/gh/liebexiao/myImgs/20200717165537.png" alt=""></p>
<a id="more"></a>

<h4 id="一、引用"><a href="#一、引用" class="headerlink" title="一、引用"></a><strong>一、引用</strong></h4><h4 id="1、在-style-js-中引入方法"><a href="#1、在-style-js-中引入方法" class="headerlink" title="1、在 style.js 中引入方法"></a>1、在 style.js 中引入方法</h4><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="comment">//下载文件流</span></span><br><span class="line">  operateFile(file, filename) &#123;</span><br><span class="line">    <span class="comment">// let fileName = filename + "-" + new Date().getFullYear() + '' +( new Date().getMonth()+1)  + '' +new Date() .getDate()+".xls";</span></span><br><span class="line">    <span class="comment">// let blobObject = new Blob([file], &#123;type: "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"&#125;);</span></span><br><span class="line">    <span class="comment">// //是IE浏览器</span></span><br><span class="line">    <span class="comment">// if(!!window.ActiveXObject || "ActiveXObject" in window)&#123;</span></span><br><span class="line">    <span class="comment">//     window.navigator.msSaveOrOpenBlob(blobObject,fileName);</span></span><br><span class="line">    <span class="comment">// &#125;else&#123;//火狐谷歌都兼容</span></span><br><span class="line">    <span class="comment">//     //模板中要有一个预定义好的a标签</span></span><br><span class="line">    <span class="comment">//     let link = document.getElementById('a_id')</span></span><br><span class="line">    <span class="comment">//     link.href = URL.createObjectURL(blobObject);</span></span><br><span class="line">    <span class="comment">//     link.download = fileName</span></span><br><span class="line">    <span class="comment">//     link.click();</span></span><br><span class="line">    <span class="comment">// &#125;</span></span><br><span class="line">    <span class="keyword">var</span> filename = <span class="string">"订单记录"</span>;</span><br><span class="line">    <span class="keyword">let</span> url = <span class="built_in">window</span>.URL.createObjectURL(file.data);</span><br><span class="line">    <span class="keyword">let</span> link = <span class="built_in">document</span>.createElement(<span class="string">"a"</span>);</span><br><span class="line">    link.style.display = <span class="string">"none"</span>;</span><br><span class="line">    link.href = url;</span><br><span class="line">    link.setAttribute(<span class="string">"download"</span>, filename + <span class="string">".xls"</span>);</span><br><span class="line">    <span class="built_in">document</span>.body.appendChild(link);</span><br><span class="line">    link.click();</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h4 id="2、在页面中引用"><a href="#2、在页面中引用" class="headerlink" title="2、在页面中引用"></a>2、在页面中引用</h4><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> style <span class="keyword">from</span> <span class="string">"@/static/js/style"</span>;</span><br></pre></td></tr></table></figure>

<h4 id="二、使用"><a href="#二、使用" class="headerlink" title="二、使用"></a><strong>二、使用</strong></h4><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//导出表格</span></span><br><span class="line">            exportDialog() &#123;</span><br><span class="line">                <span class="built_in">console</span>.log(<span class="keyword">this</span>.supplierId)</span><br><span class="line">                <span class="keyword">let</span> obj = &#123;</span><br><span class="line">                    page: <span class="number">0</span>,</span><br><span class="line">                    size: <span class="number">100000</span>,</span><br><span class="line">                    start_time: <span class="keyword">this</span>.startTime,</span><br><span class="line">                    end_time: <span class="keyword">this</span>.endTime,</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">this</span>.$http.getFile(<span class="string">"/api"</span>, obj).then(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">                    style.operateFile(res, <span class="string">'订单记录'</span>)</span><br><span class="line">                    <span class="comment">/*var filename = '订单记录';</span></span><br><span class="line"><span class="comment">                    let url = window.URL.createObjectURL(res)</span></span><br><span class="line"><span class="comment">                    let link = document.createElement('a')</span></span><br><span class="line"><span class="comment">                    link.style.display = 'none'</span></span><br><span class="line"><span class="comment">                    link.href = url</span></span><br><span class="line"><span class="comment">                    link.setAttribute('download', filename + '.xls')</span></span><br><span class="line"><span class="comment">                    document.body.appendChild(link)</span></span><br><span class="line"><span class="comment">                    link.click()*/</span></span><br><span class="line">                &#125;)</span><br><span class="line">            &#125;,</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>常用</category>
        <category>常用工具</category>
      </categories>
      <tags>
        <tag>vue</tag>
      </tags>
  </entry>
  <entry>
    <title>图片移动、缩放</title>
    <url>/2020/07/15/%E5%9B%BE%E7%89%87%E7%A7%BB%E5%8A%A8%E3%80%81%E7%BC%A9%E6%94%BE/</url>
    <content><![CDATA[<p><img src="https://cdn.jsdelivr.net/gh/liebexiao/myImgs/20200717171538.png" alt=""></p>
<a id="more"></a>

<h4 id="html"><a href="#html" class="headerlink" title="html"></a><strong>html</strong></h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;div class&#x3D;&quot;template_move_box&quot;&gt;</span><br><span class="line">    &lt;div class&#x3D;&quot;template_move&quot;&gt;</span><br><span class="line">        &lt;div class&#x3D;&quot;temp_url_box&quot;&gt;</span><br><span class="line">            &lt;img class&#x3D;&quot;template_url&quot; :src&#x3D;&quot;imageUrl&quot;&gt;</span><br><span class="line">            &lt;div class&#x3D;&quot;code_box&quot;&gt;</span><br><span class="line">                &lt;img class&#x3D;&quot;code_img&quot; src&#x3D;&quot;&#x2F;images&#x2F;test_code_img.jpg&quot;&gt;</span><br><span class="line">                &lt;div id&#x3D;&quot;zoom_id&quot;&gt;&lt;&#x2F;div&gt;</span><br><span class="line">            &lt;&#x2F;div&gt;</span><br><span class="line">        &lt;&#x2F;div&gt;</span><br><span class="line">    &lt;&#x2F;div&gt;</span><br><span class="line">&lt;&#x2F;div&gt;</span><br></pre></td></tr></table></figure>

<h4 id="css"><a href="#css" class="headerlink" title="css"></a><strong>css</strong></h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">.template_move_box &#123;</span><br><span class="line">    float: left;</span><br><span class="line">&#125;</span><br><span class="line">.template_move &#123;</span><br><span class="line">    width: 400px;</span><br><span class="line">    height: 600px;</span><br><span class="line">    position: relative;</span><br><span class="line">    background: #CCCCCC;</span><br><span class="line">    text-align: center;</span><br><span class="line">&#125;</span><br><span class="line">.temp_url_box &#123;</span><br><span class="line">    width: 337px;</span><br><span class="line">    height: 600px;</span><br><span class="line">    position: relative;</span><br><span class="line">    display: inline-block;</span><br><span class="line">&#125;</span><br><span class="line">.template_url &#123;</span><br><span class="line">    width: 100%;</span><br><span class="line">&#125;</span><br><span class="line">.code_box &#123;</span><br><span class="line">    position: absolute;</span><br><span class="line">    bottom: 0;</span><br><span class="line">    left: 0;</span><br><span class="line">    z-index: 1;</span><br><span class="line">    width: 100px;</span><br><span class="line">    height: 100px;</span><br><span class="line">&#125;</span><br><span class="line">.code_img &#123;</span><br><span class="line">    width: 100%;</span><br><span class="line">    cursor: move;</span><br><span class="line">&#125;</span><br><span class="line">#zoom_id &#123;</span><br><span class="line">    width: 10px;</span><br><span class="line">    height: 10px;</span><br><span class="line">    overflow: hidden;</span><br><span class="line">    cursor: se-resize;</span><br><span class="line">    position: absolute;</span><br><span class="line">    right: 0;</span><br><span class="line">    bottom: 0;</span><br><span class="line">    background-color: rgb(122, 191, 238);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="js"><a href="#js" class="headerlink" title="js"></a><strong>js</strong></h4><p>js 原生JavaScript，不需要引入插件</p>
<blockquote>
<p>在需要移动缩放的方法里面直接调用此方法就好。</p>
<p>此处有个小细节，在用JavaScript取 class 中dom文件的时候取到的是数组，需要在后面加【0】。例如：<strong>document.getElementsByClassName(“code_box”)[0]</strong></p>
<p>若是取 id 中的dom结构时则不需要加【0】。例如： <strong>document.getElementById(“zoom_id”)</strong></p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#x2F;&#x2F;移动缩放海报</span><br><span class="line">moveTeamp() &#123;</span><br><span class="line">    let that &#x3D; this;</span><br><span class="line">    setTimeout(() &#x3D;&gt; &#123;</span><br><span class="line">        &#x2F;&#x2F; box是装图片的容器,temp是图片移动缩放的范围,scale是控制缩放的小图标</span><br><span class="line">        let box &#x3D; document.getElementsByClassName(&quot;code_box&quot;)[0];</span><br><span class="line">        let temp &#x3D; document.getElementsByClassName(&#39;temp_url_box&#39;)[0];</span><br><span class="line">        let scale &#x3D; document.getElementById(&quot;zoom_id&quot;);</span><br><span class="line"></span><br><span class="line">        var codeOriginalW &#x3D; that.qrWidth;&#x2F;&#x2F;二维码图片原始宽度</span><br><span class="line">        var codeOriginalH &#x3D; that.qrHeight;&#x2F;&#x2F;二维码图片原始高度</span><br><span class="line">        var codeScale &#x3D; 0;&#x2F;&#x2F;图片缩放</span><br><span class="line"></span><br><span class="line">        &#x2F;&#x2F; 图片移动效果</span><br><span class="line">        box.onmousedown &#x3D; function (ev) &#123;</span><br><span class="line">            var oEvent &#x3D; ev;</span><br><span class="line">            &#x2F;&#x2F; 浏览器有一些图片的默认事件,这里要阻止</span><br><span class="line">            oEvent.preventDefault();</span><br><span class="line">            var disX &#x3D; oEvent.clientX - box.offsetLeft;</span><br><span class="line">            var disY &#x3D; oEvent.clientY - box.offsetTop;</span><br><span class="line"></span><br><span class="line">            &#x2F;*console.table(&#123;</span><br><span class="line">                &#39;鼠标点击事件&#39;:0,</span><br><span class="line">                &#39;鼠标指针距离页面左侧距离&#39;:oEvent.clientX,</span><br><span class="line">                &#39;图片距离父容器左侧距离&#39;:box.offsetLeft,</span><br><span class="line">                &#39;父容器加鼠标指针相对于图片点击位置 距离页面左侧距离&#39;:disX,</span><br><span class="line">            &#125;)*&#x2F;</span><br><span class="line"></span><br><span class="line">            temp.onmousemove &#x3D; function (ev) &#123;</span><br><span class="line">                oEvent &#x3D; ev;</span><br><span class="line">                oEvent.preventDefault();</span><br><span class="line">                var x &#x3D; oEvent.clientX - disX;</span><br><span class="line">                var y &#x3D; oEvent.clientY - disY;</span><br><span class="line"></span><br><span class="line">                &#x2F;&#x2F; 图形移动的边界判断</span><br><span class="line">                x &#x3D; x &lt;&#x3D; 0 ? 0 : x;</span><br><span class="line">                x &#x3D; x &gt;&#x3D; temp.offsetWidth - box.offsetWidth ? temp.offsetWidth - box.offsetWidth : x;</span><br><span class="line">                y &#x3D; y &lt;&#x3D; 0 ? 0 : y;</span><br><span class="line">                y &#x3D; y &gt;&#x3D; temp.offsetHeight - box.offsetHeight ? temp.offsetHeight - box.offsetHeight : y;</span><br><span class="line">                box.style.left &#x3D; x + &#39;px&#39;;</span><br><span class="line">                box.style.top &#x3D; y + &#39;px&#39;;</span><br><span class="line"></span><br><span class="line">                that.qrLeft &#x3D; x;</span><br><span class="line">                that.qrTop &#x3D; y;</span><br><span class="line"></span><br><span class="line">                &#x2F;*console.table(&#123;</span><br><span class="line">                    &#39;鼠标移动事件&#39;:1,</span><br><span class="line">                    &#39;图片相对于父元素左侧距离 &#39;:x,</span><br><span class="line">                    &#39;图片相对于父元素上方距离&#39;:y,</span><br><span class="line">                &#125;)*&#x2F;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            &#x2F;&#x2F; 图形移出父盒子取消移动事件,防止移动过快触发鼠标移出事件,导致鼠标弹起事件失效</span><br><span class="line">            temp.onmouseleave &#x3D; function () &#123;</span><br><span class="line">                temp.onmousemove &#x3D; null;</span><br><span class="line">                temp.onmouseup &#x3D; null;</span><br><span class="line">            &#125;</span><br><span class="line">            &#x2F;&#x2F; 鼠标弹起后停止移动</span><br><span class="line">            temp.onmouseup &#x3D; function () &#123;</span><br><span class="line">                temp.onmousemove &#x3D; null;</span><br><span class="line">                temp.onmouseup &#x3D; null;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        &#x2F;&#x2F; 图片缩放效果</span><br><span class="line">        scale.onmousedown &#x3D; function (e) &#123;</span><br><span class="line">            &#x2F;&#x2F; 阻止冒泡,避免缩放时触发移动事件</span><br><span class="line">            e.stopPropagation();</span><br><span class="line">            e.preventDefault();</span><br><span class="line">            var pos &#x3D; &#123;</span><br><span class="line">                &#39;w&#39;: box.offsetWidth,</span><br><span class="line">                &#39;h&#39;: box.offsetHeight,</span><br><span class="line">                &#39;x&#39;: e.clientX,</span><br><span class="line">                &#39;y&#39;: e.clientY</span><br><span class="line">            &#125;;</span><br><span class="line">            temp.onmousemove &#x3D; function (ev) &#123;</span><br><span class="line">                ev.preventDefault();</span><br><span class="line">                &#x2F;&#x2F; 设置图片的最小缩放为30*30</span><br><span class="line">                &#x2F;&#x2F;Math.max() 函数返回一组数中的最大值,</span><br><span class="line">                var w &#x3D; Math.max(30, ev.clientX - pos.x + pos.w);</span><br><span class="line">                &#x2F;&#x2F;缩放率</span><br><span class="line">                codeScale &#x3D; parseFloat((w &#x2F; codeOriginalW).toFixed(2));</span><br><span class="line">                &#x2F;&#x2F;设置宽高比例固定缩放</span><br><span class="line">                var h &#x3D; parseInt(codeOriginalH * codeScale);</span><br><span class="line">                &#x2F;&#x2F; console.log(w,h)</span><br><span class="line">                &#x2F;&#x2F; 设置图片的最大宽高，不超过父容器宽高</span><br><span class="line">                &#x2F;&#x2F;当宽度大于父元素</span><br><span class="line">                w &#x3D; w &gt;&#x3D; temp.offsetWidth - box.offsetLeft ? temp.offsetWidth - box.offsetLeft : w;</span><br><span class="line">                &#x2F;&#x2F; h &#x3D; h &gt;&#x3D; temp.offsetHeight-box.offsetTop ? temp.offsetHeight-box.offsetTop : h;</span><br><span class="line">                box.style.width &#x3D; w + &#39;px&#39;;</span><br><span class="line">                box.style.height &#x3D; h + &#39;px&#39;;</span><br><span class="line">                &#x2F;&#x2F; console.log(box.offsetWidth,box.offsetHeight)</span><br><span class="line">                &#x2F;* console.table(&#123;</span><br><span class="line">                     &#39;鼠标拖动事件&#39;: 1,</span><br><span class="line">                     &#39;改变后图片的宽度 &#39;: w,</span><br><span class="line">                     &#39;改变后图片的高度&#39;: h,</span><br><span class="line">                     &#39;图片缩放倍数&#39;: codeScale</span><br><span class="line">                 &#125;)*&#x2F;</span><br><span class="line"></span><br><span class="line">                that.codeWeight &#x3D; w;</span><br><span class="line">                that.codeHeight &#x3D; h;</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line">            temp.onmouseleave &#x3D; function () &#123;</span><br><span class="line">                temp.onmousemove &#x3D; null;</span><br><span class="line">                temp.onmouseup &#x3D; null;</span><br><span class="line">            &#125;</span><br><span class="line">            temp.onmouseup &#x3D; function () &#123;</span><br><span class="line">                temp.onmousemove &#x3D; null;</span><br><span class="line">                temp.onmouseup &#x3D; null;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;, 1000)</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>常用</category>
        <category>常用工具</category>
      </categories>
      <tags>
        <tag>pc</tag>
      </tags>
  </entry>
  <entry>
    <title>使用阿里云服务器配置域名</title>
    <url>/2020/07/16/%E4%BD%BF%E7%94%A8%E9%98%BF%E9%87%8C%E4%BA%91%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%85%8D%E7%BD%AE%E5%9F%9F%E5%90%8D/</url>
    <content><![CDATA[<p><img src="https://cdn.jsdelivr.net/gh/liebexiao/myImgs/20200717172235.png" alt=""></p>
<a id="more"></a>

<h4 id="1、登录已有账号、在侧边栏选择“域名”"><a href="#1、登录已有账号、在侧边栏选择“域名”" class="headerlink" title="1、登录已有账号、在侧边栏选择“域名”"></a><strong>1、登录已有账号、在侧边栏选择“域名”</strong></h4><p><img src="https://s1.ax1x.com/2020/07/17/UsnqLd.png" alt="UsnqLd.png"></p>
<h4 id="2、在列表中选择一个已有域名-进入"><a href="#2、在列表中选择一个已有域名-进入" class="headerlink" title="2、在列表中选择一个已有域名 进入"></a><strong>2、在列表中选择一个已有域名 进入</strong></h4><p><img src="https://s1.ax1x.com/2020/07/17/Usuykt.png" alt="Usuykt.png"></p>
<h4 id="3、进去看见此域名基本信息，选择“域名解析”"><a href="#3、进去看见此域名基本信息，选择“域名解析”" class="headerlink" title="3、进去看见此域名基本信息，选择“域名解析”"></a><strong>3、进去看见此域名基本信息，选择“域名解析”</strong></h4><p><img src="https://s1.ax1x.com/2020/07/17/UsuR1S.png" alt="UsuR1S.png"></p>
<h4 id="4、选择“添加纪录”"><a href="#4、选择“添加纪录”" class="headerlink" title="4、选择“添加纪录”"></a><strong>4、选择“添加纪录”</strong></h4><p><img src="https://s1.ax1x.com/2020/07/17/UsuTkq.png" alt="UsuTkq.png"></p>
<h4 id="5、新建子域名"><a href="#5、新建子域名" class="headerlink" title="5、新建子域名"></a><strong>5、新建子域名</strong></h4><p><img src="https://s1.ax1x.com/2020/07/17/UsuvnJ.png" alt="UsuvnJ.png"></p>
<h4 id="6、去服务器配置-nginx"><a href="#6、去服务器配置-nginx" class="headerlink" title="6、去服务器配置 nginx"></a><strong>6、去服务器配置 nginx</strong></h4><blockquote>
<p>根据路径，找到 nginx 文件夹并打开：</p>
</blockquote>
<p><img src="https://s1.ax1x.com/2020/07/17/UsKi9K.png" alt="UsKi9K.png"></p>
<p><img src="https://s1.ax1x.com/2020/07/17/UsKVnH.png" alt="UsKVnH.png"></p>
<h5 id="例子"><a href="#例子" class="headerlink" title="例子"></a><strong>例子</strong></h5><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">##test后台</span><br><span class="line">    server &#123;</span><br><span class="line">        listen       <span class="number">80</span>;</span><br><span class="line">        server_name  testp.main.com;</span><br><span class="line"></span><br><span class="line">        location / &#123;</span><br><span class="line">            root   testProject;</span><br><span class="line">            index  index.html index.htm;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        location /api &#123;</span><br><span class="line">        #	# add_header 'Access-Control-Allow-Origin' '*';</span><br><span class="line">        #	# proxy_pass http://;</span><br><span class="line">        	proxy_pass http:<span class="comment">//;</span></span><br><span class="line">            proxy_set_header Host $host;</span><br><span class="line">            proxy_set_header X-Real-IP $remote_addr;</span><br><span class="line">            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;</span><br><span class="line">    	&#125;</span><br><span class="line"></span><br><span class="line">        error_page   <span class="number">500</span> <span class="number">502</span> <span class="number">503</span> <span class="number">504</span>  /<span class="number">50</span>x.html;</span><br><span class="line">        location = <span class="regexp">/50x.html &#123;</span></span><br><span class="line"><span class="regexp">            root   html;</span></span><br><span class="line"><span class="regexp">        &#125;</span></span><br><span class="line"><span class="regexp">    &#125;</span></span><br></pre></td></tr></table></figure>

<h4 id="7、在服务器里重启-nginx-完成。"><a href="#7、在服务器里重启-nginx-完成。" class="headerlink" title="7、在服务器里重启 nginx,,完成。"></a><strong>7、在服务器里重启 nginx,,完成。</strong></h4><p><img src="https://s1.ax1x.com/2020/07/17/UsKoKe.png" alt="UsKoKe.png"></p>
<blockquote>
<p><strong>*此时在网页中输入域名即可访问到该项目。</strong></p>
</blockquote>
]]></content>
      <categories>
        <category>阿里云</category>
      </categories>
      <tags>
        <tag>js</tag>
      </tags>
  </entry>
  <entry>
    <title>canvas生成海报图</title>
    <url>/2020/07/15/canvas%E7%94%9F%E6%88%90%E6%B5%B7%E6%8A%A5%E5%9B%BE/</url>
    <content><![CDATA[<p><img src="https://s1.ax1x.com/2020/07/17/UysDeJ.jpg" alt=""></p>
<a id="more"></a>

<h3 id="一、样例展示"><a href="#一、样例展示" class="headerlink" title="一、样例展示"></a><strong>一、样例展示</strong></h3><p><a href="https://github.com/sunniejs/vue_canvas_poster" target="_blank" rel="noopener">源码地址</a></p>
<p>左上角为头像位置，右下角为二维码位置。</p>
<p><img src="https://s1.ax1x.com/2020/07/15/UdrlMq.png" alt="UdrlMq.png"></p>
<h3 id="二、使用"><a href="#二、使用" class="headerlink" title="二、使用"></a><strong>二、使用</strong></h3><h4 id="1、安装引用"><a href="#1、安装引用" class="headerlink" title="1、安装引用"></a>1、安装引用</h4><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">cnpm i vue-canvas-poster --save</span><br><span class="line"><span class="comment">/*单独使用*/</span></span><br><span class="line"><span class="keyword">import</span> &#123;vueCanvasPoster&#125; <span class="keyword">from</span> <span class="string">'vue-canvas-poster'</span></span><br><span class="line">components: &#123;</span><br><span class="line">            vueCanvasPoster</span><br><span class="line">        &#125;,</span><br><span class="line"><span class="comment">/*全局引用*/</span></span><br><span class="line"><span class="keyword">import</span> CanvasPoster <span class="keyword">from</span> <span class="string">'vue-canvas-poster'</span></span><br><span class="line">Vue.use(CanvasPoster)</span><br></pre></td></tr></table></figure>

<h4 id="2、html-使用"><a href="#2、html-使用" class="headerlink" title="2、html 使用"></a>2、html 使用</h4><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"content_container"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">vue-canvas-poster</span></span></span><br><span class="line"><span class="tag">    <span class="attr">:widthPixels</span>=<span class="string">"1000"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">:painting</span>=<span class="string">"painting"</span></span></span><br><span class="line"><span class="tag">    @<span class="attr">success</span>=<span class="string">"success"</span></span></span><br><span class="line"><span class="tag">    @<span class="attr">fail</span>=<span class="string">"fail"</span></span></span><br><span class="line"><span class="tag">  &gt;</span><span class="tag">&lt;/<span class="name">vue-canvas-poster</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--生成的海报--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">img</span> <span class="attr">:src</span>=<span class="string">"posterImg"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="3、变量、海报布局"><a href="#3、变量、海报布局" class="headerlink" title="3、变量、海报布局"></a>3、变量、海报布局</h4><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">posterImg: <span class="string">''</span>,</span><br><span class="line">                <span class="comment">//生成的海报</span></span><br><span class="line">                painting: &#123;</span><br><span class="line">                    width: <span class="string">'550px'</span>,</span><br><span class="line">                    height: <span class="string">'876px'</span>,</span><br><span class="line">                    background: <span class="string">'背景图'</span>,</span><br><span class="line">                    views: [&#123;</span><br><span class="line">                        type: <span class="string">'image'</span>,</span><br><span class="line">                        url: <span class="string">'图片链接'</span>,</span><br><span class="line">                        css: &#123;</span><br><span class="line">                            top: <span class="string">'20px'</span>,</span><br><span class="line">                            left: <span class="string">'36px'</span>,</span><br><span class="line">                            borderRadius: <span class="string">'40px'</span>,</span><br><span class="line">                            width: <span class="string">'80px'</span>,</span><br><span class="line">                            height: <span class="string">'80px'</span>,</span><br><span class="line">                        &#125;,</span><br><span class="line">                    &#125;, &#123;</span><br><span class="line">                        type: <span class="string">'text'</span>,</span><br><span class="line">                        text: <span class="string">'我的名字'</span>,</span><br><span class="line">                        css: &#123;</span><br><span class="line">                            top: <span class="string">'48px'</span>,</span><br><span class="line">                            left: <span class="string">'136px'</span>,</span><br><span class="line">                            width: <span class="string">'360px'</span>,</span><br><span class="line">                            maxLines: <span class="number">1</span>,</span><br><span class="line">                            fontSize: <span class="string">'26px'</span>,</span><br><span class="line">                        &#125;,</span><br><span class="line">                    &#125;, &#123;</span><br><span class="line">                        type: <span class="string">'qrcode'</span>,</span><br><span class="line">                        content: <span class="string">'这里写二维码链接地址'</span>,</span><br><span class="line">                        css: &#123;</span><br><span class="line">                            bottom: <span class="string">'50px'</span>,</span><br><span class="line">                            right: <span class="string">'26px'</span>,</span><br><span class="line">                            color: <span class="string">'#000'</span>,</span><br><span class="line">                            background: <span class="string">'#fff'</span>,</span><br><span class="line">                            width: <span class="string">'130px'</span>,</span><br><span class="line">                            height: <span class="string">'130px'</span>,</span><br><span class="line">                            borderWidth: <span class="string">'10px'</span>,</span><br><span class="line">                            borderColor: <span class="string">'#fff'</span></span><br><span class="line">                        &#125;,</span><br><span class="line">                    &#125;,],</span><br><span class="line">                &#125;,</span><br></pre></td></tr></table></figure>

<h4 id="4、js"><a href="#4、js" class="headerlink" title="4、js"></a>4、js</h4><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//成功生成海报</span></span><br><span class="line">            success(src) &#123;</span><br><span class="line">                <span class="keyword">this</span>.posterImg = src;</span><br><span class="line">                <span class="built_in">console</span>.log(src)</span><br><span class="line">            &#125;,</span><br><span class="line">            fail(err) &#123;</span><br><span class="line">                alert(err)</span><br><span class="line">            &#125;,</span><br></pre></td></tr></table></figure>

<h3 id="规范"><a href="#规范" class="headerlink" title="规范"></a><strong>规范</strong></h3><p>Canvas 需要根据一定的规范来进行图片绘制，当然比直接画 canvas 简单的多。</p>
<h4 id="调色板属性"><a href="#调色板属性" class="headerlink" title="调色板属性"></a><strong>调色板属性</strong></h4><p>一个调色板首先需要给予一些整体属性</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">background: 可以是颜色值，也可以为网络图片的链接，默认为白色，支持渐变色</span><br><span class="line">width: 宽度</span><br><span class="line">height: 高度</span><br><span class="line">borderRadius: 边框的圆角（该属性也同样适用于子 view）</span><br><span class="line">views: 里面承载子 view</span><br></pre></td></tr></table></figure>

<h4 id="View-属性"><a href="#View-属性" class="headerlink" title="View 属性"></a><strong>View 属性</strong></h4><p>当我们把整体的调色板属性构建起来后，里面就可以添加子 View 来进行绘制了。</p>
<table>
<thead>
<tr>
<th>type</th>
<th align="center">内容</th>
<th align="center">description</th>
<th align="center">自有 css</th>
</tr>
</thead>
<tbody><tr>
<td>image</td>
<td align="center">url</td>
<td align="center">表示图片资源的地址，本地或网络</td>
<td align="center">见 image 小节</td>
</tr>
<tr>
<td>text</td>
<td align="center">text</td>
<td align="center">文本的内容</td>
<td align="center">见 text 小节</td>
</tr>
<tr>
<td>rect</td>
<td align="center">无</td>
<td align="center">矩形</td>
<td align="center">color: 颜色，支持渐变色</td>
</tr>
<tr>
<td>qrcode</td>
<td align="center">content</td>
<td align="center">画二维码</td>
<td align="center">background: 背景颜色（默认为透明色）color: 二维码颜色（默认黑色）</td>
</tr>
</tbody></table>
<blockquote>
<p>1、image</p>
</blockquote>
<p>image 可以设置成本地图片或者网络图片， 本地用require()引入图片。 并且如果未设置 image 的长宽，则长宽的属性值会默认设为auto。</p>
<table>
<thead>
<tr>
<th align="center">属性名称</th>
<th align="center">说明</th>
<th align="center">默认值</th>
</tr>
</thead>
<tbody><tr>
<td align="center">width</td>
<td align="center">image的宽度</td>
<td align="center">auto</td>
</tr>
<tr>
<td align="center">height</td>
<td align="center">image的高度</td>
<td align="center">auto</td>
</tr>
<tr>
<td align="center">mode</td>
<td align="center">图片裁剪、缩放的模式</td>
<td align="center">aspectFill</td>
</tr>
</tbody></table>
<p><strong>scaleToFill</strong>：不保持纵横比缩放图片，使图片的宽高完全拉伸至填满 image 元素</p>
<p><strong>aspectFill</strong>：保持纵横比缩放图片，只保证图片的短边能完全显示出来。也就是说，图片通常只在水平或垂直方向是完整的，另一个方向将会发生截取。</p>
<p><strong>注：mode 属性和小程序 image 的 mode 属性功能一致，只是支持的类型只有两种，且默认值不同。 当 width 或 height 属性设置为 auto 时，mode 属性失效</strong></p>
<blockquote>
<p>2、text</p>
</blockquote>
<p>因为 text 的特殊性，此处对 text 进行单独说明。</p>
<table>
<thead>
<tr>
<th align="center">属性名称</th>
<th align="center">说明</th>
<th align="center">默认值</th>
</tr>
</thead>
<tbody><tr>
<td align="center">fontSize</td>
<td align="center">字体大小</td>
<td align="center">20px</td>
</tr>
<tr>
<td align="center">color</td>
<td align="center">字体颜色</td>
<td align="center">black</td>
</tr>
<tr>
<td align="center">maxLines</td>
<td align="center">最大行数</td>
<td align="center">不限，根据 width 来</td>
</tr>
<tr>
<td align="center">lineHeight</td>
<td align="center">行高（上下两行文字baseline的距离）</td>
<td align="center">fontSize 大小</td>
</tr>
<tr>
<td align="center">fontWeight</td>
<td align="center">字体粗细。仅支持 normal, bold</td>
<td align="center">normal</td>
</tr>
<tr>
<td align="center">textDecoration</td>
<td align="center">文本修饰，支持 underline、 overline、 line-through，也可组合使用</td>
<td align="center">无效果</td>
</tr>
<tr>
<td align="center">textStyle</td>
<td align="center">fill： 填充样式，stroke：镂空样式</td>
<td align="center">fill</td>
</tr>
<tr>
<td align="center">fontFamily</td>
<td align="center">字体</td>
<td align="center">sans-serif</td>
</tr>
<tr>
<td align="center">background</td>
<td align="center">文字背景颜色</td>
<td align="center">无</td>
</tr>
<tr>
<td align="center">padding</td>
<td align="center">文字背景颜色边际与文字间距</td>
<td align="center">0px</td>
</tr>
<tr>
<td align="center">textAlign</td>
<td align="center">文字的对齐方式，分为 left, center, right，view 的对齐方式请看 align 属性</td>
<td align="center">left</td>
</tr>
</tbody></table>
<p>当文字设置 width 属性后，则文字布局的最大宽度不会超过该 width 。如果内容超过 width，则会进行换行，如果此时未设置 maxLines 属性，则会把所有内容进行换行处理，行数由内容和 width 决定。如果此时设置了 maxLines 属性，则最大展示所设置的行数，如果还有多余内容未展示出来，则后面会带上 … 。</p>
<h4 id="布局属性"><a href="#布局属性" class="headerlink" title="布局属性"></a><strong>布局属性</strong></h4><p>以上 View ，除去自己拥有的特别属性外，还有以下的通用布局属性</p>
<table>
<thead>
<tr>
<th>属性</th>
<th>说明</th>
<th>默认</th>
</tr>
</thead>
<tbody><tr>
<td>rotate</td>
<td>旋转，按照顺时针旋转的度数</td>
<td>不旋转</td>
</tr>
<tr>
<td>width、height</td>
<td>view 的宽度和高度，其中 image 和 text 可不设置</td>
<td></td>
</tr>
<tr>
<td>top、right、bottom、left</td>
<td>如 css 中为 absolute 布局时的作用，可为 负值</td>
<td>默认 top 和 left 为 0</td>
</tr>
</tbody></table>
<blockquote>
<p>相对布局方法</p>
</blockquote>
<p>很多人有获得文本宽度的需求，因为文本宽度随着字数不同而动态变化，如果想在文本后面加个图标，那么我们就需要获得文本宽度。 解决方案如下：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">1，首先你需要为检测长度的文本添加一个 id。如下</span><br><span class="line">&#123;</span><br><span class="line">  id: &#39;my-text-id&#39;,</span><br><span class="line">  type: &#39;text&#39;,</span><br><span class="line">  </span><br><span class="line">2，然后在后面的 view 中，你可以在 left 和 right 属性中使用这个id。如下</span><br><span class="line">left: [&#39;10px&#39;, &#39;my-text-id&#39;, 比例] </span><br><span class="line">表示布局在距离左边（10px + 该text文本宽度 * 比例） 的距离，比例默认为 1，可省去，你也可以使用负数或小数来做计算，最终的 left 会加上文本宽度乘以该数的值。</span><br><span class="line"></span><br><span class="line">注意：比例一定为一个 number</span><br></pre></td></tr></table></figure>

<p>如果想获得高度，top 也支持上述用法，并且除文本外，你可以对任何 view 设置一个 id，然后使用上述方法进行相对布局。</p>
<p><strong>注：相对布局的那个 view 代码一定需要在被相对的 view 的下面。</strong></p>
<blockquote>
<p>1、border 类型</p>
</blockquote>
<table>
<thead>
<tr>
<th>属性</th>
<th>说明</th>
<th>默认</th>
</tr>
</thead>
<tbody><tr>
<td>borderRadius</td>
<td>边界圆角程度，如果是正方形布局，该属性为一半宽或高时，则为圆形</td>
<td>0</td>
</tr>
<tr>
<td>borderWidth</td>
<td>边界宽度，外边界</td>
<td>必设值，否则无边框效果</td>
</tr>
<tr>
<td>borderColor</td>
<td>边框颜色</td>
<td>black</td>
</tr>
</tbody></table>
<p>align</p>
<p>Painter 的 align 类型与 css 中的 align 有些许不同。在 Painter 中 align 表示 view 本身的对齐方式，而不像 css 中表示对其子 view 的操作。align 可以作用在 Painter 支持的所有 view 上。它以设置的 left、top、right、bottom 的位置为基准，然后做不同的对齐操作。并且 align 在文字多行情况下，会影响多行文字的对齐方式。</p>
<p><strong>注意：如果布局使用了 right 确定位置，则该 view 会默认右对齐布局，但此时文字还是从左边绘制。</strong></p>
<h4 id="CSS3-支持"><a href="#CSS3-支持" class="headerlink" title="CSS3 支持"></a><strong>CSS3 支持</strong></h4><blockquote>
<p>1、shadow</p>
</blockquote>
<p>shadow 可以同时修饰 image、rect、text、qrcode 等 。在修饰 text 时则相当于 text-shadow；修饰 image 和 rect 时相当于 box-shadow；修饰 qrcode 时，则相当于二维码有效区域的投影。</p>
<p>使用方法：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">shadow: &#39;h-shadow v-shadow blur color&#39;;</span><br><span class="line">h-shadow: 必需。水平阴影的位置。允许负值。</span><br><span class="line">v-shadow: 必需。垂直阴影的位置。允许负值。</span><br><span class="line">blur: 必需。模糊的距离。</span><br><span class="line">color: 必需。阴影的颜色。</span><br></pre></td></tr></table></figure>

<p>渐变色支持</p>
<p>你可以在画布的 background 属性或者 rect 的 color 属性中使用以下方式实现 css 3 的渐变色，其中 radial-gradient 渐变的圆心为 view 中点，半径为最长边，目前不支持自己设置。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">linear-gradient(-135deg, blue 0%, rgba(18, 52, 86, 1) 20%, #987 80%)</span><br><span class="line">radial-gradient(rgba(0, 0, 0, 0) 5%, #0ff 15%, #f0f 60%)</span><br></pre></td></tr></table></figure>

<p><strong>！！！注意：颜色后面的百分比一定得写。</strong></p>
<h4 id="事件"><a href="#事件" class="headerlink" title="事件"></a><strong>事件</strong></h4><blockquote>
<p>success</p>
</blockquote>
<p>返回生成 base64 图片的本地 url,设置 src</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">methods: &#123;</span><br><span class="line">  success(src) &#123;</span><br><span class="line">    &#x2F;&#x2F; 设置img的src</span><br><span class="line">    this.src &#x3D; src</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>fail</p>
</blockquote>
<p>返回失败信息</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">fail(err) &#123;</span><br><span class="line">     console.log(&#39;fail&#39;, err)</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>vue</category>
        <category>组件</category>
      </categories>
      <tags>
        <tag>h5</tag>
      </tags>
  </entry>
  <entry>
    <title>知识点</title>
    <url>/2020/09/08/web%E7%9F%A5%E8%AF%86%E7%82%B9/</url>
    <content><![CDATA[<p>总结一些常见知识点。</p>
<a id="more"></a>

<h3 id="一、HTTP-浏览器"><a href="#一、HTTP-浏览器" class="headerlink" title="一、HTTP/浏览器"></a>一、HTTP/浏览器</h3><h4 id="1、http与https协议"><a href="#1、http与https协议" class="headerlink" title="1、http与https协议"></a>1、http与https协议</h4><p>http是超文本传输协议，信息是明文传输，协议端口为80。</p>
<p>https是有安全性的ssl加密传输协议，端口为443。</p>
<blockquote>
<p>https步骤</p>
<ul>
<li>首先要求服务器建立ssl链接</li>
<li>服务端接收请求之后，将ssl证书和公钥一起传给客户端</li>
<li>客户端用公钥来加密会话密钥，并传给服务器</li>
<li>服务器解开密钥并将数据发给客户端，完成通信。</li>
</ul>
</blockquote>
<h4 id="2-1、浏览器打开一个url都发生了哪些操作"><a href="#2-1、浏览器打开一个url都发生了哪些操作" class="headerlink" title="2.1、浏览器打开一个url都发生了哪些操作"></a>2.1、浏览器打开一个url都发生了哪些操作</h4><ol>
<li>DNS域名解析<ul>
<li>先从缓存中查找IP（浏览器缓存、系统 host 文件缓存、路由器缓存）</li>
<li>缓存中查找不到就通过DNS解析URL对应的IP</li>
</ul>
</li>
<li>通过TCP3次握手 与服务器建立连接</li>
<li>向服务器发送请求</li>
<li>接收到服务器的响应</li>
<li>通过TCP4次挥手 与服务器断开连接</li>
<li>对页面进行渲染</li>
</ol>
<h4 id="2-2、浏览器是怎样渲染页面的"><a href="#2-2、浏览器是怎样渲染页面的" class="headerlink" title="2.2、浏览器是怎样渲染页面的"></a>2.2、浏览器是怎样渲染页面的</h4><ol>
<li>解析html，构建DOM树</li>
<li>解析css</li>
<li>将css和DOM合并，构建渲染树</li>
<li>布局和绘制，重绘，重排</li>
</ol>
<h4 id="3、Ajax请求的五个步骤"><a href="#3、Ajax请求的五个步骤" class="headerlink" title="3、Ajax请求的五个步骤"></a>3、Ajax请求的五个步骤</h4><ol>
<li>创建 <strong>XMLHttpRequest</strong> 对象</li>
<li>设置一个回调函数</li>
<li>与服务器建立连接 open()</li>
<li>向服务器发送数据</li>
<li>在回调函数中根据不同的响应状态进行处理</li>
</ol>
<h4 id="4、一次js请求一般情况下有哪些地方会有缓存处理"><a href="#4、一次js请求一般情况下有哪些地方会有缓存处理" class="headerlink" title="4、一次js请求一般情况下有哪些地方会有缓存处理"></a>4、一次js请求一般情况下有哪些地方会有缓存处理</h4><ul>
<li>浏览器端缓存</li>
<li>浏览器端文件缓存</li>
<li>http缓存</li>
<li>服务器端文件缓存</li>
<li>表现层&amp;DOM缓存</li>
</ul>
<h4 id="5、主流浏览器及内核"><a href="#5、主流浏览器及内核" class="headerlink" title="5、主流浏览器及内核"></a>5、主流浏览器及内核</h4><p><strong>浏览器内核：渲染引擎，负责对网页语法解释。</strong></p>
<ul>
<li>谷歌——webkit/blink</li>
<li>safari——webkit</li>
<li>IE——trident</li>
<li>火狐——gecko</li>
<li>Opera——presto/webkit/blink</li>
</ul>
<h4 id="6、cookie、sessionStorage和localStorage的区别"><a href="#6、cookie、sessionStorage和localStorage的区别" class="headerlink" title="6、cookie、sessionStorage和localStorage的区别"></a>6、cookie、<strong>sessionStorage</strong>和<strong>localStorage</strong>的区别</h4><p><strong>sessionStorage</strong>和<strong>localStorage</strong>都是本地缓存，不会把数据发给服务器</p>
<p>sessionStorage：</p>
<ul>
<li>只在窗口关闭前有效</li>
</ul>
<p>localStorage：</p>
<ul>
<li>永久保存</li>
</ul>
<p>cookie ：</p>
<ul>
<li>会在浏览器和服务器间来回传递</li>
<li>可以设置存储时间</li>
<li>存储大小只有4k</li>
</ul>
<h4 id="7、HTTP支持的方法"><a href="#7、HTTP支持的方法" class="headerlink" title="7、HTTP支持的方法"></a>7、HTTP支持的方法</h4><blockquote>
<p>GET、POST、PUT、DELETE</p>
</blockquote>
<h4 id="8、GET和POST区别"><a href="#8、GET和POST区别" class="headerlink" title="8、GET和POST区别"></a>8、GET和POST区别</h4><ul>
<li><strong>GET</strong>请求参数通过url传递，<strong>POST</strong>放在 request body 中</li>
<li><strong>GET</strong>传递参数长度有限制，<strong>POST</strong>没有</li>
<li><strong>GET</strong>只能进行url编码，<strong>POST</strong>支持多种编码方式</li>
<li><strong>GET</strong>请求参数会被保留在浏览历史记录里面，<strong>POST</strong>会更安全</li>
</ul>
<h4 id="9、HTTP返回的状态码"><a href="#9、HTTP返回的状态码" class="headerlink" title="9、HTTP返回的状态码"></a>9、HTTP返回的状态码</h4><ul>
<li>200——请求成功，强制缓存</li>
<li>301——永久重定向</li>
<li>302——临时重定向</li>
<li>304——协商缓存（当请求的资源未发生改变）</li>
<li>400——客户端请求语法错误（参数错误）</li>
<li>401——要求用户进行身份认证</li>
<li>403——服务器接收到请求，但拒绝执行（通常由于服务器上文件或目录的权限设置导致的访问错误。）</li>
<li>404——找不到链接</li>
<li>405——请求方法错误</li>
<li>500——服务器错误</li>
</ul>
<h4 id="10、跨域"><a href="#10、跨域" class="headerlink" title="10、跨域"></a>10、跨域</h4><ol>
<li><p>跨域定义：</p>
<p>浏览器出于安全考虑，有同源策略，</p>
<p>同源是指 ：协议+域名+端口 三者相同</p>
<p>例如：</p>
<blockquote>
<p>域名不同 www.<strong>a</strong>.com/1.html 请求 www.<strong>b</strong>.com/1.js<br>端口不同 <a href="http://www.a.com:**8000**/1.html">www.a.com:**8000**/1.html</a> 请求 <a href="http://www.a.com:**8001**/1.js">www.a.com:**8001**/1.js</a><br>协议不同 <strong>http</strong>://<a href="http://www.a.com/1.html" target="_blank" rel="noopener">www.a.com/1.html</a> 请求 <strong>https</strong>://<a href="http://www.a.com/1.html" target="_blank" rel="noopener">www.a.com/1.html</a></p>
</blockquote>
</li>
<li><p>同源 限制以下几种行为：</p>
<ul>
<li>本地存储无法读取</li>
<li>DOM和js对象无法获得</li>
<li>Ajax请求不能发送</li>
</ul>
</li>
<li><p>如何实现跨域请求</p>
<ul>
<li><strong>jsonp</strong>——利用&lt; script&gt;没有跨域限制，通过&lt; script&gt;的src属性发送带有callback参数的get请求，服务器将返回参数拼凑到callback函数中返回给浏览器，<strong>（是通过&lt; script&gt;标签将资源当作js脚本来加载）</strong>但是只能使用get方法，易受XSS攻击</li>
<li><strong>nginx</strong>——反向代理服务器，代理跨域请求。<strong>通过nginx配置代替a网站向b网站请求资源，再将拿到的资源给a</strong></li>
<li>h5的 <strong>websocket</strong> ——在单个 TCP 连接上进行全双工通讯的协议，同时允许跨域请求。允许服务端主动向客户端推送数据。在 WebSocket API 中，浏览器和服务器只需要完成一次握手，两者之间就直接可以创建持久性的连接，并进行双向数据传输。</li>
</ul>
</li>
</ol>
<h4 id="11、XSS和CSFR攻击，防御方法"><a href="#11、XSS和CSFR攻击，防御方法" class="headerlink" title="11、XSS和CSFR攻击，防御方法"></a>11、XSS和CSFR攻击，防御方法</h4><p>原理：</p>
<p>XSS——跨站脚本攻击，注入js脚本进行攻击</p>
<p>CSFR——跨站请求攻击，利用用户的有效cookie伪造一个请求</p>
<p>防范：</p>
<p>XSS——对输入进行过滤（使用白名单，只能出现某些字符；黑名单，不能出现某些字符），对输出进行编码</p>
<p>CSFR——在请求中添加token并验证，使用验证码。</p>
<h4 id="12、CDN（内容分发网络）"><a href="#12、CDN（内容分发网络）" class="headerlink" title="12、CDN（内容分发网络）"></a>12、CDN（内容分发网络）</h4><p>功能：减少带宽需求量、提高网络访问稳定性</p>
<p>基本原理：</p>
<p>类似于供货商就近配送，</p>
<p>用户访问网站时，安排距离用户最近的服务器响应用户需求。</p>
<h3 id="二、HTML-CSS"><a href="#二、HTML-CSS" class="headerlink" title="二、HTML/CSS"></a>二、HTML/CSS</h3><h4 id="1、什么是盒子模型"><a href="#1、什么是盒子模型" class="headerlink" title="1、什么是盒子模型"></a>1、什么是盒子模型</h4><p>由内容content、内边距padding、外边距margin、边框border这四部分构成的模型。</p>
<blockquote>
<p>标准盒子模型：宽度：content      box-sizing:content-box;表示</p>
<ul>
<li>需要占据位置：margin * 2+padding * 2+border * 2+content</li>
<li>实际大小：padding * 2+border * 2+content</li>
</ul>
</blockquote>
<blockquote>
<p>IE盒子模型：宽度：border+padding+content     box-sizing:border-box;表示</p>
<ul>
<li>需要占据位置：margin * 2+content</li>
<li>实际大小：content</li>
</ul>
</blockquote>
<h5 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h5><p>加上DOCTYPE声明即选择了标准盒子模型。</p>
<p>如果不加声明，则不同的浏览器会采用不同的盒模型解析。</p>
<h4 id="2、行内元素有哪些？块级元素有哪些？-空-void-元素有那些？"><a href="#2、行内元素有哪些？块级元素有哪些？-空-void-元素有那些？" class="headerlink" title="2、行内元素有哪些？块级元素有哪些？ 空(void)元素有那些？"></a>2、<strong>行内元素有哪些？块级元素有哪些？ 空(void)元素有那些？</strong></h4><blockquote>
<p>img 属于行内替换元素，效果与块状元素一致</p>
</blockquote>
<ul>
<li>行内元素——input、textarea、a、span、select</li>
<li>块级元素——div、form、ul、ol、li、h1-h6、p</li>
<li>空元素——指没有内容的html元素，input、br、img、meta、link</li>
</ul>
<h4 id="3、表单中readonly和disabled区别"><a href="#3、表单中readonly和disabled区别" class="headerlink" title="3、表单中readonly和disabled区别"></a>3、表单中readonly和disabled区别</h4><p>相同点：用户不能改变表单内容</p>
<p>不同点：</p>
<ul>
<li>readonly只对<strong>input</strong>和<strong>textarea</strong>有效，disabled还对<strong>radio</strong>和<strong>checkbox</strong>有效</li>
<li>readonly 可以获取焦点，disabled不能获取焦点</li>
<li>如果表单是disabled，则该字段不会提交</li>
</ul>
<h4 id="4、BFC规范"><a href="#4、BFC规范" class="headerlink" title="4、BFC规范"></a>4、BFC规范</h4><p>BFC，块级格式化上下文，是页面上一个隔离的独立容器，内外元素不会相互影响，相邻的块级盒垂直方向的margin会重叠。</p>
<p>例如：</p>
<p>文章列表中，左边为一个width为60px的图片，右边为标题，图片使用float:left,标题使用margin-left:80px；那么这条列表就是一个BFC容器。</p>
<h4 id="5、src和href的区别"><a href="#5、src和href的区别" class="headerlink" title="5、src和href的区别"></a>5、src和href的区别</h4><p>href是指向网络资源，用于超链接</p>
<p>src是指向外部资源，可以下载，在遇到src时其他资源将暂停下载，直到src下载编译执行完毕。</p>
<h4 id="6、px和em区别"><a href="#6、px和em区别" class="headerlink" title="6、px和em区别"></a>6、px和em区别</h4><p>px的值是固定的，em不固定</p>
<p>1em=16px</p>
<h4 id="7、link和-import的区别"><a href="#7、link和-import的区别" class="headerlink" title="7、link和@import的区别"></a>7、link和@import的区别</h4><ol>
<li>link是html标签 ，@import是css提供的</li>
<li>link在加载页面的时候就会被加载，@import被引用的css需要等引用的css文件加载完才能加载</li>
<li>link没有兼容问题，@import只在IE5以上才能识别</li>
<li>link方式的样式权重高于@import的权重</li>
</ol>
<h4 id="8、rbga-与opacity透明度区别"><a href="#8、rbga-与opacity透明度区别" class="headerlink" title="8、rbga()与opacity透明度区别"></a>8、rbga()与opacity透明度区别</h4><p>opacity作用于元素，以及元素内的所有内容的透明度，</p>
<p>rgba只作用于元素的颜色及背景颜色，设置rgba的元素内容及子元素都不会有透明效果</p>
<h4 id="9、几种隐藏元素的方法"><a href="#9、几种隐藏元素的方法" class="headerlink" title="9、几种隐藏元素的方法"></a>9、几种隐藏元素的方法</h4><ul>
<li>visibility: hidden; 只是隐藏元素，占用空间还存在。</li>
<li>opacity:0; 只是让元素透明，其点击事件还是存在</li>
<li>position: absolute; 设置一个很大的left负值定位，使元素定位在可见区域之外</li>
<li>transform: scale(0); 将元素设置为缩放无限小，元素将不可见，所在位置将被保留</li>
<li>display: none; 元素不可见，元素不占位置，会改变布局。</li>
</ul>
<h4 id="10、Doctype作用、区别"><a href="#10、Doctype作用、区别" class="headerlink" title="10、Doctype作用、区别"></a>10、Doctype作用、区别</h4><ol>
<li>作用：告知浏览器的解析器用什么文档标准解析这个文档</li>
<li>类型：过度的、严格的、框架的。</li>
<li>标准模式与兼容模式区别<ul>
<li>标准模式的排版和js运作模式都是以该浏览器支持的最高标准运行。</li>
<li>在兼容模式模拟老式浏览器的行为，防止站点无法工作。尽可能的显示能显示的东西给用户看。</li>
</ul>
</li>
</ol>
<h4 id="11、H5新特性"><a href="#11、H5新特性" class="headerlink" title="11、H5新特性"></a>11、H5新特性</h4><ol>
<li><p>语义化标签</p>
</li>
<li><p>新增表单input输入类型。</p>
<blockquote>
<p>color、date、number、tel、time、等</p>
</blockquote>
</li>
<li><p>新增表单属性</p>
<blockquote>
<p>placehoder、min、max、height、width、等</p>
</blockquote>
</li>
<li><p>新增音视频标签</p>
</li>
<li><p>WebSocket</p>
</li>
</ol>
<h4 id="12、语义化"><a href="#12、语义化" class="headerlink" title="12、语义化"></a>12、语义化</h4><ol>
<li><p>语义化的优点</p>
<ul>
<li>代码结构清晰，有利于开发和维护</li>
<li>页面结构清晰，提高用户体验</li>
<li>方便其他设备解析，根据语义渲染网页</li>
<li>有利于搜索引擎优化，搜索引擎爬虫会根据不同的标签来赋予不同的权重</li>
</ul>
</li>
<li><p>语义化标签</p>
<p>title、header、article、address、h1-h6、ul、ol、等</p>
</li>
</ol>
<h4 id="13、img中的alt和title属性"><a href="#13、img中的alt和title属性" class="headerlink" title="13、img中的alt和title属性"></a>13、img中的alt和title属性</h4><blockquote>
<p><strong>alt</strong> 是图片加载失败时，显示在网页上的替代文字。是img的必要属性。</p>
</blockquote>
<blockquote>
<p><strong>title</strong> 是鼠标放在图片上时显示的文字。</p>
</blockquote>
<p>搜索引擎对于图片意思的判断，主要靠alt属性，在图片alt属性中以包含关键字的简要的文字说明，也是页面优化的一部分。</p>
<h4 id="14、清除浮动有哪些方式"><a href="#14、清除浮动有哪些方式" class="headerlink" title="14、清除浮动有哪些方式"></a>14、清除浮动有哪些方式</h4><ol>
<li><p>父级div定义伪类 <strong>clearfix</strong></p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.clearfix</span><span class="selector-pseudo">:after</span> &#123;</span><br><span class="line">        <span class="attribute">content</span>: <span class="string">"."</span>;</span><br><span class="line">        <span class="attribute">display</span>: block;</span><br><span class="line">        <span class="attribute">height</span>: <span class="number">0</span>;</span><br><span class="line">        <span class="attribute">clear</span>: both;</span><br><span class="line">        <span class="attribute">visibility</span>: hidden;</span><br><span class="line">        <span class="attribute">zoom</span>: <span class="number">1</span></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>在结尾处添加空div标签 clear:both;</p>
</li>
<li><p>父级div定义height</p>
</li>
<li><p>为父元素添加 <strong>overflow：hidden;</strong> （超出的部分会被隐藏。）</p>
</li>
</ol>
<h4 id="15、css选择符有哪些"><a href="#15、css选择符有哪些" class="headerlink" title="15、css选择符有哪些"></a>15、css选择符有哪些</h4><ol>
<li>id选择器</li>
<li>class选择器</li>
<li>标签选择器</li>
<li>通配符选择器 *</li>
<li>相邻选择器</li>
<li>子选择器</li>
<li>后代选择器</li>
<li>属性选择器</li>
<li>伪类选择器</li>
</ol>
<p>可继承的样式：font-size ; font-family ; color</p>
<p>不可继承的样式：border、padding、margin、height、width</p>
<h4 id="16、画三角"><a href="#16、画三角" class="headerlink" title="16、画三角"></a>16、画三角</h4><figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.div</span>&#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">border</span>: <span class="number">100px</span> solid transparent;</span><br><span class="line">    <span class="attribute">border-bottom</span>: <span class="number">100px</span> solid blue;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="17、父子同时居中"><a href="#17、父子同时居中" class="headerlink" title="17、父子同时居中"></a>17、父子同时居中</h4><p><img src="https://cdn.jsdelivr.net/gh/liebexiao/myImgs/20201013134944.png" alt=""></p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.test_fa</span>&#123;</span><br><span class="line">    <span class="attribute">background</span>: <span class="number">#f44</span>;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">300px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">200px</span>;</span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">    <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">right</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">bottom</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">margin</span>: auto;</span><br><span class="line">    <span class="attribute">display</span>: flex;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.test_ch</span>&#123;</span><br><span class="line">    <span class="attribute">align-self</span>: center;</span><br><span class="line">    <span class="attribute">margin</span>: auto;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="18、画一条0-5px线"><a href="#18、画一条0-5px线" class="headerlink" title="18、画一条0.5px线"></a>18、画一条0.5px线</h4><figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">border-bottom</span>: 1<span class="selector-tag">px</span> <span class="selector-tag">solid</span> <span class="selector-id">#000</span>;</span><br><span class="line"><span class="selector-tag">transform</span>: <span class="selector-tag">scaleY</span>(0<span class="selector-class">.5</span>);</span><br></pre></td></tr></table></figure>

<h4 id="19、transition和animate"><a href="#19、transition和animate" class="headerlink" title="19、transition和animate"></a>19、transition和animate</h4><p><strong>transition</strong> 过渡</p>
 <figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">transition</span>: 1<span class="selector-tag">s</span> 1<span class="selector-tag">s</span> <span class="selector-tag">height</span> <span class="selector-tag">ease</span>;</span><br></pre></td></tr></table></figure>

<ol>
<li>属性<ul>
<li>过渡时间</li>
<li>延迟时间（延迟多久开始动画）</li>
<li>需要过渡的属性</li>
<li>过渡类型（匀速、减速、加速、先加速再减速）</li>
</ul>
</li>
<li>特点<ul>
<li>需要事件触发</li>
<li>动画效果是一次性的，除非再一次触发</li>
<li>只有开始状态和结束状态</li>
<li>一个transition规则只能定义一个属性</li>
</ul>
</li>
</ol>
<p> <strong>animation</strong> 动画</p>
 <figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">div</span><span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line"> <span class="attribute">animation</span>: <span class="number">1s</span> changeColor; </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@-webkit-keyframes</span> changeColor &#123;</span><br><span class="line"> 0% &#123; <span class="attribute">background</span>: <span class="number">#c00</span>; &#125;</span><br><span class="line"> 50% &#123; <span class="attribute">background</span>: orange; &#125;</span><br><span class="line"> 100% &#123; <span class="attribute">background</span>: yellowgreen; &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol>
<li>属性<ul>
<li>动画时间</li>
<li>延迟时间</li>
<li>动画类型</li>
<li>动画名称</li>
<li>播放次数</li>
<li>播放状态（暂停/播放）</li>
<li>播放方向（循环向前播放/反方向播放）</li>
<li>定义动画开始之前和结束之后发生的操作</li>
</ul>
</li>
</ol>
<h3 id="三、JS"><a href="#三、JS" class="headerlink" title="三、JS"></a>三、JS</h3><h4 id="1、js中五种主要的数据类型"><a href="#1、js中五种主要的数据类型" class="headerlink" title="1、js中五种主要的数据类型"></a>1、js中五种主要的数据类型</h4><p>string、number、Boolean、array、object</p>
<h4 id="2、节点操作"><a href="#2、节点操作" class="headerlink" title="2、节点操作"></a>2、节点操作</h4><ol>
<li>查找节点<ul>
<li>通过标签名称——getElementsByTagName()</li>
<li>通过name——getElementsByName()</li>
<li>通过id——getElementById()</li>
</ul>
</li>
<li>添加、移除、替换、插入节点<ul>
<li>添加——appendChild()</li>
<li>移除——removeChild()</li>
<li>替换——replaceChild()</li>
<li>插入——insertBefore()</li>
</ul>
</li>
</ol>
<h4 id="3、什么是伪数组、怎样转化为数组"><a href="#3、什么是伪数组、怎样转化为数组" class="headerlink" title="3、什么是伪数组、怎样转化为数组"></a>3、什么是伪数组、怎样转化为数组</h4><p>伪数组是类似于数组的集合。例如：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> a=&#123;<span class="number">0</span>:<span class="string">'aa'</span>,<span class="number">1</span>:<span class="string">'bb'</span>,<span class="attr">length</span>:<span class="number">2</span>&#125;</span><br></pre></td></tr></table></figure>

<p>转化为数组：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="built_in">Array</span>.prototype.slice.call(a)</span><br></pre></td></tr></table></figure>

<h4 id="4、判断一个变量是什么类型"><a href="#4、判断一个变量是什么类型" class="headerlink" title="4、判断一个变量是什么类型"></a>4、判断一个变量是什么类型</h4><p><strong>typeof</strong> 只能判断除数组以外的类型</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">typeof</span> <span class="string">"aa"</span> <span class="comment">//"string"</span></span><br><span class="line"><span class="keyword">typeof</span> <span class="number">2</span>   <span class="comment">//"number"</span></span><br><span class="line"><span class="keyword">typeof</span> &#123;&#125;  <span class="comment">//"object"</span></span><br><span class="line"><span class="keyword">typeof</span> []  <span class="comment">//"object"</span></span><br><span class="line"><span class="keyword">typeof</span> <span class="literal">true</span> <span class="comment">//"boolean"</span></span><br></pre></td></tr></table></figure>

<p>判断数组类型 </p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">[] <span class="keyword">instanceof</span> <span class="built_in">Array</span>  <span class="comment">//true</span></span><br></pre></td></tr></table></figure>

<h4 id="5、事件委托"><a href="#5、事件委托" class="headerlink" title="5、事件委托"></a>5、事件委托</h4><p>把子节点的监听函数定义到父节点上，由父节点上的监听函数统一处理多个子元素的事件。</p>
<p>这样不用在每一个子节点上都绑定监听事件，减少内存上的消耗。</p>
<h4 id="6、如何解决异步回调地狱"><a href="#6、如何解决异步回调地狱" class="headerlink" title="6、如何解决异步回调地狱"></a>6、如何解决异步回调地狱</h4><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">promise、<span class="keyword">async</span>/<span class="keyword">await</span></span><br></pre></td></tr></table></figure>

<h4 id="7、window的五大对象"><a href="#7、window的五大对象" class="headerlink" title="7、window的五大对象"></a>7、window的五大对象</h4><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">Navigator、Screen、History、Location、Window</span><br></pre></td></tr></table></figure>

<h4 id="8、闭包"><a href="#8、闭包" class="headerlink" title="8、闭包"></a>8、闭包</h4><ol>
<li><p>如何产生闭包？</p>
<p>当一个嵌套的内部（子）函数引用了嵌套的外部（父）函数的变量/函数时，就产生了闭包。</p>
</li>
<li><p>什么是闭包？</p>
<p>闭包是嵌套的内部函数。</p>
</li>
<li><p>产生闭包的条件？</p>
<ul>
<li>函数嵌套</li>
<li>内部函数引用了外部函数的变量/函数</li>
<li>执行外部函数。</li>
</ul>
</li>
</ol>
<h4 id="9、数据的双向绑定MVVM"><a href="#9、数据的双向绑定MVVM" class="headerlink" title="9、数据的双向绑定MVVM"></a>9、数据的双向绑定MVVM</h4><p>利用 Object.defineProperty(obj, prop, descriptor) 中的<strong>get</strong>和<strong>set</strong>获取和修改属性值。</p>
]]></content>
      <categories>
        <category>常用</category>
        <category>知识点</category>
      </categories>
      <tags>
        <tag>js,html,css,http</tag>
      </tags>
  </entry>
  <entry>
    <title>wx分享</title>
    <url>/2020/06/17/wx%E5%88%86%E4%BA%AB/</url>
    <content><![CDATA[<p><img src="https://s1.ax1x.com/2020/07/17/UyUEO1.jpg" alt=""></p>
<a id="more"></a>

<h3 id="一、wx-分享"><a href="#一、wx-分享" class="headerlink" title="一、wx 分享"></a><strong>一、wx 分享</strong></h3><h4 id="1、jquery-引入标签"><a href="#1、jquery-引入标签" class="headerlink" title="1、jquery 引入标签"></a>1、jquery 引入标签</h4><p>还需要引入   jweixin-1.4.0.js  文件。此文件在 E 盘“引用的文件”js 文件中。</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--微信分享--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"/js/jweixin-1.4.0.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="2、vue-在-main-js-中引入"><a href="#2、vue-在-main-js-中引入" class="headerlink" title="2、vue 在 main.js 中引入"></a>2、vue 在 main.js 中引入</h4><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 引入微信分享</span></span><br><span class="line"><span class="keyword">import</span> wx <span class="keyword">from</span> <span class="string">"weixin-js-sdk"</span>;</span><br><span class="line">Vue.use(wx);</span><br></pre></td></tr></table></figure>

<h4 id="3、在-h5-js-里面进行封装"><a href="#3、在-h5-js-里面进行封装" class="headerlink" title="3、在 h5.js 里面进行封装"></a>3、在 h5.js 里面进行封装</h4><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 引入微信分享</span></span><br><span class="line"><span class="keyword">import</span> wx <span class="keyword">from</span> <span class="string">"weixin-js-sdk"</span>;</span><br><span class="line"><span class="comment">//微信分享</span></span><br><span class="line"><span class="keyword">let</span> wxShareIntval;</span><br><span class="line"><span class="keyword">let</span> wxShareIntvalIndex=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">var</span> iosEdition = navigator.userAgent;</span><br><span class="line"><span class="keyword">let</span> isIphone = !!iosEdition.match(<span class="regexp">/\(i[^;]+;( U;)? CPU.+Mac OS X/</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//禁止微信分享</span></span><br><span class="line">    prohibitShare() &#123;</span><br><span class="line">        <span class="comment">// 禁止分享</span></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">typeof</span> WeixinJSBridge == <span class="string">"undefined"</span>) &#123;</span><br><span class="line">                <span class="keyword">if</span> (<span class="built_in">document</span>.addEventListener) &#123;</span><br><span class="line">                    <span class="built_in">document</span>.addEventListener(<span class="string">'WeixinJSBridgeReady'</span>, <span class="keyword">this</span>.onBridgeReady(), <span class="literal">false</span>);</span><br><span class="line">                &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="built_in">document</span>.attachEvent) &#123;</span><br><span class="line">                    <span class="built_in">document</span>.attachEvent(<span class="string">'WeixinJSBridgeReady'</span>, <span class="keyword">this</span>.onBridgeReady());</span><br><span class="line">                    <span class="built_in">document</span>.attachEvent(<span class="string">'onWeixinJSBridgeReady'</span>, <span class="keyword">this</span>.onBridgeReady());</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">this</span>.onBridgeReady();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(e)</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">//初始化时屏蔽分享按钮防止点击</span></span><br><span class="line">    onBridgeReady() &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            WeixinJSBridge.call(<span class="string">'hideOptionMenu'</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">//定时器，请求完数据之后才可以进行wx分享</span></span><br><span class="line">    shareTimer(shareObj) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(process.env.NODE_ENV);</span><br><span class="line">        <span class="keyword">if</span> (process.env.NODE_ENV === <span class="string">"development"</span> || !Vue.prototype.isWechat) &#123;</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// wxShareIntval = setInterval(() =&gt; &#123;</span></span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="keyword">if</span> (<span class="built_in">document</span>.readyState == <span class="string">"complete"</span>) &#123; <span class="comment">//当页面加载状态为完全结束时进入</span></span><br><span class="line">                    <span class="keyword">if</span> (<span class="keyword">typeof</span> WeixinJSBridge == <span class="string">"undefined"</span>) &#123;</span><br><span class="line">                        <span class="keyword">if</span> (<span class="built_in">document</span>.addEventListener) &#123;</span><br><span class="line">                            <span class="built_in">document</span>.addEventListener(<span class="string">'WeixinJSBridgeReady'</span>, <span class="keyword">this</span>.getWxShare(shareObj), <span class="literal">false</span>);</span><br><span class="line">                        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="built_in">document</span>.attachEvent) &#123;</span><br><span class="line">                            <span class="built_in">document</span>.attachEvent(<span class="string">'WeixinJSBridgeReady'</span>, <span class="keyword">this</span>.getWxShare(shareObj));</span><br><span class="line">                            <span class="built_in">document</span>.attachEvent(<span class="string">'onWeixinJSBridgeReady'</span>, <span class="keyword">this</span>.getWxShare(shareObj));</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        <span class="comment">//微信分享配置</span></span><br><span class="line">                        <span class="keyword">this</span>.getWxShare(shareObj);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// wxShareIntvalIndex++;</span></span><br><span class="line">            <span class="comment">// if (wxShareIntvalIndex &gt; 10) &#123;</span></span><br><span class="line">            <span class="comment">//     clearInterval(wxShareIntval);</span></span><br><span class="line">            <span class="comment">// &#125;</span></span><br><span class="line">        <span class="comment">// &#125;, 500)</span></span><br><span class="line">    &#125;,</span><br><span class="line">    getWxShare(shareObj) &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">let</span> href = location.href.split(<span class="string">'#'</span>)[<span class="number">0</span>];</span><br><span class="line">            <span class="keyword">if</span> (!isIphone) &#123;</span><br><span class="line">                href = location.href.split(<span class="string">'#'</span>)[<span class="number">0</span>].split(<span class="string">'?from'</span>)[<span class="number">0</span>];</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">let</span> obj = &#123;</span><br><span class="line">                url: href</span><br><span class="line">            &#125;</span><br><span class="line">            Vue.prototype.$http.get(<span class="string">'/api/user/wx/share'</span>, obj,<span class="string">'hideLoad'</span>).then(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">                <span class="keyword">let</span> data = res.data;</span><br><span class="line">                setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">                    <span class="keyword">this</span>.wxShare(data, shareObj);</span><br><span class="line">                &#125;, <span class="number">500</span>)</span><br><span class="line">            &#125;).catch(<span class="function"><span class="params">err</span> =&gt;</span> &#123;</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    wxShare(data, shareObj) &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            wx.config(&#123;</span><br><span class="line">                debug: <span class="literal">false</span>,</span><br><span class="line">                appId: data.data.appId, <span class="comment">// 和获取Ticke的必须一样------必填，公众号的唯一标识</span></span><br><span class="line">                timestamp: data.data.timestamp, <span class="comment">// 必填，生成签名的时间戳</span></span><br><span class="line">                nonceStr: data.data.nonceStr, <span class="comment">// 必填，生成签名的随机串</span></span><br><span class="line">                signature: data.data.signature, <span class="comment">// 必填，签名，见附录1</span></span><br><span class="line">                <span class="comment">//需要分享的列表项:发送给朋友，分享到朋友圈</span></span><br><span class="line">                jsApiList: [<span class="string">"updateTimelineShareData"</span>, <span class="string">"updateAppMessageShareData"</span>, <span class="string">"onMenuShareTimeline"</span>, <span class="string">"onMenuShareAppMessage"</span>, <span class="string">'checkJsApi'</span>, <span class="string">'openLocation'</span>, <span class="string">'getLocation'</span>]</span><br><span class="line">            &#125;);</span><br><span class="line">            <span class="comment">//处理验证失败的信息</span></span><br><span class="line">            wx.error(<span class="function"><span class="keyword">function</span> (<span class="params">res</span>) </span>&#123;</span><br><span class="line">                <span class="comment">// alert(JSON.stringify(res));</span></span><br><span class="line">            &#125;);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// // //微信分享配置</span></span><br><span class="line">            <span class="comment">// if (isIphone) &#123;</span></span><br><span class="line">            <span class="comment">//     shareObj.share_url = encodeURI(shareObj.share_url)</span></span><br><span class="line">            <span class="comment">// &#125;</span></span><br><span class="line">            <span class="comment">//微信分享配置</span></span><br><span class="line">            history.replaceState(&#123;&#125;, shareObj.share_title, shareObj.share_url);</span><br><span class="line">            shareObj.share_url = <span class="built_in">window</span>.location.href;</span><br><span class="line">            wx.ready(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">                WeixinJSBridge.call(<span class="string">'showOptionMenu'</span>);</span><br><span class="line">                clearInterval(wxShareIntval);</span><br><span class="line">                <span class="keyword">if</span> (isIphone) &#123;</span><br><span class="line">                    <span class="comment">//分享到朋友圈</span></span><br><span class="line">                    wx.updateTimelineShareData(&#123;</span><br><span class="line">                        title: shareObj.share_title, <span class="comment">// 分享标题</span></span><br><span class="line">                        desc: shareObj.share_des, <span class="comment">// 分享描述</span></span><br><span class="line">                        link: shareObj.share_url, <span class="comment">// 分享链接，该链接域名或路径必须与当前页面对应的公众号JS安全域名一致</span></span><br><span class="line">                        imgUrl: shareObj.share_img, <span class="comment">// 分享图标</span></span><br><span class="line">                        success: <span class="function"><span class="keyword">function</span> (<span class="params">res</span>) </span>&#123;</span><br><span class="line">                            <span class="comment">// 用户确认分享后执行的回调函数</span></span><br><span class="line"><span class="comment">//                            showTips("成功分享朋友圈")</span></span><br><span class="line">                        &#125;,</span><br><span class="line">                        cancel: <span class="function"><span class="keyword">function</span> (<span class="params">res</span>) </span>&#123;</span><br><span class="line">                            <span class="comment">// 用户取消分享后执行的回调函数</span></span><br><span class="line">                            <span class="comment">// showTips("取消分享到朋友圈返回:" + res);</span></span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;);</span><br><span class="line">                    <span class="comment">//分享给朋友</span></span><br><span class="line">                    wx.updateAppMessageShareData(&#123;</span><br><span class="line">                        title: shareObj.share_title, <span class="comment">// 分享标题</span></span><br><span class="line">                        desc: shareObj.share_des, <span class="comment">// 分享描述</span></span><br><span class="line">                        link: shareObj.share_url, <span class="comment">// 分享链接，该链接域名或路径必须与当前页面对应的公众号JS安全域名一致</span></span><br><span class="line">                        imgUrl: shareObj.share_img, <span class="comment">// 分享图标</span></span><br><span class="line">                        type: <span class="string">""</span>, <span class="comment">// 分享类型,music、video或link，不填默认为link</span></span><br><span class="line">                        dataUrl: <span class="string">""</span>, <span class="comment">// 如果type是music或video，则要提供数据链接，默认为空</span></span><br><span class="line">                        success: <span class="function"><span class="keyword">function</span> (<span class="params">res</span>) </span>&#123;</span><br><span class="line">                            <span class="comment">// 用户确认分享后执行的回调函数</span></span><br><span class="line"><span class="comment">//                            showTips("成功分享给朋友")</span></span><br><span class="line">                        &#125;,</span><br><span class="line">                        cancel: <span class="function"><span class="keyword">function</span> (<span class="params">res</span>) </span>&#123;</span><br><span class="line">                            <span class="comment">// 用户取消分享后执行的回调函数</span></span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;);</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="comment">//分享到朋友圈</span></span><br><span class="line">                    wx.onMenuShareTimeline(&#123;</span><br><span class="line">                        title: shareObj.share_title, <span class="comment">// 分享标题</span></span><br><span class="line">                        desc: shareObj.share_des, <span class="comment">// 分享描述</span></span><br><span class="line">                        link: shareObj.share_url, <span class="comment">// 分享链接，该链接域名或路径必须与当前页面对应的公众号JS安全域名一致</span></span><br><span class="line">                        imgUrl: shareObj.share_img, <span class="comment">// 分享图标</span></span><br><span class="line">                        success: <span class="function"><span class="keyword">function</span> (<span class="params">res</span>) </span>&#123;</span><br><span class="line">                            <span class="comment">// 用户确认分享后执行的回调函数</span></span><br><span class="line"></span><br><span class="line">                        &#125;,</span><br><span class="line">                        cancel: <span class="function"><span class="keyword">function</span> (<span class="params">res</span>) </span>&#123;</span><br><span class="line">                            <span class="comment">// 用户取消分享后执行的回调函数</span></span><br><span class="line">                            <span class="comment">// showTips("取消分享到朋友圈返回:" + res);</span></span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;);</span><br><span class="line">                    <span class="comment">//分享给朋友</span></span><br><span class="line">                    wx.onMenuShareAppMessage(&#123;</span><br><span class="line">                        title: shareObj.share_title, <span class="comment">// 分享标题</span></span><br><span class="line">                        desc: shareObj.share_des, <span class="comment">// 分享描述</span></span><br><span class="line">                        link: shareObj.share_url, <span class="comment">// 分享链接，该链接域名或路径必须与当前页面对应的公众号JS安全域名一致</span></span><br><span class="line">                        imgUrl: shareObj.share_img, <span class="comment">// 分享图标</span></span><br><span class="line">                        type: <span class="string">""</span>, <span class="comment">// 分享类型,music、video或link，不填默认为link</span></span><br><span class="line">                        dataUrl: <span class="string">""</span>, <span class="comment">// 如果type是music或video，则要提供数据链接，默认为空</span></span><br><span class="line">                        success: <span class="function"><span class="keyword">function</span> (<span class="params">res</span>) </span>&#123;</span><br><span class="line">                            <span class="comment">// 用户确认分享后执行的回调函数</span></span><br><span class="line">                        &#125;,</span><br><span class="line">                        cancel: <span class="function"><span class="keyword">function</span> (<span class="params">res</span>) </span>&#123;</span><br><span class="line">                            <span class="comment">// 用户取消分享后执行的回调函数</span></span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;,</span><br></pre></td></tr></table></figure>

<h4 id="4、引用"><a href="#4、引用" class="headerlink" title="4、引用"></a>4、引用</h4><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">mounted() &#123;</span><br><span class="line">    <span class="comment">//禁止分享</span></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        prohibitShare();</span><br><span class="line">        <span class="keyword">this</span>.shareWx();</span><br><span class="line">    &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">        alert(e);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;,</span><br><span class="line">methods: &#123;</span><br><span class="line">    shareWx() &#123;</span><br><span class="line">        <span class="keyword">let</span> shareObj = &#123;</span><br><span class="line">            share_title: <span class="string">"分享标题"</span>,</span><br><span class="line">            share_des: <span class="string">"分享描述"</span>,</span><br><span class="line">            share_img: <span class="string">'分享图片'</span>,</span><br><span class="line">            share_url: <span class="string">`url`</span></span><br><span class="line">        &#125;</span><br><span class="line">        shareTimer(shareObj)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>wx</category>
        <category>wx分享</category>
      </categories>
      <tags>
        <tag>js</tag>
      </tags>
  </entry>
  <entry>
    <title>wx授权</title>
    <url>/2020/09/05/wx%E6%8E%88%E6%9D%83/</url>
    <content><![CDATA[<p>微信授权。</p>
<a id="more"></a>

<p>在main.js中</p>
<h4 id="1、app"><a href="#1、app" class="headerlink" title="1、app"></a>1、app</h4><blockquote>
<p>建立一个 <strong>hybridApp.js</strong> 文件，在内部写入与app交互的方法（均为与app商量好用来互相调用的方法）。</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> Vue <span class="keyword">from</span> <span class="string">"vue"</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;Dialog, Toast&#125; <span class="keyword">from</span> <span class="string">'vant'</span>;<span class="comment">//引入elm组件</span></span><br><span class="line">Vue.use(Toast);</span><br><span class="line">Vue.use(Dialog);</span><br><span class="line"><span class="keyword">let</span> iosEdition = navigator.userAgent;</span><br><span class="line"><span class="keyword">let</span> isIos = !!iosEdition.match(<span class="regexp">/\(i[^;]+;( U;)? CPU.+Mac OS X/</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">    <span class="comment">//从APP中获取token</span></span><br><span class="line">    appGetToken() &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">let</span> obj = &#123;</span><br><span class="line">                data: <span class="string">""</span>,</span><br><span class="line">                callBackFunction: <span class="string">"getToken"</span></span><br><span class="line">            &#125;;</span><br><span class="line">            <span class="keyword">if</span> (isIos) &#123;</span><br><span class="line">                <span class="built_in">window</span>.webkit.messageHandlers.getToken.postMessage(<span class="built_in">JSON</span>.stringify(obj));</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="built_in">window</span>.appWebView.getToken(<span class="built_in">JSON</span>.stringify(obj));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(e)</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">//App分享数据</span></span><br><span class="line">    appShare(shareData) &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">let</span> obj = &#123;</span><br><span class="line">                data: shareData,</span><br><span class="line">                callBackFunction: <span class="string">""</span></span><br><span class="line">            &#125;;</span><br><span class="line">            <span class="comment">// Dialog.alert(&#123;</span></span><br><span class="line">            <span class="comment">//     title: 'App分享数据',</span></span><br><span class="line">            <span class="comment">//     message: JSON.stringify(obj)</span></span><br><span class="line">            <span class="comment">// &#125;).then(() =&gt; &#123;</span></span><br><span class="line">            <span class="keyword">if</span> (isIos) &#123;</span><br><span class="line">                <span class="built_in">window</span>.webkit.messageHandlers.shearMessage.postMessage(<span class="built_in">JSON</span>.stringify(obj));</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="built_in">window</span>.appWebView.shearMessage(<span class="built_in">JSON</span>.stringify(obj));</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// &#125;);</span></span><br><span class="line"></span><br><span class="line">        &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">            alert(e)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">//退出登录</span></span><br><span class="line">    appLogOut() &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">let</span> obj = &#123;</span><br><span class="line">                data: <span class="string">''</span>,</span><br><span class="line">                callBackFunction: <span class="string">""</span></span><br><span class="line">            &#125;;</span><br><span class="line">            <span class="keyword">if</span> (isIos) &#123;</span><br><span class="line">                <span class="built_in">window</span>.webkit.messageHandlers.logoutApp.postMessage(<span class="built_in">JSON</span>.stringify(obj));</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="built_in">window</span>.appWebView.logoutApp(<span class="built_in">JSON</span>.stringify(obj));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">            alert(e)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">//APP唤起支付宝支付操作</span></span><br><span class="line">    appPay(data) &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">//添加加载动画</span></span><br><span class="line">            <span class="built_in">document</span>.getElementById(<span class="string">'loadingShow'</span>).style.cssText = <span class="string">"display:block"</span></span><br><span class="line">            <span class="keyword">let</span> obj = &#123;</span><br><span class="line">                data: data,</span><br><span class="line">                callBackFunction: <span class="string">'payMessage'</span></span><br><span class="line">            &#125;;</span><br><span class="line">            <span class="keyword">if</span> (isIos) &#123;</span><br><span class="line">                <span class="built_in">window</span>.webkit.messageHandlers.appPayOrder.postMessage(<span class="built_in">JSON</span>.stringify(obj));</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="built_in">window</span>.appWebView.appPayOrder(<span class="built_in">JSON</span>.stringify(obj));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">            alert(e)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">//APP唤起微信支付操作</span></span><br><span class="line">    appWxPay(data) &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">//添加加载动画</span></span><br><span class="line">            <span class="comment">// document.getElementById('loadingShow').style.cssText = "display:block"</span></span><br><span class="line">            <span class="keyword">let</span> obj = &#123;</span><br><span class="line">                data: data,</span><br><span class="line">                callBackFunction: <span class="string">'payMessage'</span></span><br><span class="line">            &#125;;</span><br><span class="line">            <span class="comment">// Dialog.alert(&#123;</span></span><br><span class="line">            <span class="comment">//     title: 'App支付',</span></span><br><span class="line">            <span class="comment">//     message: JSON.stringify(obj)</span></span><br><span class="line">            <span class="comment">// &#125;).then(() =&gt; &#123;</span></span><br><span class="line">                <span class="keyword">if</span> (isIos) &#123;</span><br><span class="line">                    <span class="built_in">window</span>.webkit.messageHandlers.appWxPayOrder.postMessage(<span class="built_in">JSON</span>.stringify(obj));</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="built_in">window</span>.appWebView.appWxPayOrder(<span class="built_in">JSON</span>.stringify(obj));</span><br><span class="line">                &#125;</span><br><span class="line">            <span class="comment">// &#125;);</span></span><br><span class="line">        &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">            alert(e)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">//APP设置返回</span></span><br><span class="line">    appHistoryGo(data, callBack) &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">let</span> obj = &#123;</span><br><span class="line">                data: data,</span><br><span class="line">                callBackFunction: <span class="string">''</span></span><br><span class="line">            &#125;;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (isIos) &#123;</span><br><span class="line">                <span class="built_in">window</span>.webkit.messageHandlers.appHistoryBack.postMessage(<span class="built_in">JSON</span>.stringify(obj));</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="built_in">window</span>.appWebView.appHistoryBack(<span class="built_in">JSON</span>.stringify(obj));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">            alert(e)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">//APP分享图片</span></span><br><span class="line">    appShareImg(data, callBack) &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">let</span> obj = &#123;</span><br><span class="line">                data: data,</span><br><span class="line">                callBackFunction: <span class="string">''</span></span><br><span class="line">            &#125;;</span><br><span class="line">            <span class="comment">// Dialog.alert(&#123;</span></span><br><span class="line">            <span class="comment">//     title: 'APP分享图片',</span></span><br><span class="line">            <span class="comment">//     message: JSON.stringify(obj)</span></span><br><span class="line">            <span class="comment">// &#125;).then(() =&gt; &#123;</span></span><br><span class="line">            <span class="keyword">if</span> (isIos) &#123;</span><br><span class="line">                <span class="built_in">window</span>.webkit.messageHandlers.shearImgMessage.postMessage(<span class="built_in">JSON</span>.stringify(obj));</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="built_in">window</span>.appWebView.shearImgMessage(<span class="built_in">JSON</span>.stringify(obj));</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// &#125;);</span></span><br><span class="line">        &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">            alert(e)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//APP操作历史返回</span></span><br><span class="line"><span class="built_in">window</span>.appBack = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">// if(window.location.href.indexOf('/#/home'))&#123;</span></span><br><span class="line">    <span class="comment">//</span></span><br><span class="line">    <span class="comment">// &#125;</span></span><br><span class="line">    history.go(<span class="number">-1</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>引入</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> hybridApp <span class="keyword">from</span> <span class="string">"./static/js/hybridApp"</span>;</span><br><span class="line">Vue.prototype.$hybridApp = hybridApp;</span><br></pre></td></tr></table></figure>

<p>app相关方法</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// app相关</span></span><br><span class="line"><span class="keyword">let</span> checkInterval;</span><br><span class="line"><span class="keyword">let</span> hasToken = <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">if</span> (!Vue.prototype.isWechat) &#123;</span><br><span class="line">    hybridApp.appGetToken();</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">"微信环境："</span>+Vue.prototype.isWechat)</span><br><span class="line"><span class="built_in">window</span>.getToken = getToken;<span class="comment">//将app需要调用的方法挂载到全局变量上面</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getToken</span>(<span class="params">obj</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> user = &#123;</span><br><span class="line">        <span class="string">"message"</span>: <span class="string">"操作成功"</span>,</span><br><span class="line">        <span class="string">"data"</span>: &#123;</span><br><span class="line">            <span class="string">"token"</span>: obj</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="string">"count"</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="string">"status"</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="string">"code"</span>: <span class="number">0</span></span><br><span class="line">    &#125;</span><br><span class="line">    hasToken = <span class="literal">true</span>;<span class="comment">//是否已经获取到token</span></span><br><span class="line">    localStorage.setItem(<span class="string">'Authorization'</span>,obj)</span><br><span class="line">    <span class="comment">//设置半天过期</span></span><br><span class="line">    style.setStorage(<span class="string">'userInfo'</span>, user, <span class="number">86400</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="2、先定义一个微信授权方法"><a href="#2、先定义一个微信授权方法" class="headerlink" title="2、先定义一个微信授权方法"></a>2、先定义一个微信授权方法</h4><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//微信授权</span></span><br><span class="line">Vue.prototype.getWxInfo = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">// 这个redirectUrl用 当前页路径已存在用户信息直接进入页面或者tof.fullPath(将要进入的路径)</span></span><br><span class="line">    <span class="keyword">let</span> redirectUrl = <span class="built_in">window</span>.location.href;</span><br><span class="line">    <span class="comment">//如果有code、授权成功</span></span><br><span class="line">    <span class="keyword">if</span> (redirectUrl.indexOf(<span class="string">'code'</span>)) &#123;</span><br><span class="line">        redirectUrl = redirectUrl.split(<span class="string">'.com/'</span>)[<span class="number">0</span>] + <span class="string">'.com/#/'</span> + redirectUrl.split(<span class="string">'#/'</span>)[<span class="number">1</span>]</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//如果没有授权</span></span><br><span class="line">    redirectUrl = <span class="built_in">encodeURIComponent</span>(redirectUrl);</span><br><span class="line">    <span class="keyword">const</span> appid = Vue.prototype.wxAppid;</span><br><span class="line">    <span class="built_in">window</span>.location.href = <span class="string">`http://wx.jishiyoo.com/wx/code?appid=<span class="subst">$&#123;appid&#125;</span>&amp;redirect_uri=<span class="subst">$&#123;redirectUrl&#125;</span>&amp;response_type=code&amp;scope=snsapi_userinfo&amp;state=course&amp;connect_redirect=1#wechat_redirect`</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="3、判断是否生产环境进行授权"><a href="#3、判断是否生产环境进行授权" class="headerlink" title="3、判断是否生产环境进行授权"></a>3、判断是否生产环境进行授权</h4><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//判断是否生产环境</span></span><br><span class="line"><span class="keyword">if</span> (process.env.NODE_ENV === <span class="string">"production"</span> || <span class="built_in">window</span>.location.href.indexOf(<span class="string">'8080'</span>) &gt; <span class="number">-1</span>) &#123;</span><br><span class="line">    <span class="comment">//是生产环境</span></span><br><span class="line">    <span class="comment">//路由跳转拦截配置</span></span><br><span class="line">    router.beforeEach(<span class="keyword">async</span> (to, <span class="keyword">from</span>, next) =&gt; &#123;</span><br><span class="line">        <span class="comment">//如果未匹配到路由</span></span><br><span class="line">        <span class="keyword">if</span> (to.matched.length === <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="comment">//如果上级也未匹配到路由则跳转主页面，如果上级能匹配到则转上级路由</span></span><br><span class="line">            <span class="keyword">from</span>.path ? next(&#123;<span class="attr">path</span>: <span class="keyword">from</span>.path&#125;) : next(<span class="string">'/#/home'</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 设置此路由是否需要登录即给router的meta加一个noAuth:true的属性，不需要登录的页面,则直接next()</span></span><br><span class="line">        <span class="comment">//some方法。意思是，to.matched 的数组，如果在mate中有noAuth 那么就返回true</span></span><br><span class="line">        <span class="keyword">if</span> (to.matched.some(<span class="function"><span class="params">recode</span> =&gt;</span> recode.meta.noAuth)) &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">`无需授权`</span>);</span><br><span class="line">            next()</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">//开发环境不需要授权</span></span><br><span class="line">            <span class="keyword">if</span> (!process.env.NODE_ENV === <span class="string">"production"</span>) &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    next();</span><br><span class="line">                    <span class="keyword">return</span></span><br><span class="line">                &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line"></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//生产环境授权</span></span><br><span class="line">            <span class="keyword">if</span> (process.env.NODE_ENV === <span class="string">"production"</span>) &#123;</span><br><span class="line">                <span class="comment">//如果用户信息本地缓存不存在，则需要请求接口获取用户信息</span></span><br><span class="line">                <span class="keyword">if</span> (Vue.prototype.isWechat || <span class="built_in">window</span>.location.href.indexOf(<span class="string">'8080'</span>) &gt; <span class="number">-1</span>) &#123;</span><br><span class="line">                   	  <span class="comment">/*微信环境*/</span></span><br><span class="line">                    <span class="keyword">let</span> code = style.GetQueryString(<span class="string">'code'</span>); <span class="comment">// 截取url上的code ,可能没有,则返回''空字符串</span></span><br><span class="line">                    <span class="comment">// alert('code'+code)</span></span><br><span class="line">                    <span class="comment">//缓存中有用户信息</span></span><br><span class="line">                    <span class="keyword">if</span> (style.getStorage(<span class="string">'userInfo'</span>)) &#123;</span><br><span class="line">                        <span class="comment">//如果用户缓存存在</span></span><br><span class="line">                        next();</span><br><span class="line">                        <span class="keyword">return</span></span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="comment">//缓存中没有用户信息</span></span><br><span class="line">                    <span class="keyword">if</span> (code) &#123;</span><br><span class="line">                        <span class="comment">//存在code</span></span><br><span class="line">                        <span class="built_in">console</span>.log(<span class="string">`code:`</span> + code);</span><br><span class="line">                        <span class="keyword">try</span> &#123;</span><br><span class="line">                            axios.get(<span class="string">'/api/user/code/auth'</span>, &#123;<span class="attr">code</span>: code&#125;).then(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">                                <span class="comment">// 获取用户信息,后端可首先通过cookie,session等判断,没有信息则通过code获取</span></span><br><span class="line">                                <span class="comment">// 返回用户信息</span></span><br><span class="line">                                <span class="built_in">console</span>.log(res.data);</span><br><span class="line">                                <span class="keyword">if</span> (res.data.data) &#123;</span><br><span class="line">                                    <span class="comment">//用户信息存在，将信息存储至vuex中</span></span><br><span class="line">                                    <span class="built_in">console</span>.log(<span class="string">`获取到用户信息，将信息存储至vuex中`</span>);</span><br><span class="line">                                    <span class="comment">// store.commit('setUserInfo', res.data);</span></span><br><span class="line">                                    <span class="comment">//设置半天过期</span></span><br><span class="line">                                    style.setStorage(<span class="string">'userInfo'</span>, res.data.data, <span class="number">86400</span>);</span><br><span class="line">                                    next()</span><br><span class="line">                                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                                    <span class="comment">//有code但是不存在用户信息</span></span><br><span class="line">                                    <span class="built_in">console</span>.log(<span class="string">`不存在用户信息`</span>);</span><br><span class="line">                                    <span class="comment">// 上面的获取用户信息接口,如果cookie,session拿不到用户信息,且传递的code为空,则跳转到微信授权页面</span></span><br><span class="line">                                    <span class="comment">// alert(`/api/user/code/auth 无用户信息--开始跳转微信授权`);</span></span><br><span class="line">                                    Vue.prototype.getWxInfo();</span><br><span class="line">                                &#125;</span><br><span class="line">                            &#125;).catch(<span class="function"><span class="params">e</span> =&gt;</span> &#123;</span><br><span class="line">                                <span class="built_in">console</span>.log(<span class="string">`e:`</span> + e);</span><br><span class="line">                            &#125;)</span><br><span class="line">                        &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">                            Vue.prototype.getWxInfo();</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        <span class="comment">//微信环境，没有code</span></span><br><span class="line">                        <span class="comment">// 上面的获取用户信息接口,如果cookie,session拿不到用户信息,且传递的code为空,则跳转到微信授权页面</span></span><br><span class="line">                        Vue.prototype.getWxInfo();</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="comment">/*app环境*/</span></span><br><span class="line">                    <span class="comment">// 获取用户token</span></span><br><span class="line">                    <span class="keyword">if</span> (to.matched.some(<span class="function"><span class="params">recode</span> =&gt;</span> recode.meta.noAuth)) &#123;</span><br><span class="line">                        <span class="built_in">console</span>.log(<span class="string">`无需授权`</span>);</span><br><span class="line">                        next();</span><br><span class="line">                        <span class="keyword">return</span></span><br><span class="line">                    &#125;</span><br><span class="line">                    hybridApp.appGetToken();</span><br><span class="line">                    checkInterval = setInterval(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">                        <span class="keyword">if</span> (hasToken) &#123;</span><br><span class="line">                            clearInterval(<span class="string">'checkInterval'</span>);</span><br><span class="line">                            next();</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;, <span class="number">100</span>)</span><br><span class="line">                    next();</span><br><span class="line">                    <span class="keyword">return</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="comment">//开发环境</span></span><br><span class="line">                next()</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// try&#123;</span></span><br><span class="line">    <span class="comment">//     router.afterEach((to, from) =&gt; &#123;</span></span><br><span class="line">    <span class="comment">//         ga('set', 'page', to.path);</span></span><br><span class="line">    <span class="comment">//     &#125;)</span></span><br><span class="line">    <span class="comment">// &#125;catch (e) &#123;</span></span><br><span class="line">    <span class="comment">//</span></span><br><span class="line">    <span class="comment">// &#125;</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>wx</category>
        <category>wx授权</category>
      </categories>
      <tags>
        <tag>js</tag>
      </tags>
  </entry>
  <entry>
    <title>vue-cropper图片裁剪</title>
    <url>/2020/07/14/vue-cropper%E5%9B%BE%E7%89%87%E8%A3%81%E5%89%AA/</url>
    <content><![CDATA[<img src="https://cdn.jsdelivr.net/gh/liebexiao/myImgs/20200717161909.png" alt="" style="zoom:30%;" />

<a id="more"></a>

<h3 id="一、使用"><a href="#一、使用" class="headerlink" title="一、使用"></a><strong>一、使用</strong></h3><h4 id="1、安装引用"><a href="#1、安装引用" class="headerlink" title="1、安装引用"></a>1、安装引用</h4><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">cnpm install cropperjs</span><br><span class="line"><span class="comment">// 引入</span></span><br><span class="line"><span class="keyword">import</span> Cropper <span class="keyword">from</span> <span class="string">'cropperjs'</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">'cropperjs/dist/cropper.min.css'</span></span><br></pre></td></tr></table></figure>

<h4 id="2、上传图片并剪裁"><a href="#2、上传图片并剪裁" class="headerlink" title="2、上传图片并剪裁"></a>2、上传图片并剪裁</h4><p>上传图片到 oss 然后进行裁剪将 x，y，width，height 拼接到图片链接上即完成裁剪。</p>
<p>在弹框中实现图片裁剪及预览。</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"content_div"</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--上传图片--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">el-upload</span></span></span><br><span class="line"><span class="tag">    <span class="attr">class</span>=<span class="string">"avatar-uploader tailor_class"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">v-loading</span>=<span class="string">"loading"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">action</span>=<span class="string">"/api/base/file/upload"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">:show-file-list</span>=<span class="string">"false"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">:on-progress</span>=<span class="string">"progressFile"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">:on-success</span>=<span class="string">"saveFileList"</span></span></span><br><span class="line"><span class="tag">  &gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">img</span> <span class="attr">v-if</span>=<span class="string">"item_images"</span> <span class="attr">:src</span>=<span class="string">"item_images"</span> <span class="attr">class</span>=<span class="string">"avatar"</span> /&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--                                &lt;img v-if="item_images" class="avatar"&gt;--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">i</span> <span class="attr">v-else</span> <span class="attr">class</span>=<span class="string">"el-icon-plus avatar-uploader-icon"</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">el-upload</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">&lt;!--弹框--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">el-dialog</span></span></span><br><span class="line"><span class="tag">    <span class="attr">:title</span>=<span class="string">"dialogTitle"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">:visible.sync</span>=<span class="string">"dialogVisible"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">width</span>=<span class="string">"600px"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">:before-close</span>=<span class="string">"cancelCropper"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">class</span>=<span class="string">"dialog_box"</span></span></span><br><span class="line"><span class="tag">  &gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"rc-cropper clearfix"</span> <span class="attr">v-if</span>=<span class="string">"item_images"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">img</span></span></span><br><span class="line"><span class="tag">        <span class="attr">v-if</span>=<span class="string">"item_images"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">id</span>=<span class="string">"img_id"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">ref</span>=<span class="string">"canvasRef"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">:src</span>=<span class="string">"item_images"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">class</span>=<span class="string">"avatar"</span></span></span><br><span class="line"><span class="tag">      /&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"preview_box"</span> <span class="attr">v-show</span>=<span class="string">"finalImg!=''"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"preview_word"</span>&gt;</span>预览图片<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"preview_img_box"</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">img</span> <span class="attr">class</span>=<span class="string">"preview_img"</span> <span class="attr">:src</span>=<span class="string">"finalImg"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--限制比例--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">"margin-top: 20px"</span> <span class="attr">v-show</span>=<span class="string">"item_images"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-radio</span> <span class="attr">v-model</span>=<span class="string">"cropProportionSelect"</span> <span class="attr">label</span>=<span class="string">"0"</span> <span class="attr">border</span> <span class="attr">size</span>=<span class="string">"medium"</span></span></span><br><span class="line"><span class="tag">        &gt;</span>不限制比例</span><br><span class="line">      <span class="tag">&lt;/<span class="name">el-radio</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-radio</span> <span class="attr">v-model</span>=<span class="string">"cropProportionSelect"</span> <span class="attr">label</span>=<span class="string">"1"</span> <span class="attr">border</span> <span class="attr">size</span>=<span class="string">"medium"</span></span></span><br><span class="line"><span class="tag">        &gt;</span>2.35 ：1</span><br><span class="line">      <span class="tag">&lt;/<span class="name">el-radio</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-radio</span> <span class="attr">v-model</span>=<span class="string">"cropProportionSelect"</span> <span class="attr">label</span>=<span class="string">"2"</span> <span class="attr">border</span> <span class="attr">size</span>=<span class="string">"medium"</span></span></span><br><span class="line"><span class="tag">        &gt;</span>1 ：1</span><br><span class="line">      <span class="tag">&lt;/<span class="name">el-radio</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">slot</span>=<span class="string">"footer"</span> <span class="attr">class</span>=<span class="string">"dialog-footer clearfix"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">type</span>=<span class="string">"primary"</span> @<span class="attr">click</span>=<span class="string">"sureCropper"</span>&gt;</span>确 定<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-button</span></span></span><br><span class="line"><span class="tag">        <span class="attr">style</span>=<span class="string">"float: right !important;margin-right: 10px"</span></span></span><br><span class="line"><span class="tag">        @<span class="attr">click</span>=<span class="string">"cancelCropper"</span></span></span><br><span class="line"><span class="tag">        &gt;</span>取 消</span><br><span class="line">      <span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">el-dialog</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="3、js"><a href="#3、js" class="headerlink" title="3、js"></a>3、js</h4><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">loading:<span class="literal">false</span>,</span><br><span class="line">item_images: <span class="string">''</span>,<span class="comment">//原图</span></span><br><span class="line">finalImg: <span class="string">''</span>,<span class="comment">//剪切图</span></span><br><span class="line">cropper: <span class="literal">null</span>,</span><br><span class="line">croppShow: <span class="literal">false</span>,<span class="comment">//剪裁是否显示</span></span><br><span class="line">dialogTitle: <span class="string">'剪裁图片'</span>,<span class="comment">//弹框标题</span></span><br><span class="line">dialogVisible: <span class="literal">false</span>,<span class="comment">//弹框显示状态</span></span><br><span class="line">cropProportionSelect: <span class="string">'0'</span>,<span class="comment">//裁剪框比例选择</span></span><br><span class="line">cropProportion: <span class="string">''</span>,<span class="comment">//剪裁框比例</span></span><br><span class="line">x: <span class="number">0</span>,</span><br><span class="line">y: <span class="number">0</span>,</span><br><span class="line">width: <span class="number">0</span>,</span><br><span class="line">height: <span class="number">0</span>,</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">watch: &#123;</span><br><span class="line">cropProportionSelect(nv, ov) &#123;</span><br><span class="line"><span class="keyword">this</span>.cropper.destroy();</span><br><span class="line"><span class="keyword">if</span> (nv == <span class="number">0</span> + <span class="string">''</span>) &#123;</span><br><span class="line"><span class="keyword">this</span>.cropProportion = <span class="literal">NaN</span>;</span><br><span class="line"><span class="keyword">this</span>.showCropper();</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (nv == <span class="number">1</span> + <span class="string">''</span>) &#123;</span><br><span class="line"><span class="keyword">this</span>.cropProportion =<span class="number">2.35</span>;</span><br><span class="line"><span class="keyword">this</span>.showCropper();</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (nv == <span class="number">2</span> + <span class="string">''</span>) &#123;</span><br><span class="line"><span class="keyword">this</span>.cropProportion = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">this</span>.showCropper();</span><br><span class="line">&#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//上传文件中</span></span><br><span class="line">            progressFile() &#123;</span><br><span class="line">                <span class="keyword">this</span>.item_images = <span class="string">''</span>;</span><br><span class="line">                <span class="keyword">this</span>.finalImg = <span class="string">''</span>;</span><br><span class="line">                <span class="keyword">this</span>.loading = <span class="literal">true</span>;</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="comment">//图片上传</span></span><br><span class="line">            saveFileList(response, file, fileList) &#123;</span><br><span class="line">                <span class="built_in">console</span>.log(file)</span><br><span class="line">                <span class="keyword">this</span>.item_images = file.response.data;</span><br><span class="line">                <span class="keyword">this</span>.loading = <span class="literal">false</span>;</span><br><span class="line">                <span class="built_in">console</span>.log(<span class="string">"item_images:"</span> + <span class="built_in">JSON</span>.stringify(<span class="keyword">this</span>.item_images));</span><br><span class="line">                <span class="keyword">if</span> (<span class="keyword">this</span>.item_images != <span class="string">''</span>) &#123;</span><br><span class="line">                    <span class="keyword">this</span>.dialogVisible = <span class="literal">true</span>;</span><br><span class="line">                    <span class="keyword">this</span>.showCropper();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="comment">//剪裁框渲染</span></span><br><span class="line">            showCropper() &#123;</span><br><span class="line">                <span class="keyword">let</span> that = <span class="keyword">this</span>;</span><br><span class="line">                <span class="keyword">this</span>.croppShow = <span class="literal">true</span></span><br><span class="line">                setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">                    <span class="keyword">let</span> canvas = <span class="built_in">document</span>.getElementById(<span class="string">"img_id"</span>)</span><br><span class="line">                    <span class="keyword">let</span> cropper = <span class="keyword">new</span> Cropper(canvas, &#123;</span><br><span class="line">                        <span class="comment">// initialAspectRatio: 1 / 1,//裁剪框宽高比的初始值 默认与图片宽高比相同 只有在aspectRatio没有设置的情况下可用</span></span><br><span class="line">                        aspectRatio: that.cropProportion,<span class="comment">//设置裁剪框为固定的宽高比</span></span><br><span class="line">                        minContainerHeight: <span class="number">200</span>,<span class="comment">//容器最小高度</span></span><br><span class="line">                        autoCropArea: <span class="number">0.6</span>,<span class="comment">//定义自动裁剪区域大小（百分比）</span></span><br><span class="line">                        <span class="comment">// zoomable:false,//不缩放图片</span></span><br><span class="line">                        <span class="comment">// zoomOnWheel:false,//滚动鼠标缩放</span></span><br><span class="line">                        background: <span class="literal">false</span>,<span class="comment">//背景网格</span></span><br><span class="line">                        guides: <span class="literal">false</span>,<span class="comment">//裁剪框虚线</span></span><br><span class="line">                        viewMode: <span class="number">1</span>,<span class="comment">//裁剪框不超出图片</span></span><br><span class="line">                        dragMode: <span class="string">'none'</span>,</span><br><span class="line">                        crop(event) &#123;</span><br><span class="line">                            <span class="comment">// console.log(event.detail.x);</span></span><br><span class="line">                            <span class="comment">// console.log(event.detail.y);</span></span><br><span class="line">                            <span class="comment">// console.log(event.detail.width);</span></span><br><span class="line">                            <span class="comment">// console.log(event.detail.height);</span></span><br><span class="line">                            <span class="comment">// console.log(event.detail.rotate);</span></span><br><span class="line">                            <span class="comment">// console.log(event.detail.scaleX);</span></span><br><span class="line">                            <span class="comment">// console.log(event.detail.scaleY);</span></span><br><span class="line">                            that.x = <span class="built_in">parseInt</span>(event.detail.x)</span><br><span class="line">                            that.y = <span class="built_in">parseInt</span>(event.detail.y)</span><br><span class="line">                            that.width = <span class="built_in">parseInt</span>(event.detail.width)</span><br><span class="line">                            that.height = <span class="built_in">parseInt</span>(event.detail.height)</span><br><span class="line">                            <span class="comment">// that.finalImg=that.item_images+`?x-oss-process=image/crop,x_$&#123;event.detail.x&#125;,y_$&#123;event.detail.y&#125;,w_$&#123;event.detail.width&#125;,h_$&#123;event.detail.height&#125;`</span></span><br><span class="line">                            that.finalImg = that.item_images + <span class="string">`?x-oss-process=image/crop,x_<span class="subst">$&#123;that.x&#125;</span>,y_<span class="subst">$&#123;that.y&#125;</span>,w_<span class="subst">$&#123;that.width&#125;</span>,h_<span class="subst">$&#123;that.height&#125;</span>`</span></span><br><span class="line">                            <span class="comment">// console.log(that.finalImg)</span></span><br><span class="line">                        &#125;,</span><br><span class="line"></span><br><span class="line">                    &#125;)</span><br><span class="line">                    <span class="keyword">this</span>.cropper = cropper</span><br><span class="line">                &#125;, <span class="number">10</span>)</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="comment">// 确认裁剪</span></span><br><span class="line">            sureCropper() &#123;</span><br><span class="line">                <span class="keyword">let</span> obj = &#123;</span><br><span class="line">                    image_url: <span class="keyword">this</span>.item_images,</span><br><span class="line">                    image_cutting_url: <span class="keyword">this</span>.finalImg,</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">this</span>.$http.post(<span class="string">"/api/manager/image/cutting"</span>, obj).then(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">                    <span class="keyword">let</span> data = res.data.data;</span><br><span class="line">                    <span class="keyword">this</span>.dialogVisible = <span class="literal">false</span>;</span><br><span class="line">                    <span class="keyword">this</span>.croppShow = <span class="literal">false</span>;</span><br><span class="line">                    <span class="keyword">this</span>.item_images = <span class="keyword">this</span>.finalImg;</span><br><span class="line">                    <span class="keyword">this</span>.loadList();</span><br><span class="line">                &#125;)</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="comment">// 销毁裁剪框</span></span><br><span class="line">            cancelCropper() &#123;</span><br><span class="line">                <span class="keyword">this</span>.dialogVisible = <span class="literal">false</span>;</span><br><span class="line">                <span class="keyword">this</span>.cropper.destroy()</span><br><span class="line">                <span class="keyword">this</span>.croppShow = <span class="literal">false</span></span><br><span class="line">                <span class="keyword">this</span>.cropper = <span class="literal">null</span></span><br><span class="line">            &#125;,</span><br></pre></td></tr></table></figure>

<h3 id="cropper-附录"><a href="#cropper-附录" class="headerlink" title="cropper 附录"></a><strong>cropper 附录</strong></h3><p>地址: <a href="https://github.com/fengyuanchen/cropperjs#mincontainerheight" target="_blank" rel="noopener">gitHub 地址</a></p>
<blockquote>
<p>简单翻译文档</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">## 配置对象</span><br><span class="line">&gt; https:&#x2F;&#x2F;github.com&#x2F;fengyuanchen&#x2F;cropperjs</span><br><span class="line">__注意：第一个值为默认值__</span><br><span class="line"></span><br><span class="line">- viewMode 视图控制</span><br><span class="line">    - 0 无限制</span><br><span class="line">    - 1 限制裁剪框不能超出图片的范围</span><br><span class="line">    - 2 限制裁剪框不能超出图片的范围 且图片填充模式为 cover 最长边填充</span><br><span class="line">    - 3 限制裁剪框不能超出图片的范围 且图片填充模式为 contain 最短边填充</span><br><span class="line">- dragMode 拖拽图片模式</span><br><span class="line">    - crop 形成新的裁剪框</span><br><span class="line">    - move 图片可移动</span><br><span class="line">    - none 什么也没有</span><br><span class="line">- initialAspectRatio 裁剪框宽高比的初始值 默认与图片宽高比相同 只有在aspectRatio没有设置的情况下可用</span><br><span class="line">- aspectRatio 设置裁剪框为固定的宽高比</span><br><span class="line">- data 之前存储的裁剪后的数据 在初始化时会自动设置 只有在autoCrop设置为true时可用</span><br><span class="line">- preview 预览 设置一个区域容器预览裁剪后的结果</span><br><span class="line">    - Element, Array (elements), NodeList or String (selector)</span><br><span class="line">- responsive 在窗口尺寸调整后 进行响应式的重渲染 默认true</span><br><span class="line">- restore 在窗口尺寸调整后 恢复被裁剪的区域 默认true</span><br><span class="line">- checkCrossOrigin 检查图片是否跨域 默认true 如果是 会在被复制的图片元素上加上属性crossOrigin 并且在src上加上一个时间戳 避免重加载图片时因为浏览器缓存而加载错误</span><br><span class="line">- checkOrientation 检查图片的方向信息（仅JPEG图片有）默认true 在旋转图片时会对图片方向值做一些处理 以解决IOS设备上的一些问题</span><br><span class="line">- modal 是否显示图片和裁剪框之间的黑色蒙版 默认true</span><br><span class="line">- guides 是否显示裁剪框的虚线 默认true</span><br><span class="line">- center 是否显示裁剪框中间的 ‘+’ 指示器 默认true</span><br><span class="line">- highlight 是否显示裁剪框上面的白色蒙版 （很淡）默认true</span><br><span class="line">- background 是否在容器内显示网格状的背景 默认true</span><br><span class="line">- autoCrop 允许初始化时自动的裁剪图片 配合 data 使用 默认true</span><br><span class="line">- autoCropArea 设置裁剪区域占图片的大小 值为 0-1 默认 0.8 表示 80%的区域</span><br><span class="line">- movable 是否可以移动图片 默认true</span><br><span class="line">- rotatable 是否可以旋转图片 默认true</span><br><span class="line">- scalable 是否可以缩放图片（可以改变长宽） 默认true</span><br><span class="line">- zoomable 是否可以缩放图片（改变焦距） 默认true</span><br><span class="line">- zoomOnTouch 是否可以通过拖拽触摸缩放图片 默认true</span><br><span class="line">- zoomOnWheel 是否可以通过鼠标滚轮缩放图片 默认true</span><br><span class="line">- wheelZoomRatio 设置鼠标滚轮缩放的灵敏度 默认 0.1</span><br><span class="line">- cropBoxMovable 是否可以拖拽裁剪框 默认true</span><br><span class="line">- cropBoxResizable 是否可以改变裁剪框的尺寸 默认true</span><br><span class="line">- toggleDragModeOnDblclick 是否可以通过双击切换拖拽图片模式（move和crop）默认true 当拖拽图片模式为none时不可切换 该设置必须浏览器支持双击事件</span><br><span class="line">- minContainerWidth（200）、minContainerHeight（100）、minCanvasWidth（0）、minCanvasHeight（0）、minCropBoxWidth（0）、minCropBoxHeight（0） 容器、图片、裁剪框的 最小宽高 括号内为默认值 注意 裁剪框的最小高宽是相对与页面而言的 并非相对图片</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">## 方法</span><br><span class="line">__注意：如果方法没有被设置返回任何值，那么它会返回一个cropper的实例 因此多个方法可以使用链式写法__</span><br><span class="line"></span><br><span class="line">- crop() 手动显示裁剪框</span><br><span class="line">- reset() 重置图片和裁剪框为初始状态</span><br><span class="line">- replace(url[, hasSameSize]) 替换图片路径并且重建裁剪框</span><br><span class="line">    - url 新路径</span><br><span class="line">    - hasSameSize 默认值false 设置为true表示新老图片尺寸一样 只需要更换路径无需重建裁剪框</span><br><span class="line">- enable() 解冻 裁剪框</span><br><span class="line">- disable() 冻结 裁剪框</span><br><span class="line">- destroy() 摧毁裁剪框并且移除cropper实例</span><br><span class="line">- move(offsetX[, offsetY]) 移动图片指定距离 一个参数代表横纵向移动距离一样</span><br><span class="line">- moveTo(x[, y]) 移动图片到一个指定的点 一个参数代表横纵向移动距离一样</span><br><span class="line">- zoom(ratio) 缩放 ratio大于零是放大 小于零缩小</span><br><span class="line">- zoomTo(ratio[, pivot]) 缩放并设置中心点的位置</span><br><span class="line">- rotate(degree) 旋转 类似css</span><br><span class="line">- rotateTo(degree) 旋转到绝对角度</span><br><span class="line">- scale(scaleX[, scaleY])、scaleX(scaleX)、scaleY(scaleY) 缩放 一个参数代表横纵向缩放值一样</span><br><span class="line">- getData([rounded]) 返回裁剪区域基于原图片!原尺寸!的位置和尺寸 rounded默认为false 表示是否显示四舍五入后的数据 有了这些数据可以直接在原图上进行裁剪显示</span><br><span class="line">- setData(data) 改变裁剪区域基于原图的位置和尺寸 仅当viewMode 不为0时有效</span><br><span class="line">- getContainerData()、getImageData()、getCanvasData()、setCanvasData(data)、getCropBoxData()、setCropBoxData(data) 容器、图片容器（画布）、图片、裁剪区域相对容器的数据设置和获取</span><br><span class="line">- getCroppedCanvas([options]) 得到被裁剪图片的一个canvas对象 options设置这个canvas的一些数据</span><br><span class="line">    - width、height、minWidth、minHeight、maxWidth、maxHeight、fillColor、imageSmoothingEnabled（图片是否是光滑的 默认true）、imageSmoothingQuality（图片的质量 默认low 还有medium、high）</span><br><span class="line">- setAspectRatio(aspectRatio) 改变裁剪区域的宽高比</span><br><span class="line">- setDragMode([mode]) 设置拖拽图片模式</span><br><span class="line"></span><br><span class="line">## 事件</span><br><span class="line">- ready 渲染前（图片已经被加载、cropper实例已经准备完毕）的准备工作事件</span><br><span class="line">- cropstart、cropmove、cropend、crop 开始画裁剪框（或画布）、画裁剪框（或画布）的中途、裁剪框（或画布）画完、进行裁剪事件 event.detail.originalEvent、event.detail.action</span><br><span class="line">    - 当autoCrop为true crop事件会在ready之前触发</span><br><span class="line">- zoom 裁剪框缩放事件</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>vue</category>
        <category>组件</category>
      </categories>
      <tags>
        <tag>vue,js</tag>
      </tags>
  </entry>
  <entry>
    <title>封装ajax</title>
    <url>/2020/08/24/%E5%B0%81%E8%A3%85ajax/</url>
    <content><![CDATA[<p><img src="https://s1.ax1x.com/2020/08/24/dyMBrV.png" alt="dyMBrV.png"></p>
<a id="more"></a>

<h3 id="一、封装ajax"><a href="#一、封装ajax" class="headerlink" title="一、封装ajax"></a>一、封装ajax</h3><p>在app.js中与onLaunch同级</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//封装ajax</span></span><br><span class="line">ajaxRequest(url, type, data, upload) &#123;</span><br><span class="line">  <span class="keyword">let</span> that = <span class="keyword">this</span>;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (upload == <span class="string">'upload'</span>) &#123;</span><br><span class="line">        wx.chooseImage(&#123;</span><br><span class="line">          count: <span class="number">1</span>,</span><br><span class="line">          sizeType: [<span class="string">'original'</span>, <span class="string">'compressed'</span>],</span><br><span class="line">          sourceType: [<span class="string">'album'</span>, <span class="string">'camera'</span>],</span><br><span class="line">          success(imgData) &#123;</span><br><span class="line">            <span class="keyword">let</span> resImg = imgData.tempFilePaths;</span><br><span class="line">            <span class="comment">// console.log(imgData)</span></span><br><span class="line">            wx.uploadFile(&#123;</span><br><span class="line">              url: that.globalData.url + url, <span class="comment">//接口地址</span></span><br><span class="line">              filePath: resImg[<span class="number">0</span>],</span><br><span class="line">              name: <span class="string">'file'</span>,</span><br><span class="line">              formData: &#123;</span><br><span class="line">                <span class="string">'user'</span>: <span class="string">'test'</span></span><br><span class="line">              &#125;,</span><br><span class="line">              success(resData) &#123;</span><br><span class="line">                <span class="keyword">let</span> dataStatus = <span class="built_in">JSON</span>.parse(resData.data);</span><br><span class="line">                <span class="keyword">if</span> (dataStatus.status) &#123;</span><br><span class="line">                  resolve(resData);</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                  wx.showToast(&#123;</span><br><span class="line">                    title: dataStatus.message,</span><br><span class="line">                    icon: <span class="string">'none'</span>,</span><br><span class="line">                  &#125;)</span><br><span class="line">                &#125;</span><br><span class="line">              &#125;,</span><br><span class="line">              fail: <span class="function"><span class="keyword">function</span> (<span class="params">errorData</span>) </span>&#123;</span><br><span class="line">                reject(errorData);</span><br><span class="line">              &#125;,</span><br><span class="line">            &#125;)</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        wx.request(&#123;</span><br><span class="line">          url: that.globalData.url + url,</span><br><span class="line">          data: data,</span><br><span class="line">          method: type,</span><br><span class="line">          header: &#123;</span><br><span class="line">            <span class="string">'content-type'</span>: <span class="string">'application/x-www-form-urlencoded'</span></span><br><span class="line">          &#125;,</span><br><span class="line">          success: <span class="function"><span class="keyword">function</span> (<span class="params">resData</span>) </span>&#123;</span><br><span class="line">            <span class="keyword">let</span> dataStatus = resData.data;</span><br><span class="line">            <span class="comment">// console.log(resData)</span></span><br><span class="line">            <span class="keyword">if</span> (dataStatus.status) &#123;</span><br><span class="line">              resolve(resData);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">              wx.showToast(&#123;</span><br><span class="line">                title: dataStatus.message,</span><br><span class="line">                icon: <span class="string">'none'</span>,</span><br><span class="line">              &#125;)</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;,</span><br><span class="line">          fail: <span class="function"><span class="keyword">function</span> (<span class="params">errorData</span>) </span>&#123;</span><br><span class="line">            reject(errorData);</span><br><span class="line">          &#125;,</span><br><span class="line">        &#125;)</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">    &#125;)</span><br><span class="line">  &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(e);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<p>线上版本小程序只支持https域名。</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">globalData: &#123;</span><br><span class="line">    userInfo: <span class="literal">null</span>,</span><br><span class="line">    <span class="comment">// url: "http://ip:8091"</span></span><br><span class="line">    url: <span class="string">"https://xxx.com"</span></span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<h3 id="二、使用"><a href="#二、使用" class="headerlink" title="二、使用"></a>二、使用</h3><h4 id="1、上传图片"><a href="#1、上传图片" class="headerlink" title="1、上传图片"></a>1、上传图片</h4><h5 id="（1）普通上传图片"><a href="#（1）普通上传图片" class="headerlink" title="（1）普通上传图片"></a>（1）普通上传图片</h5><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//点击上传背景图</span></span><br><span class="line"> uploadBg() &#123;</span><br><span class="line">  <span class="keyword">let</span> that = <span class="keyword">this</span>;</span><br><span class="line">  that.setData(&#123;</span><br><span class="line">    isLoading: <span class="literal">true</span>,</span><br><span class="line">  &#125;)</span><br><span class="line">  <span class="comment">// console.log(width)</span></span><br><span class="line">  app.ajaxRequest(<span class="string">"/app/api/file/upload"</span>, <span class="string">""</span>, <span class="string">''</span>, <span class="string">'upload'</span>).then(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// console.log(res)</span></span><br><span class="line">    <span class="keyword">let</span> dataFile = <span class="built_in">JSON</span>.parse(res.data).data;</span><br><span class="line">    that.setData(&#123;</span><br><span class="line">      bgImg: dataFile,</span><br><span class="line">      isLoading: <span class="literal">false</span>,</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">  &#125;)</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<h5 id="（2）使用vant组件上传图片"><a href="#（2）使用vant组件上传图片" class="headerlink" title="（2）使用vant组件上传图片"></a>（2）使用vant组件上传图片</h5><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 图片 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"img_box"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">van-uploader</span> <span class="attr">file-list</span>=<span class="string">"&#123;&#123; fileList &#125;&#125;"</span> <span class="attr">max-count</span>=<span class="string">"8"</span> <span class="attr">bind:after-read</span>=<span class="string">"afterRead"</span> <span class="attr">bind:delete</span>=<span class="string">"deleteImg"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">fileList: [], <span class="comment">//作为展示图片数组</span></span><br><span class="line">fileListVal: [], <span class="comment">//传给后台图片数组["",""]</span></span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">afterRead(event) &#123;</span><br><span class="line">    <span class="keyword">let</span> that = <span class="keyword">this</span>;</span><br><span class="line">    that.setData(&#123;</span><br><span class="line">      isLoading: <span class="literal">true</span>,</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="keyword">const</span> &#123;</span><br><span class="line">      file</span><br><span class="line">    &#125; = event.detail;</span><br><span class="line">    <span class="comment">// 当设置 mutiple 为 true 时, file 为数组格式，否则为对象格式</span></span><br><span class="line">    wx.uploadFile(&#123;</span><br><span class="line">      url: <span class="string">'https://xxx.com/api'</span>, <span class="comment">// 仅为示例，非真实的接口地址</span></span><br><span class="line">      filePath: file.path,</span><br><span class="line">      name: <span class="string">'file'</span>,</span><br><span class="line">      formData: &#123;</span><br><span class="line">        user: <span class="string">'test'</span></span><br><span class="line">      &#125;,</span><br><span class="line">      success(res) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(res)</span><br><span class="line">        <span class="keyword">let</span> dataFile = <span class="built_in">JSON</span>.parse(res.data).data;</span><br><span class="line">        dataFileList.push(&#123;</span><br><span class="line">          name: <span class="string">'图片'</span>,</span><br><span class="line">          url: dataFile</span><br><span class="line">        &#125;); <span class="comment">//展示</span></span><br><span class="line">        dataFileListVal.push(dataFile); <span class="comment">//传给后台图片数据</span></span><br><span class="line">        <span class="built_in">console</span>.log(dataFileListVal)</span><br><span class="line">        that.setData(&#123;</span><br><span class="line">          fileList: dataFileList,</span><br><span class="line">          fileListVal: <span class="built_in">JSON</span>.stringify(dataFileListVal),</span><br><span class="line">          isLoading: <span class="literal">false</span>,</span><br><span class="line">        &#125;)</span><br><span class="line">        <span class="built_in">console</span>.log(that.data.fileListVal)</span><br><span class="line">        <span class="comment">// 上传完成需要更新 fileList</span></span><br><span class="line">        <span class="comment">// const &#123; fileList = [] &#125; = this.data;</span></span><br><span class="line">        <span class="comment">// fileList.push(&#123; ...file, url: res.data &#125;);</span></span><br><span class="line">        <span class="comment">// this.setData(&#123; fileList &#125;);</span></span><br><span class="line">        <span class="comment">// console.log(this.data.fileList)</span></span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">//删除图片</span></span><br><span class="line">  deleteImg(e) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(e);</span><br><span class="line">    <span class="keyword">let</span> that = <span class="keyword">this</span>;</span><br><span class="line">    <span class="keyword">let</span> imgIndex = e.detail.index;</span><br><span class="line">    dataFileList.splice(imgIndex, <span class="number">1</span>);</span><br><span class="line">    dataFileListVal.splice(imgIndex, <span class="number">1</span>);</span><br><span class="line">    that.setData(&#123;</span><br><span class="line">      fileList: dataFileList,</span><br><span class="line">      fileListVal: <span class="built_in">JSON</span>.stringify(dataFileListVal),</span><br><span class="line">      isLoading: <span class="literal">false</span>,</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="built_in">console</span>.log(that.data.fileListVal)</span><br><span class="line">  &#125;,</span><br></pre></td></tr></table></figure>

<h4 id="2、get-post请求"><a href="#2、get-post请求" class="headerlink" title="2、get/post请求"></a>2、get/post请求</h4><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//取数据</span></span><br><span class="line">   getList() &#123;</span><br><span class="line">    <span class="keyword">let</span> that = <span class="keyword">this</span>;</span><br><span class="line">    <span class="keyword">let</span> obj = &#123;</span><br><span class="line">      page:<span class="number">0</span>,</span><br><span class="line">      size:<span class="number">10</span>,</span><br><span class="line">    &#125;</span><br><span class="line">    app.ajaxRequest(<span class="string">"/api"</span>, <span class="string">"get"</span>, obj).then(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="comment">// console.log(res);</span></span><br><span class="line">      <span class="keyword">let</span> data = res.data.data;</span><br><span class="line">    </span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;,</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>wx小程序</category>
      </categories>
      <tags>
        <tag>js</tag>
      </tags>
  </entry>
  <entry>
    <title>小知识点-html</title>
    <url>/2020/07/17/%E5%B0%8F%E7%9F%A5%E8%AF%86%E7%82%B9-html/</url>
    <content><![CDATA[<p><img src="https://s1.ax1x.com/2020/07/17/Uy6vIs.jpg" alt=""></p>
<a id="more"></a>

<h3 id="1、点击调出电话拨打页面"><a href="#1、点击调出电话拨打页面" class="headerlink" title="1、点击调出电话拨打页面"></a>1、点击调出电话拨打页面</h3><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"user_tel"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">a</span> <span class="attr">:href</span>=<span class="string">"'tel:'+item.user_mobile"</span>&gt;</span>手机号：&#123;&#123;item.user_mobile&#125;&#125;<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="2、input-框输入格式限制"><a href="#2、input-框输入格式限制" class="headerlink" title="2、input 框输入格式限制"></a>2、input 框输入格式限制</h3><h4 id="1、输入框限制小数点后两位"><a href="#1、输入框限制小数点后两位" class="headerlink" title="1、输入框限制小数点后两位"></a>1、输入框限制小数点后两位</h4><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> @<span class="attr">input</span>=<span class="string">"handleInput2"</span> <span class="attr">onkeyup</span>=<span class="string">"value=value.replace(/[^\d.]/g,'')"</span> /&gt;</span> //</span><br><span class="line">通过正则过滤小数点后两位 handleInput2(e) &#123; this.ruleForm.agent_bonus_percent =</span><br><span class="line">(e.match(/^\d*(\.?\d&#123;0,2&#125;)/g)[0]) || null &#125;,</span><br></pre></td></tr></table></figure>

<h4 id="2、input-框纯数字输入"><a href="#2、input-框纯数字输入" class="headerlink" title="2、input 框纯数字输入"></a>2、input 框纯数字输入</h4><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">class</span>=<span class="string">"price_input"</span> <span class="attr">placeholder</span>=<span class="string">"手机号"</span> <span class="attr">type</span>=<span class="string">"number"</span> <span class="attr">oninput</span> =</span></span><br><span class="line"><span class="tag">"<span class="attr">this.value</span>=<span class="string">this.value.replace(/[^0-9.]+/,</span>'')"/</span></span><br></pre></td></tr></table></figure>

<h4 id="3、字节数限制"><a href="#3、字节数限制" class="headerlink" title="3、字节数限制"></a>3、字节数限制</h4><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">"标题"</span> <span class="attr">prop</span>=<span class="string">"title"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">el-input</span></span></span><br><span class="line"><span class="tag">    <span class="attr">v-model</span>=<span class="string">"baseSetForm.title"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">:minlength</span>=<span class="string">"10"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">:maxlength</span>=<span class="string">"60"</span></span></span><br><span class="line"><span class="tag">  &gt;</span><span class="tag">&lt;/<span class="name">el-input</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"title_tip"</span>&gt;</span></span><br><span class="line">    &#123;&#123;parseInt(baseSetForm.title.replace(/[^\x00-\xff]/g, '01').length/2)&#125;&#125;/30</span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="3、下载-pdf"><a href="#3、下载-pdf" class="headerlink" title="3、下载 pdf"></a>3、下载 pdf</h3><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"down_load"</span> <span class="attr">target</span>=<span class="string">"_blank"</span></span></span><br><span class="line"><span class="tag">  <span class="attr">href</span>=<span class="string">"http://npjy.oss-cn-beijing.aliyuncs.com/images/file-1574758228222FkR4M.pdf"</span></span></span><br><span class="line"><span class="tag">  &gt;</span>点击下载pdf<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="4、input监听回车事件"><a href="#4、input监听回车事件" class="headerlink" title="4、input监听回车事件"></a>4、input监听回车事件</h3><h4 id="1、普通input框"><a href="#1、普通input框" class="headerlink" title="1、普通input框"></a>1、普通input框</h4><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">v-model</span>=<span class="string">"form.name"</span> <span class="attr">placeholder</span>=<span class="string">"昵称"</span> @<span class="attr">keyup.enter</span>=<span class="string">"submit"</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="2、element-ui-input框"><a href="#2、element-ui-input框" class="headerlink" title="2、element-ui input框"></a>2、element-ui input框</h4><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">el-input</span> <span class="attr">v-model</span>=<span class="string">"form.name"</span> <span class="attr">placeholder</span>=<span class="string">"昵称"</span> @<span class="attr">keyup.enter.native</span>=<span class="string">"submit"</span>&gt;</span><span class="tag">&lt;/<span class="name">el-input</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="5、阻止父元素冒泡事件"><a href="#5、阻止父元素冒泡事件" class="headerlink" title="5、阻止父元素冒泡事件"></a>5、阻止父元素冒泡事件</h3><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> @<span class="attr">click</span>=<span class="string">"a"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">"b"</span>&gt;</span><span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>当触发 button 的事件 a 时，b 事件也会被触发</p>
<p>解决办法：在 button 上添加@click.stop=”b”，来阻止事件冒泡。</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> @<span class="attr">click</span>=<span class="string">"a"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click.stop</span>=<span class="string">"b"</span>&gt;</span><span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>常用</category>
        <category>常用方法</category>
      </categories>
      <tags>
        <tag>html</tag>
      </tags>
  </entry>
  <entry>
    <title>小知识点-css</title>
    <url>/2020/07/17/%E5%B0%8F%E7%9F%A5%E8%AF%86%E7%82%B9-css/</url>
    <content><![CDATA[<p><img src="https://s1.ax1x.com/2020/07/17/UycaSP.jpg" alt=""></p>
<a id="more"></a>

<h3 id="1、textarea"><a href="#1、textarea" class="headerlink" title="1、textarea"></a>1、textarea</h3><figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*去掉边框*/</span></span><br><span class="line"><span class="selector-tag">border</span>: <span class="selector-tag">none</span>;</span><br><span class="line"><span class="comment">/*去掉拖拉框*/</span></span><br><span class="line"><span class="selector-tag">resize</span>: <span class="selector-tag">none</span>;</span><br></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--表示可见行数6，可见宽度100px，只读--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">textarea</span> <span class="attr">class</span>=<span class="string">"result_text"</span> <span class="attr">rows</span>=<span class="string">"6"</span> <span class="attr">cols</span>=<span class="string">"100"</span> <span class="attr">readonly</span>&gt;</span><span class="tag">&lt;/<span class="name">textarea</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="2、input-placeholder样式"><a href="#2、input-placeholder样式" class="headerlink" title="2、input placeholder样式"></a>2、input placeholder样式</h3><figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">input</span><span class="selector-pseudo">::-webkit-input-placeholder</span> &#123;</span><br><span class="line">        <span class="attribute">opacity</span>:<span class="number">0.3</span>;</span><br><span class="line">        <span class="attribute">color</span>:<span class="number">#fff</span> ;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h3 id="3、超出部分用省略号显示"><a href="#3、超出部分用省略号显示" class="headerlink" title="3、超出部分用省略号显示"></a>3、超出部分用省略号显示</h3><figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*行数限制，超出部分省略*/</span></span><br><span class="line"><span class="selector-tag">display</span>: <span class="selector-tag">-webkit-box</span>;</span><br><span class="line">  <span class="selector-tag">-webkit-box-orient</span>: <span class="selector-tag">vertical</span>;</span><br><span class="line">  <span class="selector-tag">-webkit-line-clamp</span>: 2;</span><br><span class="line">  <span class="selector-tag">overflow</span>: <span class="selector-tag">hidden</span>;</span><br></pre></td></tr></table></figure>

<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*宽度限制，超出部分省略*/</span></span><br><span class="line"><span class="selector-tag">max-width</span>: 4<span class="selector-class">.6rem</span>;</span><br><span class="line"><span class="selector-tag">overflow</span>: <span class="selector-tag">hidden</span>;</span><br><span class="line"><span class="selector-tag">text-overflow</span>: <span class="selector-tag">ellipsis</span>;</span><br><span class="line"><span class="selector-tag">white-space</span>: <span class="selector-tag">nowrap</span>;</span><br></pre></td></tr></table></figure>

<h3 id="4、超出部分横向滑动"><a href="#4、超出部分横向滑动" class="headerlink" title="4、超出部分横向滑动"></a>4、超出部分横向滑动</h3><blockquote>
<p><strong>父元素</strong></p>
</blockquote>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">display</span>: <span class="selector-tag">flex</span>;</span><br><span class="line"><span class="selector-tag">overflow</span>: <span class="selector-tag">auto</span>;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>子元素</p>
</blockquote>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">flex</span>: 1 0 <span class="selector-tag">auto</span>;</span><br></pre></td></tr></table></figure>

<h3 id="5、中划线"><a href="#5、中划线" class="headerlink" title="5、中划线"></a>5、中划线</h3><figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">text-decoration</span>: <span class="selector-tag">line-through</span>;</span><br></pre></td></tr></table></figure>

<h3 id="6、文本两端对齐"><a href="#6、文本两端对齐" class="headerlink" title="6、文本两端对齐"></a>6、文本两端对齐</h3><figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">text-align</span>: <span class="selector-tag">justify</span>;</span><br></pre></td></tr></table></figure>

<h3 id="7、中文间隔"><a href="#7、中文间隔" class="headerlink" title="7、中文间隔"></a>7、中文间隔</h3><figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">vletter-spacing</span>: 4<span class="selector-tag">px</span>;</span><br></pre></td></tr></table></figure>

<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">letter-spacing</span>: 8<span class="selector-tag">px</span>;</span><br></pre></td></tr></table></figure>

<h3 id="8、英文自动换行"><a href="#8、英文自动换行" class="headerlink" title="8、英文自动换行"></a>8、英文自动换行</h3><figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">word-wrap</span>: <span class="selector-tag">break-word</span></span><br></pre></td></tr></table></figure>

<h3 id="9、背景渐变色"><a href="#9、背景渐变色" class="headerlink" title="9、背景渐变色"></a>9、背景渐变色</h3><figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">background</span>: <span class="selector-tag">-webkit-linear-gradient</span>(<span class="selector-tag">left</span> <span class="selector-tag">top</span>,<span class="selector-id">#F98530</span>, <span class="selector-id">#FAB03D</span>);</span><br></pre></td></tr></table></figure>

<h3 id="10、伪元素实现清除浮动"><a href="#10、伪元素实现清除浮动" class="headerlink" title="10、伪元素实现清除浮动"></a>10、伪元素实现清除浮动</h3><p>在父元素上面写class=“clearfix”内部子元素便清除浮动。</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.clearfix</span><span class="selector-pseudo">:after</span> &#123;</span><br><span class="line">        <span class="attribute">content</span>: <span class="string">"."</span>;</span><br><span class="line">        <span class="attribute">display</span>: block;</span><br><span class="line">        <span class="attribute">height</span>: <span class="number">0</span>;</span><br><span class="line">        <span class="attribute">clear</span>: both;</span><br><span class="line">        <span class="attribute">visibility</span>: hidden;</span><br><span class="line">        <span class="attribute">zoom</span>: <span class="number">1</span></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h3 id="11、清除padding所占空间"><a href="#11、清除padding所占空间" class="headerlink" title="11、清除padding所占空间"></a>11、清除padding所占空间</h3><figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">box-sizing</span>: <span class="selector-tag">border-box</span>;</span><br></pre></td></tr></table></figure>

<h3 id="12、触摸屏幕菜单混乱"><a href="#12、触摸屏幕菜单混乱" class="headerlink" title="12、触摸屏幕菜单混乱"></a>12、触摸屏幕菜单混乱</h3><figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">touch-action</span><span class="selector-pseudo">:none</span>;<span class="comment">/*当你触摸并按住触摸目标时候,系统默认菜单被禁用*/</span></span><br><span class="line"><span class="selector-tag">touch-action</span><span class="selector-pseudo">:default</span>;<span class="comment">/*当你触摸并按住触摸目标时候,系统默认菜单不被禁用*/</span></span><br></pre></td></tr></table></figure>

<h3 id="13、禁止图片长按保存"><a href="#13、禁止图片长按保存" class="headerlink" title="13、禁止图片长按保存"></a>13、禁止图片长按保存</h3><figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">pointer-events</span><span class="selector-pseudo">:none</span>;</span><br></pre></td></tr></table></figure>

<h3 id="14、防止图片被拉伸，取中间部分"><a href="#14、防止图片被拉伸，取中间部分" class="headerlink" title="14、防止图片被拉伸，取中间部分"></a>14、防止图片被拉伸，取中间部分</h3><figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">object-fit</span>: <span class="selector-tag">cover</span>;</span><br></pre></td></tr></table></figure>

<h3 id="15、网站变灰"><a href="#15、网站变灰" class="headerlink" title="15、网站变灰"></a>15、网站变灰</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">html &#123;</span><br><span class="line">  -webkit-filter: grayscale(100%);</span><br><span class="line">  -moz-filter: grayscale(100%);</span><br><span class="line">  -ms-filter: grayscale(100%);</span><br><span class="line">  -o-filter: grayscale(100%);</span><br><span class="line">  filter: grayscale(100%);</span><br><span class="line">  filter: gray;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>常用</category>
        <category>常用方法</category>
      </categories>
      <tags>
        <tag>css</tag>
      </tags>
  </entry>
  <entry>
    <title>小程序散知识点</title>
    <url>/2020/08/24/%E5%B0%8F%E7%A8%8B%E5%BA%8F%E6%95%A3%E7%9F%A5%E8%AF%86%E7%82%B9/</url>
    <content><![CDATA[<p><img src="https://cdn.jsdelivr.net/gh/liebexiao/myImgs/20200904215117.png" alt=""></p>
<a id="more"></a>

<h3 id="一、底部-tab-配置"><a href="#一、底部-tab-配置" class="headerlink" title="一、底部 tab 配置"></a>一、底部 tab 配置</h3><p><img src="https://cdn.jsdelivr.net/gh/liebexiao/myImgs/20200904181559.png" alt=""></p>
<p>在 <strong>app.json</strong> 中，与 pages 平级，这里的图标必须是在此项目文件夹中的图片。</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="string">"window"</span>: &#123;</span><br><span class="line">    <span class="string">"backgroundTextStyle"</span>: <span class="string">"light"</span>,</span><br><span class="line">    <span class="string">"navigationBarBackgroundColor"</span>: <span class="string">"#EF2E30"</span>,</span><br><span class="line">    <span class="string">"navigationBarTitleText"</span>: <span class="string">"小程序名"</span>,</span><br><span class="line">    <span class="string">"navigationBarTextStyle"</span>: <span class="string">"white"</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">"tabBar"</span>: &#123;</span><br><span class="line">    <span class="string">"color"</span>: <span class="string">"#666666"</span>,</span><br><span class="line">    <span class="string">"selectedColor"</span>: <span class="string">"#F96C5D"</span>,</span><br><span class="line">    <span class="string">"list"</span>: [&#123;</span><br><span class="line">        <span class="string">"pagePath"</span>: <span class="string">"pages/home/homePage/homePage"</span>,</span><br><span class="line">        <span class="string">"text"</span>: <span class="string">"首页"</span>,</span><br><span class="line">        <span class="string">"iconPath"</span>: <span class="string">"/static/images/home_icon.png"</span>,</span><br><span class="line">        <span class="string">"selectedIconPath"</span>: <span class="string">"/static/images/home_icon1.png"</span></span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="string">"pagePath"</span>: <span class="string">"pages/whole/newsList/newsList"</span>,</span><br><span class="line">        <span class="string">"text"</span>: <span class="string">"全部"</span>,</span><br><span class="line">        <span class="string">"iconPath"</span>: <span class="string">"/static/images/all_icon.png"</span>,</span><br><span class="line">        <span class="string">"selectedIconPath"</span>: <span class="string">"/static/images/all_icon1.png"</span></span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="string">"pagePath"</span>: <span class="string">"pages/task/taskCatList/taskCatList"</span>,</span><br><span class="line">        <span class="string">"text"</span>: <span class="string">"任务"</span>,</span><br><span class="line">        <span class="string">"iconPath"</span>: <span class="string">"/static/images/task_icon.png"</span>,</span><br><span class="line">        <span class="string">"selectedIconPath"</span>: <span class="string">"/static/images/task_icon1.png"</span></span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="string">"pagePath"</span>: <span class="string">"pages/my/myPage/myPage"</span>,</span><br><span class="line">        <span class="string">"text"</span>: <span class="string">"我的"</span>,</span><br><span class="line">        <span class="string">"iconPath"</span>: <span class="string">"/static/images/my_icon.png"</span>,</span><br><span class="line">        <span class="string">"selectedIconPath"</span>: <span class="string">"/static/images/my_icon1.png"</span></span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br></pre></td></tr></table></figure>

<h3 id="二、路由跳转"><a href="#二、路由跳转" class="headerlink" title="二、路由跳转"></a>二、路由跳转</h3><h4 id="1、跳转至导航栏页面"><a href="#1、跳转至导航栏页面" class="headerlink" title="1、跳转至导航栏页面"></a>1、跳转至导航栏页面</h4><p>这个页面跳转 url 后面不能带参数。</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">wx.switchTab(&#123;</span><br><span class="line">  url: <span class="string">"/pages/whole/newsList/newsList"</span>,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h4 id="2、跳转至普通页面"><a href="#2、跳转至普通页面" class="headerlink" title="2、跳转至普通页面"></a>2、跳转至普通页面</h4><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">wx.navigateTo(&#123;</span><br><span class="line">  url: <span class="string">"/pages/whole/newsDetail/newsDetail?news_id="</span> + news_id,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<blockquote>
<p>获取连接参数</p>
<blockquote>
<p>在 onLoad 方法中 <strong>options.news_id</strong></p>
</blockquote>
</blockquote>
<h4 id="3、返回上个路由"><a href="#3、返回上个路由" class="headerlink" title="3、返回上个路由"></a>3、返回上个路由</h4><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">wx.navigateBack(&#123;</span><br><span class="line">  delta: <span class="number">1</span>,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="三、缓存"><a href="#三、缓存" class="headerlink" title="三、缓存"></a>三、缓存</h3><blockquote>
<p>存缓存</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">wx.setStorageSync(<span class="string">"userInfo"</span>, data);</span><br></pre></td></tr></table></figure>

<blockquote>
<p>取缓存</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">wx.getStorageSync(<span class="string">'userInfo'</span>), <span class="comment">//用户信息</span></span><br></pre></td></tr></table></figure>

<h3 id="四、修改当前页面-title"><a href="#四、修改当前页面-title" class="headerlink" title="四、修改当前页面 title"></a>四、修改当前页面 title</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">wx.setNavigationBarTitle(&#123;</span><br><span class="line">  title: <span class="string">"页面title"</span>, <span class="comment">//页面标题为路由参数</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="五、一键复制"><a href="#五、一键复制" class="headerlink" title="五、一键复制"></a>五、一键复制</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">coppyTitle()&#123;</span><br><span class="line">   <span class="keyword">let</span> that=<span class="keyword">this</span>;</span><br><span class="line">   wx.setClipboardData(&#123;</span><br><span class="line">     data: that.data.templateTitle,</span><br><span class="line">     success(res) &#123;</span><br><span class="line">       wx.getClipboardData(&#123;</span><br><span class="line">         success(res) &#123;</span><br><span class="line">           <span class="built_in">console</span>.log(res.data) <span class="comment">// data</span></span><br><span class="line">         &#125;</span><br><span class="line">       &#125;)</span><br><span class="line">     &#125;</span><br><span class="line">   &#125;)</span><br><span class="line"> &#125;,</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>wx小程序</category>
      </categories>
      <tags>
        <tag>wxml、js</tag>
      </tags>
  </entry>
  <entry>
    <title>小知识点-js</title>
    <url>/2020/07/17/%E5%B0%8F%E7%9F%A5%E8%AF%86%E7%82%B9-js/</url>
    <content><![CDATA[<p><img src="https://s1.ax1x.com/2020/07/17/Uyyv36.jpg" alt=""></p>
<a id="more"></a>

<h3 id="一、数组"><a href="#一、数组" class="headerlink" title="一、数组"></a><strong>一、数组</strong></h3><h4 id="1、解析动态-json-数据"><a href="#1、解析动态-json-数据" class="headerlink" title="1、解析动态 json 数据"></a>1、解析动态 json 数据</h4><p><img src="https://s1.ax1x.com/2020/07/17/UsYa5Q.png" alt="UsYa5Q.png"></p>
<h5 id="（1）取出-key-和-value-的值。再封装到一个数组里面。"><a href="#（1）取出-key-和-value-的值。再封装到一个数组里面。" class="headerlink" title="*（1）取出 key 和 value 的值。再封装到一个数组里面。 *"></a>*<em>（1）取出 key 和 value 的值。再封装到一个数组里面。 *</em></h5><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> userData = res.data.data;</span><br><span class="line"><span class="keyword">let</span> userArray = [];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> [key, value] <span class="keyword">of</span> <span class="built_in">Object</span>.entries(userData)) &#123;</span><br><span class="line">  userArray.push(&#123; 时间: key, 人数: value &#125;);</span><br><span class="line">  <span class="built_in">console</span>.log(userArray);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="（2）只取-key-值"><a href="#（2）只取-key-值" class="headerlink" title="（2）只取 key 值"></a><strong>（2）只取 key 值</strong></h5><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> key <span class="keyword">of</span> <span class="built_in">Object</span>.keys(obj)) &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="（3）只取-value-值"><a href="#（3）只取-value-值" class="headerlink" title="（3）只取 value 值"></a><strong>（3）只取 value 值</strong></h5><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> value <span class="keyword">of</span> <span class="built_in">Object</span>.values(obj)) &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="2、去掉指定数组对象-id-相同的元素"><a href="#2、去掉指定数组对象-id-相同的元素" class="headerlink" title="2、去掉指定数组对象 id 相同的元素"></a>2、去掉指定数组对象 id 相同的元素</h4><p>去除数组中 id 等于 2 的元素</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">arr.splice(</span><br><span class="line">  arr.findIndex(<span class="function">(<span class="params">item</span>) =&gt;</span> item.id == <span class="number">2</span>),</span><br><span class="line">  <span class="number">1</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<h4 id="3、过滤对象数组中-key-值相同的数据"><a href="#3、过滤对象数组中-key-值相同的数据" class="headerlink" title="3、过滤对象数组中 key 值相同的数据"></a>3、过滤对象数组中 key 值相同的数据</h4><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> arr = [</span><br><span class="line">  &#123;</span><br><span class="line">    count: <span class="number">1095</span>,</span><br><span class="line">    month: <span class="string">"三月"</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    count: <span class="number">1106</span>,</span><br><span class="line">    month: <span class="string">"三月"</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    count: <span class="number">987</span>,</span><br><span class="line">    month: <span class="string">"四月"</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    count: <span class="number">1166</span>,</span><br><span class="line">    month: <span class="string">"四月"</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    count: <span class="number">753</span>,</span><br><span class="line">    month: <span class="string">"五月"</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    count: <span class="number">891</span>,</span><br><span class="line">    month: <span class="string">"五月"</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">];</span><br><span class="line"><span class="keyword">const</span> res = <span class="keyword">new</span> <span class="built_in">Map</span>();</span><br><span class="line"><span class="keyword">const</span> new2 = arr.filter(</span><br><span class="line">  (item) =&gt; !res.has(item.month) &amp;&amp; res.set(item.month, <span class="number">1</span>)</span><br><span class="line">);</span><br><span class="line"><span class="built_in">console</span>.log(arr.length, new2);</span><br><span class="line"><span class="comment">//6 "[&#123;"count":1095,"month":"三月"&#125;,&#123;"count":987,"month":"四月"&#125;,&#123;"count":753,"month":"五月"&#125;]"</span></span><br></pre></td></tr></table></figure>

<h4 id="4、数组去重"><a href="#4、数组去重" class="headerlink" title="4、数组去重"></a>4、数组去重</h4><p>方法一、</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>];</span><br><span class="line"><span class="keyword">let</span> newArr = [...new <span class="built_in">Set</span>(arr)];</span><br><span class="line"><span class="comment">//结果：newArr = [1, 2, 3, 4, 5, 6]</span></span><br></pre></td></tr></table></figure>

<p>方法二、</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>];</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">let</span> i=<span class="number">0</span>;i&lt;arr.length;i++)&#123;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">let</span> j=i+<span class="number">1</span>;j&lt;arr.length;j++)&#123;</span><br><span class="line">		<span class="keyword">if</span>(arr[i]==arr[j])&#123;</span><br><span class="line">			arr.splice(j,<span class="number">1</span>);</span><br><span class="line">			j--;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="5、随机取数组对象"><a href="#5、随机取数组对象" class="headerlink" title="5、随机取数组对象"></a>5、随机取数组对象</h4><p>传入方法的两个参数：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//arr为数组，num为想要取出数据个数。</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getArrayItems</span>(<span class="params">arr, num</span>) </span>&#123;</span><br><span class="line">  <span class="comment">//新建一个数组,将传入的数组复制过来,用于运算,而不要直接操作传入的数组;</span></span><br><span class="line">  <span class="keyword">var</span> temp_array = <span class="keyword">new</span> <span class="built_in">Array</span>();</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> index <span class="keyword">in</span> arr) &#123;</span><br><span class="line">    temp_array.push(arr[index]);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">//取出的数值项,保存在此数组</span></span><br><span class="line">  <span class="keyword">var</span> return_array = <span class="keyword">new</span> <span class="built_in">Array</span>();</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; num; i++) &#123;</span><br><span class="line">    <span class="comment">//判断如果数组还有可以取出的元素,以防下标越界</span></span><br><span class="line">    <span class="keyword">if</span> (temp_array.length &gt; <span class="number">0</span>) &#123;</span><br><span class="line">      <span class="comment">//在数组中产生一个随机索引</span></span><br><span class="line">      <span class="keyword">var</span> arrIndex = <span class="built_in">Math</span>.floor(<span class="built_in">Math</span>.random() * temp_array.length);</span><br><span class="line">      <span class="comment">//将此随机索引的对应的数组元素值复制出来</span></span><br><span class="line">      return_array[i] = temp_array[arrIndex];</span><br><span class="line">      <span class="comment">//然后删掉此索引的数组元素,这时候temp_array变为新的数组</span></span><br><span class="line">      temp_array.splice(arrIndex, <span class="number">1</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="comment">//数组中数据项取完后,退出循环,比如数组本来只有10项,但要求取出20项.</span></span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> return_array;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="6、数组排序"><a href="#6、数组排序" class="headerlink" title="6、数组排序"></a>6、数组排序</h4><blockquote>
<p>let a=[1,2,15,3,22,33]</p>
</blockquote>
<ul>
<li><p>颠倒</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//就是颠倒数组顺序</span></span><br><span class="line">a.reverse(); <span class="comment">//[33, 22, 3, 15, 2, 1]</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>正序</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//此方法不传入参数时，会使用默认排序方式。先调用每个元素的toString() 方法，然后按照转换后字符串的 Unicode 编码来进行排序</span></span><br><span class="line">a.sort(); <span class="comment">// [1, 15, 2, 22, 3, 33]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//若 a 小于 b，那么 a 会被排列到 b 之前。</span></span><br><span class="line"><span class="comment">//若 a 等于 b，a 和 b 的相对位置不变。</span></span><br><span class="line"><span class="comment">//若 a 大于 b，b 会被排列到 a 之前。</span></span><br><span class="line">a.sort(<span class="function">(<span class="params">a, b</span>) =&gt;</span> a - b); <span class="comment">// [1, 2, 3, 15, 22, 33]</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>倒序</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">a.sort(<span class="function">(<span class="params">a, b</span>) =&gt;</span> b - a); <span class="comment">//  [33, 22, 15, 3, 2, 1]</span></span><br></pre></td></tr></table></figure>

</li>
</ul>
<h4 id="7、取值"><a href="#7、取值" class="headerlink" title="7、取值"></a>7、取值</h4><blockquote>
<p>let a=[1,2,3,4,5]</p>
</blockquote>
<ul>
<li>数组在第一位追加数据</li>
</ul>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">a.unshift(); <span class="comment">//5,代表数组长度；</span></span><br><span class="line">a.unshift(<span class="number">0</span>); <span class="comment">//返回6，数组长度；此时a=[0, 1, 2, 3, 4, 5]；</span></span><br></pre></td></tr></table></figure>

<ul>
<li><p>取出数组第一位</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">a.shift(); <span class="comment">//1,不仅将数据取出，而且改变了数组，此时a=[2, 3, 4, 5]</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>取出数组最后一位</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">a.pop(); <span class="comment">//5,一样也是改变了数组，此时a=[1, 2, 3, 4]</span></span><br></pre></td></tr></table></figure>

</li>
</ul>
<hr>
<h3 id="二、vue"><a href="#二、vue" class="headerlink" title="二、vue"></a><strong>二、vue</strong></h3><h4 id="1、设置当前页面-color"><a href="#1、设置当前页面-color" class="headerlink" title="1、设置当前页面 color"></a><strong>1、设置当前页面 color</strong></h4><blockquote>
<p>在 mounted 里面写：</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="built_in">document</span>.querySelector(<span class="string">"body"</span>).setAttribute(<span class="string">"style"</span>, <span class="string">"background-color:#fff"</span>);</span><br></pre></td></tr></table></figure>

<h4 id="2、判断页面是否存在上层路由"><a href="#2、判断页面是否存在上层路由" class="headerlink" title="2、判断页面是否存在上层路由"></a><strong>2、判断页面是否存在上层路由</strong></h4><blockquote>
<p>不存在：window.history.length &lt;= 1</p>
</blockquote>
<blockquote>
<p>返回上层路由：this.$router.go(-1)</p>
</blockquote>
<h4 id="3、vue-修改-data-数据后页面未渲染"><a href="#3、vue-修改-data-数据后页面未渲染" class="headerlink" title="3、vue 修改 data 数据后页面未渲染"></a>3、vue 修改 data 数据后页面未渲染</h4><ul>
<li>1、强制渲染</li>
</ul>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">this</span>.$forceUpdate();</span><br></pre></td></tr></table></figure>

<ul>
<li>2、使用 vue.set</li>
</ul>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">Vue.set(target, key, value);</span><br><span class="line"><span class="comment">// target：要更改的数据源(可以是对象或者数组)</span></span><br><span class="line"><span class="comment">// key：要更改的具体数据</span></span><br><span class="line"><span class="comment">// value ：重新赋的值</span></span><br></pre></td></tr></table></figure>

<h4 id="4、自定义组件"><a href="#4、自定义组件" class="headerlink" title="4、自定义组件"></a>4、自定义组件</h4><h5 id="（1）父组件向子组件传值"><a href="#（1）父组件向子组件传值" class="headerlink" title="（1）父组件向子组件传值"></a>（1）父组件向子组件传值</h5><p>父.vue</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*引入子组件*/</span></span><br><span class="line">&lt;child-v ref=<span class="string">"chil"</span>&gt;&lt;<span class="regexp">/child-v&gt;;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">/</span>*script</span><br><span class="line"> *showHover为子元素内的方法*<span class="regexp">/</span></span><br><span class="line"><span class="regexp">this.$refs.chil.showMessage("父组件调用子组件方法啦");</span></span><br></pre></td></tr></table></figure>

<p>子.vue</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//只需要正常定义方法接参即可</span></span><br><span class="line">methods: &#123;</span><br><span class="line">    showMessage(text) &#123;</span><br><span class="line">     <span class="built_in">console</span>.log(text)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="（2）父子组件相互调用"><a href="#（2）父子组件相互调用" class="headerlink" title="（2）父子组件相互调用"></a>（2）父子组件相互调用</h5><ul>
<li><p>vue 子组件调用父组件方法：</p>
<blockquote>
<p>子组件：this.$emit(‘xx’);</p>
<p>父组件:定义 yy 方法，并在引用子组件时传参,如@xx=”yy”</p>
</blockquote>
</li>
<li><p>vue 父组件调用子组件方法：</p>
<blockquote>
<p>子组件：定义 xx 方法</p>
<p>父组件：引用子组件时加上 ref=”yy”,调用方法为 this.$refs.yy.xx()</p>
</blockquote>
</li>
</ul>
<h3 id="三、js"><a href="#三、js" class="headerlink" title="三、js"></a><strong>三、js</strong></h3><h4 id="1、屏幕高宽"><a href="#1、屏幕高宽" class="headerlink" title="1、屏幕高宽"></a><strong>1、屏幕高宽</strong></h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">window.screen.availWidth</span><br><span class="line">window.screen.availHeight</span><br></pre></td></tr></table></figure>

<h4 id="2、可视宽高"><a href="#2、可视宽高" class="headerlink" title="2、可视宽高"></a>2、可视宽高</h4><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="built_in">window</span>.innerWidth;</span><br><span class="line"><span class="built_in">window</span>.innerHeight;</span><br></pre></td></tr></table></figure>

<h4 id="2、判断-ios"><a href="#2、判断-ios" class="headerlink" title="2、判断 ios"></a>2、判断 ios</h4><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> u = navigator.userAgent;</span><br><span class="line">isiOS: !!u.match(<span class="regexp">/\(i[^;]+;( U;)? CPU.+Mac OS X/</span>), <span class="comment">// ios终端</span></span><br></pre></td></tr></table></figure>

<h4 id="3、替换字符串"><a href="#3、替换字符串" class="headerlink" title="3、替换字符串"></a>3、替换字符串</h4><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//替换第一个字符串</span></span><br><span class="line">replace(<span class="string">"http"</span>, <span class="string">"https"</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//替换所有</span></span><br><span class="line">replace(<span class="regexp">/http/g</span>, <span class="string">"https"</span>);</span><br></pre></td></tr></table></figure>

<h4 id="4、判断是否是数字还是字符串"><a href="#4、判断是否是数字还是字符串" class="headerlink" title="4、判断是否是数字还是字符串"></a>4、判断是否是数字还是字符串</h4><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> a = <span class="string">"1234"</span>;</span><br><span class="line"><span class="keyword">typeof</span> a; <span class="comment">//number</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> b = <span class="string">"aasfgfgh"</span>;</span><br><span class="line"><span class="keyword">typeof</span> b; <span class="comment">//string</span></span><br></pre></td></tr></table></figure>

<h4 id="5、取整"><a href="#5、取整" class="headerlink" title="5、取整"></a>5、取整</h4><h5 id="1、只保留整数部分"><a href="#1、只保留整数部分" class="headerlink" title="1、只保留整数部分"></a>1、只保留整数部分</h5><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="built_in">parseInt</span>(<span class="number">5.1234</span>); <span class="comment">// 5</span></span><br></pre></td></tr></table></figure>

<h5 id="2、向下取整-（效果等同于-parseInt）"><a href="#2、向下取整-（效果等同于-parseInt）" class="headerlink" title="2、向下取整 （效果等同于 parseInt）"></a>2、向下取整 （效果等同于 parseInt）</h5><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="built_in">Math</span>.floor(<span class="number">5.1234</span>); <span class="comment">// 5</span></span><br></pre></td></tr></table></figure>

<h5 id="3、向上取整-（有小数，整数部分-1）"><a href="#3、向上取整-（有小数，整数部分-1）" class="headerlink" title="3、向上取整 （有小数，整数部分+1）"></a>3、向上取整 （有小数，整数部分+1）</h5><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="built_in">Math</span>.ceil(<span class="number">5.1234</span>); <span class="comment">// 6</span></span><br></pre></td></tr></table></figure>

<h5 id="4、四舍五入"><a href="#4、四舍五入" class="headerlink" title="4、四舍五入"></a>4、四舍五入</h5><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="built_in">Math</span>.round(<span class="number">5.1234</span>); <span class="comment">// 5</span></span><br><span class="line"><span class="built_in">Math</span>.round(<span class="number">5.6789</span>); <span class="comment">// 6</span></span><br></pre></td></tr></table></figure>

<h5 id="5、绝对值"><a href="#5、绝对值" class="headerlink" title="5、绝对值"></a>5、绝对值</h5><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="built_in">Math</span>.abs(<span class="number">-1</span>); <span class="comment">// 1</span></span><br></pre></td></tr></table></figure>

<h5 id="6、返回两数中的较大者"><a href="#6、返回两数中的较大者" class="headerlink" title="6、返回两数中的较大者"></a>6、返回两数中的较大者</h5><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="built_in">Math</span>.max(<span class="number">1</span>, <span class="number">2</span>); <span class="comment">// 2</span></span><br></pre></td></tr></table></figure>

<h5 id="7、返回两数中的较小者"><a href="#7、返回两数中的较小者" class="headerlink" title="7、返回两数中的较小者"></a>7、返回两数中的较小者</h5><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="built_in">Math</span>.min(<span class="number">1</span>, <span class="number">2</span>); <span class="comment">// 1</span></span><br></pre></td></tr></table></figure>

<h5 id="8、随机数"><a href="#8、随机数" class="headerlink" title="8、随机数"></a>8、随机数</h5><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="built_in">Math</span>.random(); <span class="comment">//取0-1之间得随机数</span></span><br></pre></td></tr></table></figure>

<h4 id="6、拷贝"><a href="#6、拷贝" class="headerlink" title="6、拷贝"></a>6、拷贝</h4><h5 id="1、浅拷贝"><a href="#1、浅拷贝" class="headerlink" title="1、浅拷贝"></a>1、浅拷贝</h5><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> a = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</span><br><span class="line"><span class="keyword">let</span> b = a;</span><br><span class="line">b.push(<span class="number">4</span>);</span><br><span class="line"><span class="comment">//这时输出a的值为[1,2,3,4];  b的值也是[1,2,3,4]</span></span><br></pre></td></tr></table></figure>

<h5 id="2、深拷贝"><a href="#2、深拷贝" class="headerlink" title="2、深拷贝"></a>2、深拷贝</h5><blockquote>
<p>方法一</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> a = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</span><br><span class="line"><span class="keyword">let</span> b = a.concat();</span><br><span class="line">b.push(<span class="number">4</span>);</span><br><span class="line"><span class="comment">//此时 a的值为[1, 2, 3]，b的值为[1,2,3,4]</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>方法二</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> a = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</span><br><span class="line"><span class="keyword">let</span> b = <span class="built_in">Object</span>.assign(&#123;&#125;, a);</span><br><span class="line">b.push(<span class="number">4</span>);</span><br><span class="line"><span class="comment">//此时 a的值为[1, 2, 3]，b的值为[1,2,3,4]</span></span><br></pre></td></tr></table></figure>

<h4 id="7、打印网页"><a href="#7、打印网页" class="headerlink" title="7、打印网页"></a>7、打印网页</h4><blockquote>
<p>在加载完页面之后执行打印方法</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="built_in">window</span>.print();</span><br></pre></td></tr></table></figure>

<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="keyword">@media</span> print &#123;</span><br><span class="line">  <span class="selector-tag">body</span> &#123;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">12pt</span>;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">1188.6pt</span>;</span><br><span class="line">    <span class="attribute">left</span>: -<span class="number">188pt</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>常用</category>
        <category>常用方法</category>
      </categories>
      <tags>
        <tag>js</tag>
      </tags>
  </entry>
  <entry>
    <title>小程序轮播图</title>
    <url>/2020/09/04/%E5%B0%8F%E7%A8%8B%E5%BA%8F%E8%BD%AE%E6%92%AD%E5%9B%BE/</url>
    <content><![CDATA[<p><img src="https://cdn.jsdelivr.net/gh/liebexiao/myImgs/20200904214927.png" alt=""></p>
<a id="more"></a>

<h4 id="1、wxml"><a href="#1、wxml" class="headerlink" title="1、wxml"></a>1、wxml</h4><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 顶部图片 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"page-section page-section-spacing swiper"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">swiper</span></span></span><br><span class="line"><span class="tag">    <span class="attr">class</span>=<span class="string">"top_img_box"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">indicator-dots</span>=<span class="string">"&#123;&#123;indicatorDots&#125;&#125;"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">autoplay</span>=<span class="string">"&#123;&#123;autoplay&#125;&#125;"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">interval</span>=<span class="string">"&#123;&#123;interval&#125;&#125;"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">duration</span>=<span class="string">"&#123;&#123;duration&#125;&#125;"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">indicator-active-color</span>=<span class="string">"#fff"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">block</span> <span class="attr">wx:for</span>=<span class="string">"&#123;&#123;topImg&#125;&#125;"</span> <span class="attr">wx:key</span>=<span class="string">"*this"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">swiper-item</span> <span class="attr">bindtap</span>=<span class="string">"toNewsDetail"</span> <span class="attr">data-newsId</span>=<span class="string">"&#123;&#123;item.newsId&#125;&#125;"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"swiper_title"</span>&gt;</span>&#123;&#123;item.news_title&#125;&#125;<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">image</span> <span class="attr">class</span>=<span class="string">"top_img"</span> <span class="attr">src</span>=<span class="string">"&#123;&#123;item.url&#125;&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">image</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">swiper-item</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">block</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">swiper</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="2、data"><a href="#2、data" class="headerlink" title="2、data"></a>2、data</h4><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">topImg: [&#123;</span><br><span class="line">     url: <span class="string">'http://oss.jishiyoo.com/images/file-1597116272428.jpg'</span>,</span><br><span class="line">     newsId: <span class="number">1</span>,</span><br><span class="line">     news_title: <span class="string">'title'</span>,</span><br><span class="line">&#125;],</span><br><span class="line">indicatorDots: <span class="literal">true</span>, <span class="comment">//指示点</span></span><br><span class="line">vertical: <span class="literal">false</span>, <span class="comment">//滑动方向是否为纵向</span></span><br><span class="line">autoplay: <span class="literal">false</span>, <span class="comment">//是否自动切换</span></span><br><span class="line">interval: <span class="number">2000</span>, <span class="comment">//自动切换时间间隔</span></span><br><span class="line">duration: <span class="number">500</span>, <span class="comment">//滑动动画时长</span></span><br></pre></td></tr></table></figure>

<h4 id="3、css"><a href="#3、css" class="headerlink" title="3、css"></a>3、css</h4><figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* 轮播图 */</span></span><br><span class="line"><span class="selector-class">.top_img_box</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">420</span>rpx;</span><br><span class="line">  <span class="attribute">position</span>: relative;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.top_img</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">object-fit</span>: contain;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.swiper_title</span> &#123;</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="attribute">bottom</span>: <span class="number">0</span>rpx;</span><br><span class="line">  <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">right</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#000</span>;</span><br><span class="line">  <span class="attribute">opacity</span>: <span class="number">0.6</span>;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#fff</span>;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">10</span>rpx <span class="number">20</span>rpx <span class="number">36</span>rpx;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>wx小程序</category>
      </categories>
      <tags>
        <tag>wxml、js</tag>
      </tags>
  </entry>
  <entry>
    <title>常用Markdown语法</title>
    <url>/2020/05/29/%E5%B8%B8%E7%94%A8Markdown%E8%AF%AD%E6%B3%95/</url>
    <content><![CDATA[<p>这篇主要来记录我初步建立 markdown 文章一些基本操作。</p>
<p><img src="https://cdn.jsdelivr.net/gh/liebexiao/myImgs/20200717172953.png" alt=""></p>
<a id="more"></a>

<h2 id="新建page"><a href="#新建page" class="headerlink" title="新建page"></a>新建page</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">hexo new page-name</span><br></pre></td></tr></table></figure>


<h3 id="一、标题"><a href="#一、标题" class="headerlink" title="一、标题"></a>一、标题</h3><p>一级标题前面一个#，二级标题前面两个#，以此类推，总共到六级标题，#与文字之间一定要有空格。</p>
<h3 id="二、代码块"><a href="#二、代码块" class="headerlink" title="二、代码块"></a>二、代码块</h3><p>用前后 三个` 包裹着, ```后面写什么语言即展示怎样的高亮样式，例如：html、javascript</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">""</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="行内代码"><a href="#行内代码" class="headerlink" title="行内代码"></a>行内代码</h4><p>前后一个 ` 包裹，例：</p>
<p><code>行内代码</code></p>
<h3 id="三、引用"><a href="#三、引用" class="headerlink" title="三、引用"></a>三、引用</h3><p>使用 &gt; 表示引用， &gt;&gt; 表示引用里面再套一层引用，依次类推。</p>
<blockquote>
<p>‘&gt;’这是一级引用</p>
<blockquote>
<p>‘&gt;&gt;’这是二级引用</p>
<blockquote>
<p>‘&gt;&gt;&gt;’这是三级引用</p>
</blockquote>
</blockquote>
</blockquote>
<h3 id="四、链接"><a href="#四、链接" class="headerlink" title="四、链接"></a>四、链接</h3><p>使用 “ <a href="link"> </a> ” 表示行内链接。其中：</p>
<p>[] 内的内容为要添加链接的文字。</p>
<p>link 为链接地址。例如：<a href="https://www.baidu.com" target="_blank" rel="noopener">百度</a></p>
<blockquote>
<p>[ 百度 ] (<a href="https://www.baidu.com" target="_blank" rel="noopener">https://www.baidu.com</a>)</p>
</blockquote>
<h3 id="五、导入图片"><a href="#五、导入图片" class="headerlink" title="五、导入图片"></a>五、导入图片</h3><p>使用 “ ![Alt text] (png) ” 导入图片。其中：</p>
<p>Alt text 为如果图片无法显示时显示的文字；<br>png 为图片所在路径；<br>本地引用是图片直接存储到本地通过相对路径引用，无需网络连接<br>上传图片将把图片上传至图床，这样在文档或图片移动时认可访问图片<br>示例：<br><img src="https://fech.in/static/images/cover/ml01-overview.jpeg" alt="图片无法显示时显示的文字"></p>
<h3 id="六、Todo-List"><a href="#六、Todo-List" class="headerlink" title="六、Todo List"></a>六、Todo List</h3><p>小写 x 表示已完成， 空格表示未完成</p>
<ul>
<li><input checked="" disabled="" type="checkbox"> 选中</li>
<li><input disabled="" type="checkbox"> 未选中<br>方法：<blockquote>
<p>-与[]之间须有空格 -[x] 例 1 -[ ] 例 2</p>
</blockquote>
</li>
</ul>
<h3 id="七、粗体，斜体，高亮和删除线"><a href="#七、粗体，斜体，高亮和删除线" class="headerlink" title="七、粗体，斜体，高亮和删除线"></a>七、粗体，斜体，高亮和删除线</h3><p>例如<strong>粗体</strong></p>
<blockquote>
<p>** 粗体示例 **</p>
</blockquote>
<p><em>斜体</em></p>
<blockquote>
<p>*斜体 *</p>
</blockquote>
<p><strong><em>粗加斜体</em></strong></p>
<blockquote>
<p><strong>* 粗加斜体 *</strong></p>
</blockquote>
<blockquote>
<p>==高亮==<br>部分编辑器不支持高亮</p>
</blockquote>
<p><del>删除线</del></p>
<blockquote>
<p><del>~ 删除线 ~</del></p>
</blockquote>
<h3 id="八、列表"><a href="#八、列表" class="headerlink" title="八、列表"></a>八、列表</h3><p>使用 1. 1. 1. 表示有序列表，使用 * 或 - 或 + 表示无序列表。</p>
<ol>
<li>列表一</li>
<li>列表二</li>
<li>列表三</li>
</ol>
<blockquote>
<p>1.列表一 1.列表二 1.列表三<br>记得 1. 与列表文字之间需要有空格</p>
</blockquote>
<ul>
<li>1 列表一<ul>
<li>2 列表二</li>
</ul>
</li>
</ul>
<blockquote>
<p>*1 列表一<br>*2 列表二<br>二级列表需要缩进一个字符</p>
</blockquote>
<h3 id="九、分割线"><a href="#九、分割线" class="headerlink" title="九、分割线"></a>九、分割线</h3><p>分割线：— 或者*** 自动出来分割线</p>
<hr>
<h3 id="十、emoji"><a href="#十、emoji" class="headerlink" title="十、emoji"></a>十、emoji</h3><p>使用 :emoji代码: 在 markdown 里添加 emoji 😲</p>
<p><a href="https://www.webfx.com/tools/emoji-cheat-sheet/" target="_blank" rel="noopener">点击这里查看所有支持的 emoji 代码</a></p>
<p>❗ 部分编辑器不支持 emoji code </p>
<p>建议直接输入 emoji，<a href="https://www.emojidaquan.com" target="_blank" rel="noopener">点击这里查看并复制 emoji</a></p>
]]></content>
      <categories>
        <category>markdown</category>
      </categories>
      <tags>
        <tag>markdown</tag>
      </tags>
  </entry>
  <entry>
    <title>拖拽排序</title>
    <url>/2020/07/14/%E6%8B%96%E6%8B%BD%E6%8E%92%E5%BA%8F/</url>
    <content><![CDATA[<p><img src="https://cdn.jsdelivr.net/gh/liebexiao/myImgs/20200717170003.png" alt=""></p>
<a id="more"></a>

<h3 id="安装引用"><a href="#安装引用" class="headerlink" title="安装引用"></a>安装引用</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">cnpm install awe-dnd --save</span><br><span class="line"></span><br><span class="line"><span class="comment">//在main.js中全局引用;</span></span><br><span class="line"><span class="keyword">import</span> VueDND <span class="keyword">from</span> <span class="string">"awe-dnd"</span>;</span><br><span class="line">Vue.use(VueDND);</span><br></pre></td></tr></table></figure>

<h4 id="1、基础使用"><a href="#1、基础使用" class="headerlink" title="1、基础使用"></a>1、基础使用</h4><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span></span></span><br><span class="line"><span class="tag">  <span class="attr">class</span>=<span class="string">"color-item"</span></span></span><br><span class="line"><span class="tag">  <span class="attr">v-for</span>=<span class="string">"color in colors"</span></span></span><br><span class="line"><span class="tag">  <span class="attr">v-dragging</span>=<span class="string">"&#123; item: color, list: colors, group: 'color' &#125;"</span></span></span><br><span class="line"><span class="tag">  <span class="attr">:key</span>=<span class="string">"color.text"</span></span></span><br><span class="line"><span class="tag">&gt;</span></span><br><span class="line">  &#123;&#123;color.text&#125;&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">mounted () &#123;</span><br><span class="line">   <span class="keyword">this</span>.$dragging.$on(<span class="string">'dragged'</span>, (&#123; value &#125;) =&gt; &#123;</span><br><span class="line">     <span class="built_in">console</span>.log(value.item)</span><br><span class="line">     <span class="built_in">console</span>.log(value.list)</span><br><span class="line">     <span class="built_in">console</span>.log(value.otherData)</span><br><span class="line">   &#125;)</span><br><span class="line">   <span class="keyword">this</span>.$dragging.$on(<span class="string">'dragend'</span>, () =&gt; &#123;</span><br><span class="line"></span><br><span class="line">   &#125;)</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>

<h4 id="2、嵌套列表排序使用"><a href="#2、嵌套列表排序使用" class="headerlink" title="2、嵌套列表排序使用"></a>2、嵌套列表排序使用</h4><p>只有在html这个地方有区别，其他使用均相同</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span></span></span><br><span class="line"><span class="tag">  <span class="attr">class</span>=<span class="string">"select"</span></span></span><br><span class="line"><span class="tag">  <span class="attr">v-for</span>=<span class="string">"(item2,index2) in item.volunteerMajor"</span></span></span><br><span class="line"><span class="tag">  <span class="attr">:key</span>=<span class="string">"index2"</span></span></span><br><span class="line"><span class="tag">  <span class="attr">v-dragging</span>=<span class="string">"&#123; item: item2, list: item.volunteerMajor, group: 'name'+index&#125;"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>vue</category>
        <category>组件</category>
      </categories>
      <tags>
        <tag>vue</tag>
      </tags>
  </entry>
  <entry>
    <title>引入vant-weapp组件</title>
    <url>/2020/08/24/%E5%BC%95%E5%85%A5vant-weapp%E7%BB%84%E4%BB%B6/</url>
    <content><![CDATA[<img src="https://s1.ax1x.com/2020/08/24/dynp9I.png" alt="dynp9I.png" style="zoom:50%;" />

<a id="more"></a>

<p>从小程序基础库版本 <a href="https://developers.weixin.qq.com/miniprogram/dev/framework/compatibility.html" target="_blank" rel="noopener">2.2.1</a> 或以上、及<a href="https://developers.weixin.qq.com/miniprogram/dev/devtools/download.html" target="_blank" rel="noopener">开发者工具</a> 1.02.1808300 或以上开始，小程序支持使用 npm 安装第三方包。</p>
<p>直接创建小程序，从 <strong>工具&gt;构建npm</strong>，会弹出没有找到node_modules目录，因此以引入vant组件为例。</p>
<p><img src="https://s1.ax1x.com/2020/08/24/dyeEM8.png" alt=""></p>
<h4 id="1、打开使用npm模块。"><a href="#1、打开使用npm模块。" class="headerlink" title="1、打开使用npm模块。"></a>1、打开使用npm模块。</h4><p>创建普通项目后在右上角详情中，打开使用npm模块。</p>
<p><img src="https://s1.ax1x.com/2020/08/24/dyeUo9.png" alt="dyeUo9.png"></p>
<p><img src="https://s1.ax1x.com/2020/08/24/dyeyLD.png" alt="dyeyLD.png"></p>
<h4 id="2、安装vant组件"><a href="#2、安装vant组件" class="headerlink" title="2、安装vant组件"></a>2、安装vant组件</h4><h5 id="鼠标放在目录上右键，打开终端，切换到根目录"><a href="#鼠标放在目录上右键，打开终端，切换到根目录" class="headerlink" title="鼠标放在目录上右键，打开终端，切换到根目录"></a>鼠标放在<strong>目录上右键，打开终端，切换到根目录</strong></h5><p><img src="https://s1.ax1x.com/2020/08/24/dyexS0.png" alt="dyexS0.png"></p>
<h5 id="直接使用npm安装vant组件-使用淘宝镜像安装速度更快"><a href="#直接使用npm安装vant组件-使用淘宝镜像安装速度更快" class="headerlink" title="直接使用npm安装vant组件(使用淘宝镜像安装速度更快)"></a>直接使用npm安装vant组件(使用<strong>淘宝镜像</strong>安装速度更快)</h5><p>根据vant官方文档更新 ，安装有某些改动。</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">cnpm i @vant/weapp -S --production</span><br></pre></td></tr></table></figure>

<h4 id="3、构建"><a href="#3、构建" class="headerlink" title="3、构建"></a>3、构建</h4><p>安装成功后，点开 <strong>工具&gt;构建npm ，，</strong>此时提示构建完成 。。完成构建（如果控制台出现报错，再构建一次即可）。</p>
<p>此时硬盘中已经存在node_modules目录，只是开发工具默认隐藏了</p>
<p><img src="https://s1.ax1x.com/2020/08/24/dym71x.png" alt="dym71x.png"></p>
<h4 id="4、使用"><a href="#4、使用" class="headerlink" title="4、使用"></a>4、使用</h4><p> 在需要用到的 <strong>.json</strong> 文件中引入对应的vant路径</p>
<p>例如：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="string">"usingComponents"</span>: &#123;</span><br><span class="line">   <span class="string">"van-loading"</span>: <span class="string">"@vant/weapp/loading/index"</span></span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>wx小程序</category>
      </categories>
      <tags>
        <tag>配置</tag>
      </tags>
  </entry>
  <entry>
    <title>瀑布流</title>
    <url>/2020/07/22/%E7%80%91%E5%B8%83%E6%B5%81/</url>
    <content><![CDATA[<p><img src="http://oss.jishiyoo.com/images/file-1595692086675.png" alt=""></p>
<a id="more"></a>

<h3 id="一、思路"><a href="#一、思路" class="headerlink" title="一、思路"></a>一、思路</h3><blockquote>
<p>宽固定高不固定，（见缝插针）</p>
</blockquote>
<ul>
<li><p>求出列数 <strong>columnNum</strong>（浏览器宽度/图片宽度）;</p>
</li>
<li><p>将第一行高度存入数组 <strong>srcArr</strong>（即循环图片数组 <strong>imgsArr</strong>，取出索引值小于列数<strong>columnNum</strong>的值）;</p>
</li>
<li><p>对非第一行图片进行定位；</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">position</span>: "<span class="selector-tag">absolute</span>";</span><br><span class="line"><span class="selector-tag">left</span>: 索引值 * 图片宽度;</span><br><span class="line"><span class="selector-tag">top</span>: 最小图片高度;</span><br></pre></td></tr></table></figure>
</li>
<li><p>高度追加。</p>
</li>
</ul>
<h3 id="二、过程"><a href="#二、过程" class="headerlink" title="二、过程"></a>二、过程</h3><h4 id="1、html"><a href="#1、html" class="headerlink" title="1、html"></a>1、html</h4><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"img_box clearfix"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">img</span></span></span><br><span class="line"><span class="tag">    <span class="attr">class</span>=<span class="string">"img_src"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">v-for</span>=<span class="string">"(item,index) in imgsArr"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">:key</span>=<span class="string">"index"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">:src</span>=<span class="string">"item.src"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">:style</span>=<span class="string">"item.leftNum?&#123;position:'absolute',left:item.leftNum+'px',top:item.topNum+'px'&#125;:''"</span></span></span><br><span class="line"><span class="tag">  /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="2、css"><a href="#2、css" class="headerlink" title="2、css"></a>2、css</h4><figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.img_src</span> &#123;</span><br><span class="line">  <span class="attribute">float</span>: left;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">300px</span>;</span><br><span class="line">  <span class="attribute">box-sizing</span>: border-box;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">0</span> <span class="number">10px</span> <span class="number">10px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="3、js"><a href="#3、js" class="headerlink" title="3、js"></a>3、js</h4><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">imgsArr:[</span><br><span class="line">                   &#123;</span><br><span class="line">                       <span class="string">"src"</span>: <span class="string">"http://oss.jishiyoo.com/images/file-1595688891434.gif"</span>,</span><br><span class="line">                       <span class="string">"href"</span>: <span class="string">"https://www.baidu.com"</span>,</span><br><span class="line">                       <span class="string">"info"</span>: <span class="string">"一些图片描述文字"</span></span><br><span class="line">                   &#125;,</span><br><span class="line"></span><br><span class="line">                   &#123;</span><br><span class="line">                       <span class="string">"src"</span>: <span class="string">"http://oss.jishiyoo.com/images/file-1595688911105.jpg"</span>,</span><br><span class="line">                       <span class="string">"href"</span>: <span class="string">"https://www.baidu.com"</span>,</span><br><span class="line">                       <span class="string">"info"</span>: <span class="string">"一些图片描述文字"</span></span><br><span class="line">                   &#125;,</span><br><span class="line">    <span class="comment">//此处省略图片</span></span><br><span class="line">               ],</span><br></pre></td></tr></table></figure>

<p>当开始其中两个图片高度相等时，两个高度同时追加，导致瀑布流展示不出。<img src="http://oss.jishiyoo.com/images/file-1595693102630.png" alt="">。</p>
<p>此时用 map 循环不能跳出循环，用<strong>forEach</strong>，在找到符合条件的值之后跳出循环。</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">waterFall () &#123;</span><br><span class="line">                <span class="keyword">try</span>&#123;</span><br><span class="line">                    <span class="comment">//获取宽度</span></span><br><span class="line">                    <span class="keyword">let</span> windowW = <span class="built_in">window</span>.innerWidth;<span class="comment">//屏幕可视宽度</span></span><br><span class="line">                    <span class="keyword">let</span> imgW = <span class="number">300</span>;<span class="comment">//固定图片宽度</span></span><br><span class="line">                    <span class="keyword">let</span> columnNum = <span class="built_in">parseInt</span>(windowW/ <span class="number">300</span>);<span class="comment">//列数</span></span><br><span class="line">                    <span class="comment">// console.log('columnNum：' + columnNum);</span></span><br><span class="line">                    <span class="comment">//定义数组,将图片的高度存如数组中。</span></span><br><span class="line">                    <span class="keyword">let</span> srcArr = [];</span><br><span class="line">                    <span class="keyword">this</span>.imgsArr.map(<span class="function">(<span class="params">v, i</span>) =&gt;</span> &#123;</span><br><span class="line">                        <span class="keyword">let</span> heightArray = <span class="keyword">new</span> Image();</span><br><span class="line">                        heightArray.src = v.src;</span><br><span class="line">                        heightArray.onload = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">                            <span class="keyword">let</span> height = heightArray.height;<span class="comment">//图片原始高度</span></span><br><span class="line">                            <span class="keyword">let</span> width = heightArray.width;<span class="comment">//图片原始宽度</span></span><br><span class="line">                            <span class="keyword">let</span> imgHeight = <span class="built_in">parseInt</span>((<span class="number">300</span> / width) * height);<span class="comment">//图片压缩后的高度</span></span><br><span class="line">                            <span class="comment">//console.log('imgHeight：'+imgHeight)</span></span><br><span class="line">                            <span class="comment">// console.log('height'+height)</span></span><br><span class="line">                            <span class="keyword">if</span> (i &lt; columnNum) &#123;</span><br><span class="line">                                <span class="comment">//将第一排图片高度存入数组中</span></span><br><span class="line">                                srcArr.push(imgHeight);</span><br><span class="line">                            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                                <span class="comment">//对非第一排进行定位处理</span></span><br><span class="line">                                <span class="comment">//left=最小的索引*宽度；；top=最小图片高度</span></span><br><span class="line">                                <span class="comment">// v.topNum=srcArr.sort((a,b)=&gt;a-b)[0];//方法1</span></span><br><span class="line">                                v.topNum = (<span class="built_in">Math</span>.min(...srcArr));<span class="comment">//方法2</span></span><br><span class="line">                                <span class="built_in">console</span>.log(srcArr)</span><br><span class="line">                                <span class="comment">/*srcArr.map((v2, i2) =&gt; &#123;</span></span><br><span class="line"><span class="comment">                                    if (v2 == v.topNum) &#123;</span></span><br><span class="line"><span class="comment">                                        v.leftNum = i2 * 300 + 140;</span></span><br><span class="line"><span class="comment">                                        //高度追加</span></span><br><span class="line"><span class="comment">                                        srcArr[i2] += imgHeight;</span></span><br><span class="line"><span class="comment">                                    &#125;</span></span><br><span class="line"><span class="comment">                                &#125;)*/</span></span><br><span class="line">                                srcArr.forEach(<span class="function">(<span class="params">v2, i2</span>) =&gt;</span> &#123;</span><br><span class="line">                                    <span class="keyword">if</span> (v2 == v.topNum) &#123;</span><br><span class="line">                                        v.leftNum = i2 * <span class="number">300</span>;</span><br><span class="line">                                        <span class="comment">//高度追加</span></span><br><span class="line">                                        srcArr[i2] += imgHeight;</span><br><span class="line">                                        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">"追加完成跳出"</span>)</span><br><span class="line">                                    &#125;</span><br><span class="line">                                &#125;)</span><br><span class="line"></span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;;</span><br><span class="line">                        <span class="comment">// console.log(this.imgsArr)</span></span><br><span class="line">                    &#125;)</span><br><span class="line">                &#125;<span class="keyword">catch</span> (e) &#123;</span><br><span class="line">                    <span class="built_in">console</span>.log(e)</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            &#125;,</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>vue</category>
        <category>原生</category>
      </categories>
      <tags>
        <tag>vue</tag>
      </tags>
  </entry>
  <entry>
    <title>授权、获取信息</title>
    <url>/2020/08/24/%E6%8E%88%E6%9D%83%E3%80%81%E8%8E%B7%E5%8F%96%E4%BF%A1%E6%81%AF/</url>
    <content><![CDATA[<p><img src="https://s1.ax1x.com/2020/08/24/dyQVs0.png" alt=""></p>
<a id="more"></a>

<h3 id="一、登录"><a href="#一、登录" class="headerlink" title="一、登录"></a>一、登录</h3><p>在 <strong>app.js</strong> 的 <strong>onLaunch</strong> 中调用login接口，并将返回参数（包含<strong><em>openid</em></strong> ）存入缓存  <strong><em>userInfo</em></strong>：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 登录</span></span><br><span class="line">    wx.login(&#123;</span><br><span class="line">      success: <span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="comment">// console.log(res)</span></span><br><span class="line">        <span class="comment">// 发送 res.code 到后台换取 openId, sessionKey, unionId</span></span><br><span class="line">        <span class="keyword">let</span> obj=&#123;</span><br><span class="line">          code:res.code</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">this</span>.ajaxRequest(<span class="string">"/api"</span>, <span class="string">"post"</span>, obj).then(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">          <span class="comment">// console.log(res);</span></span><br><span class="line">          <span class="keyword">let</span> data = res.data.data;</span><br><span class="line">          <span class="comment">// console.log(data)</span></span><br><span class="line">          wx.setStorageSync(<span class="string">'userInfo'</span>, data);</span><br><span class="line">        &#125;)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br></pre></td></tr></table></figure>

<h3 id="二、授权、获取用户信息"><a href="#二、授权、获取用户信息" class="headerlink" title="二、授权、获取用户信息"></a>二、授权、获取用户信息</h3><h4 id="1、授权并获取信息"><a href="#1、授权并获取信息" class="headerlink" title="1、授权并获取信息"></a>1、授权并获取信息</h4><p>授权只能绑定在button上才能完成。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;button open-type&#x3D;&quot;getUserInfo&quot; bindgetuserinfo&#x3D;&quot;bindGetUserInfo&quot;&gt;&lt;&#x2F;button&gt;</span><br></pre></td></tr></table></figure>

<p>获取授权信息，当用户同意或不同意授权是的操作；</p>
<p>在用户同意已经授权之后获取到用户昵称、头像等信息，根据需求存入缓存。</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//获取授权信息</span></span><br><span class="line">  bindGetUserInfo(e) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(e)</span><br><span class="line">    <span class="keyword">let</span> that = <span class="keyword">this</span>;</span><br><span class="line">    <span class="built_in">console</span>.log(e.detail)</span><br><span class="line">    <span class="keyword">let</span> encryptedData = e.detail.encryptedData;</span><br><span class="line">    <span class="keyword">let</span> iv = e.detail.iv;</span><br><span class="line">    <span class="keyword">if</span> (iv == <span class="literal">undefined</span>) &#123;</span><br><span class="line">      wx.showToast(&#123;</span><br><span class="line">        title: <span class="string">'请先同意微信授权~'</span>,</span><br><span class="line">        icon: <span class="string">'none'</span>,</span><br><span class="line">        duration: <span class="number">1500</span></span><br><span class="line">      &#125;)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="comment">// 查看是否授权</span></span><br><span class="line">      wx.getSetting(&#123;</span><br><span class="line">        success(res) &#123;</span><br><span class="line">          <span class="keyword">if</span> (res.authSetting[<span class="string">'scope.userInfo'</span>]) &#123;</span><br><span class="line">            <span class="comment">// 已经授权，可以直接调用 getUserInfo 获取头像昵称</span></span><br><span class="line">            wx.getUserInfo(&#123;</span><br><span class="line">              success: <span class="function"><span class="keyword">function</span> (<span class="params">res</span>) </span>&#123;</span><br><span class="line">                <span class="comment">// console.log(res.userInfo);</span></span><br><span class="line">                wx.setStorageSync(<span class="string">'userMessage'</span>, res.userInfo);</span><br><span class="line">                that.setData(&#123;</span><br><span class="line">                  userMessage: res.userInfo</span><br><span class="line">                &#125;)</span><br><span class="line">              &#125;</span><br><span class="line">            &#125;)</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br></pre></td></tr></table></figure>

<h4 id="2、在app-js中获取用户信息"><a href="#2、在app-js中获取用户信息" class="headerlink" title="2、在app.js中获取用户信息"></a>2、在app.js中获取用户信息</h4><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 获取用户信息</span></span><br><span class="line">    wx.getSetting(&#123;</span><br><span class="line">      success: <span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (res.authSetting[<span class="string">'scope.userInfo'</span>]) &#123;</span><br><span class="line">          <span class="comment">// 已经授权，可以直接调用 getUserInfo 获取头像昵称，不会弹框</span></span><br><span class="line">          wx.getUserInfo(&#123;</span><br><span class="line">            success: <span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">              <span class="comment">// console.log(res)</span></span><br><span class="line">              <span class="comment">// 可以将 res 发送给后台解码出 unionId</span></span><br><span class="line">              <span class="keyword">this</span>.globalData.userInfo = res.userInfo</span><br><span class="line">              wx.setStorageSync(<span class="string">'userMessage'</span>, res.userInfo);</span><br><span class="line">              <span class="comment">// 由于 getUserInfo 是网络请求，可能会在 Page.onLoad 之后才返回</span></span><br><span class="line">              <span class="comment">// 所以此处加入 callback 以防止这种情况</span></span><br><span class="line">              <span class="keyword">if</span> (<span class="keyword">this</span>.userInfoReadyCallback) &#123;</span><br><span class="line">                <span class="keyword">this</span>.userInfoReadyCallback(res)</span><br><span class="line">              &#125;</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>wx小程序</category>
      </categories>
      <tags>
        <tag>js</tag>
      </tags>
  </entry>
  <entry>
    <title>弹幕</title>
    <url>/2020/07/15/%E5%BC%B9%E5%B9%95/</url>
    <content><![CDATA[<p><img src="https://cdn.jsdelivr.net/gh/liebexiao/myImgs/20200717170351.png" alt=""></p>
<a id="more"></a>

<p><a href="https://github.com/superhos/vue-baberrage#readme" target="_blank" rel="noopener">弹幕源码</a></p>
<h3 id="一、使用"><a href="#一、使用" class="headerlink" title="一、使用"></a><strong>一、使用</strong></h3><h4 id="1、安装引用"><a href="#1、安装引用" class="headerlink" title="1、安装引用"></a>1、安装引用</h4><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">cnpm install vue-baberrage</span><br><span class="line"><span class="keyword">import</span> &#123; vueBaberrage &#125; <span class="keyword">from</span> <span class="string">'vue-baberrage'</span></span><br><span class="line">Vue.use(vueBaberrage)</span><br></pre></td></tr></table></figure>

<h4 id="2、html"><a href="#2、html" class="headerlink" title="2、html"></a>2、html</h4><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--弹幕--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"barrages-drop"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">vue-baberrage</span></span></span><br><span class="line"><span class="tag">    <span class="attr">:isShow</span>=<span class="string">"barrageIsShow"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">:barrageList</span>=<span class="string">"barrageList"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">:maxWordCount</span>=<span class="string">"maxWordCount"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">:throttleGap</span>=<span class="string">"throttleGap"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">:loop</span>=<span class="string">"barrageLoop"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">:boxHeight</span>=<span class="string">"boxHeight"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">:messageHeight</span>=<span class="string">"messageHeight"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">:lanesCount</span>=<span class="string">"2"</span></span></span><br><span class="line"><span class="tag">    @<span class="attr">barrage-list-empty</span>=<span class="string">"getUserBuyList"</span></span></span><br><span class="line"><span class="tag">  &gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">vue-baberrage</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="3、变量"><a href="#3、变量" class="headerlink" title="3、变量"></a>3、变量</h4><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">this</span>.userBuyList = [</span><br><span class="line">  &#123; <span class="attr">avatar</span>: <span class="string">""</span>, <span class="attr">nickname</span>: <span class="string">"超"</span> &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    avatar:</span><br><span class="line">      <span class="string">"http://thirdwx.qlogo.cn/mmopen/vi_32/eU2DIpM10gpXSfjr42QKtgTF3UatMA8uQNCTOfnl8b0bU6rhH3m619X8c0WfcZLuywPz685DjvlAvA2diaKLlfg/132"</span>,</span><br><span class="line">    nickname: <span class="string">"晓"</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    avatar:</span><br><span class="line">      <span class="string">"http://thirdwx.qlogo.cn/mmopen/vi_32/eU2DIpM10gpXSfjr42QKtgTF3UatMA8uQNCTOfnl8b0bU6rhH3m619X8c0WfcZLuywPz685DjvlAvA2diaKLlfg/132"</span>,</span><br><span class="line">    nickname: <span class="string">"晓"</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123; <span class="attr">avatar</span>: <span class="string">""</span>, <span class="attr">nickname</span>: <span class="string">"超m"</span> &#125;,</span><br><span class="line">];</span><br></pre></td></tr></table></figure>

<h4 id="4、js"><a href="#4、js" class="headerlink" title="4、js"></a>4、js</h4><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*弹幕</span></span><br><span class="line"><span class="comment">            * */</span></span><br><span class="line">            addToList() &#123;</span><br><span class="line">                <span class="keyword">this</span>.userBuyList.map(<span class="function">(<span class="params">v2, i2</span>) =&gt;</span> &#123;</span><br><span class="line">                    v2.userBuyId = i2;</span><br><span class="line">                    <span class="keyword">this</span>.barrageList.push(&#123;</span><br><span class="line">                        id: v2.userBuyId,</span><br><span class="line">                        avatar: v2.avatar,</span><br><span class="line">                        msg: v2.nickname + <span class="string">'已购买'</span>,</span><br><span class="line">                        time: <span class="number">4</span>,</span><br><span class="line">                        type: MESSAGE_TYPE.NORMAL,</span><br><span class="line">                        <span class="comment">// barrageStyle: v.barrageStyle</span></span><br><span class="line">                    &#125;);</span><br><span class="line">                &#125;);</span><br><span class="line"></span><br><span class="line">            &#125;,</span><br></pre></td></tr></table></figure>

<h3 id="Plugin-Options"><a href="#Plugin-Options" class="headerlink" title="Plugin Options"></a><strong>Plugin Options</strong></h3><blockquote>
<p>1、isShow</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">- Default: &#96;true&#96;</span><br><span class="line">- Acceptable-Values: Boolean</span><br><span class="line">- Function: 是否显示弹幕</span><br></pre></td></tr></table></figure>

<blockquote>
<p>2、barrageList</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">- Default: &#96;[]&#96;</span><br><span class="line">- Acceptable-Values: Array</span><br><span class="line">- Function: 弹幕数据列表</span><br></pre></td></tr></table></figure>

<blockquote>
<p>3、boxWidth</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">- Default: &#96;parent&#39;s Width&#96;</span><br><span class="line">- Acceptable-Values: Number</span><br><span class="line">- Function: 显示弹幕区域的宽度</span><br></pre></td></tr></table></figure>

<blockquote>
<p>4、boxHeight</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">- Default: &#96;window&#39;s Height&#96;</span><br><span class="line">- Acceptable-Values: Number</span><br><span class="line">- Function: 显示弹幕区域的高度</span><br></pre></td></tr></table></figure>

<blockquote>
<p>5、messageHeight</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">- Default: &#96;message&#39;s Height&#96;</span><br><span class="line">- Acceptable-Values: Number</span><br><span class="line">- Function: 弹幕高度</span><br></pre></td></tr></table></figure>

<blockquote>
<p>6、maxWordCount</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">- Default: &#96;60&#96;</span><br><span class="line">- Acceptable-Values: Number</span><br><span class="line">- Function: 弹幕最大字数长度，超过则忽略（中文占2长度，英文占1长度）</span><br></pre></td></tr></table></figure>

<blockquote>
<p>7、loop</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">- Default: &#96;false&#96;</span><br><span class="line">- Acceptable-Values: Boolean</span><br><span class="line">- Function: 是否循环</span><br></pre></td></tr></table></figure>

<blockquote>
<p>8、throttleGap</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">- Default: 2000</span><br><span class="line">- Acceptable-Values: Number</span><br><span class="line">- Function: 弹幕之间的节流时间</span><br></pre></td></tr></table></figure>

<blockquote>
<p>9、posRender</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">- Default: null</span><br><span class="line">- Acceptable-Values: Function</span><br><span class="line">- Function: 自定义弹幕显示的泳道</span><br><span class="line">- Return: 需要返回泳道的索引</span><br></pre></td></tr></table></figure>

<blockquote>
<p>10、lanesCount</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">- Default: 0</span><br><span class="line">- Acceptable-Values: Number</span><br><span class="line">- Function: 泳道的数量。</span><br></pre></td></tr></table></figure>

<h3 id="弹幕数据选项"><a href="#弹幕数据选项" class="headerlink" title="弹幕数据选项"></a><strong>弹幕数据选项</strong></h3><blockquote>
<p>1、id</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">- Default: &#96;null&#96;</span><br><span class="line">- Acceptable-Values: Number</span><br><span class="line">- Function: 用以区分每条弹幕</span><br></pre></td></tr></table></figure>

<blockquote>
<p>2、avatar</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">- Default: &#96;#&#96;</span><br><span class="line">- Acceptable-Values: String</span><br><span class="line">- Function: 弹幕的头像</span><br></pre></td></tr></table></figure>

<blockquote>
<p>3、msg</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">- Default: &#96;null&#96;</span><br><span class="line">- Acceptable-Values: String</span><br><span class="line">- Function: 弹幕内容</span><br></pre></td></tr></table></figure>

<blockquote>
<p>4、barrageStyle</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">- Default: &#96;normal&#96;</span><br><span class="line">- Acceptable-Values: String</span><br><span class="line">- Function: 额外的弹幕的样式</span><br></pre></td></tr></table></figure>

<blockquote>
<p>5、time</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">- Default: &#96;10&#96;</span><br><span class="line">- Acceptable-Values: Number</span><br><span class="line">- Function: 弹幕展示的时间（单位：秒）</span><br></pre></td></tr></table></figure>

<blockquote>
<p>6、type</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">- Default: MESSAGE_TYPE.NORMAL</span><br><span class="line">- Acceptable-Values: Symbol</span><br><span class="line">- Function: 弹幕的类型</span><br><span class="line">MESSAGE_TYPE.NORMAL ： 正常从右到左滚动</span><br><span class="line">MESSAGE_TYPE.FROM_TOP ： 固定在弹幕区域上方</span><br></pre></td></tr></table></figure>

<blockquote>
<p>7、position</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">- Default: &#96;top&#96;</span><br><span class="line">- Acceptable-Values: Boolean</span><br><span class="line">- Function: 目前为固定值，之后功能更新。</span><br></pre></td></tr></table></figure>

<blockquote>
<p>8、extraWidth</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">- Default: 0</span><br><span class="line">- Acceptable-Values: Number</span><br><span class="line">- Function: 弹幕的额外宽度。</span><br></pre></td></tr></table></figure>

<h3 id="Events"><a href="#Events" class="headerlink" title="Events"></a><strong>Events</strong></h3><p>当 <code>barrageList</code> 为空的时候会调用 <code>barrage-list-empty</code>。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;vue-baberrage</span><br><span class="line">	:is-show&#x3D; &quot;barrageIsShow&quot;</span><br><span class="line">	:barrage-list &#x3D; &quot;barrageList&quot;</span><br><span class="line">	:loop &#x3D; &quot;barrageLoop&quot;</span><br><span class="line">	@barrage-list-empty&#x3D;&quot;sayHi&quot;</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>vue</category>
        <category>组件</category>
      </categories>
      <tags>
        <tag>vue js</tag>
      </tags>
  </entry>
  <entry>
    <title>数据结构与算法</title>
    <url>/2020/09/16/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/</url>
    <content><![CDATA[<p>一些常用算法。</p>
<a id="more"></a>

<h3 id="一、常见算法"><a href="#一、常见算法" class="headerlink" title="一、常见算法"></a>一、常见算法</h3><h4 id="1、冒泡排序"><a href="#1、冒泡排序" class="headerlink" title="1、冒泡排序"></a>1、冒泡排序</h4><ul>
<li>相邻两个元素比较，如果前一个比后一个大，交换位置；</li>
<li>对每一对相邻的元素进行重复工作</li>
<li>重复上述操作直至数组有序。</li>
</ul>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> arr=[<span class="number">8</span>,<span class="number">0</span>,<span class="number">4</span>,<span class="number">6</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">7</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">9</span>];</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fn</span>(<span class="params">arr</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">let</span> len=arr.length;</span><br><span class="line">    <span class="comment">//添加标志位</span></span><br><span class="line">    <span class="keyword">let</span> tip=<span class="literal">true</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//从头开始遍历数组，，如果标志位为true才能执行循环</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">let</span> i=<span class="number">0</span>;i&lt;len &amp;&amp; tip;i++)&#123;</span><br><span class="line">        tip=<span class="literal">false</span>;</span><br><span class="line">        <span class="comment">//比较相邻元素</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">let</span> j=<span class="number">0</span>;j&lt;len<span class="number">-1</span>-i;j++)&#123;</span><br><span class="line">            <span class="comment">//将数组按照升序排序，如果前一个元素大于后一个元素，则交换位置</span></span><br><span class="line">            <span class="comment">//如果是降序，将&gt;换成&lt;即可</span></span><br><span class="line">            <span class="keyword">if</span>(arr[j]&gt;arr[j+<span class="number">1</span>])&#123;</span><br><span class="line">                <span class="keyword">let</span> m=arr[j];</span><br><span class="line">                arr[j]=arr[j+<span class="number">1</span>];</span><br><span class="line">                arr[j+<span class="number">1</span>]=m;</span><br><span class="line">                <span class="comment">//如果有交换，说明数组不是有序的，还需要继续循环</span></span><br><span class="line">                tip=<span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">fn(arr);</span><br></pre></td></tr></table></figure>



<h4 id="2、选择排序"><a href="#2、选择排序" class="headerlink" title="2、选择排序"></a>2、选择排序</h4><ul>
<li>在乱序中查找最小的元素放在第一位</li>
<li>重复上述操作，直至数组有序</li>
</ul>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> arr=[<span class="number">8</span>,<span class="number">0</span>,<span class="number">4</span>,<span class="number">6</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">7</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">9</span>];</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fn</span>(<span class="params">arr</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">let</span> len=arr.length;</span><br><span class="line">    <span class="comment">//定义最小元素坐标</span></span><br><span class="line">    <span class="keyword">let</span> mIndex;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">let</span> i=<span class="number">0</span>;i&lt;len<span class="number">-1</span>;i++)&#123;</span><br><span class="line">        mIndex=i;</span><br><span class="line">        <span class="comment">//遍历查找，如果存在最小元素，则替换最小元素坐标</span></span><br><span class="line">       <span class="keyword">for</span>(<span class="keyword">let</span> j=i+<span class="number">1</span>;j&lt;len;j++)&#123;</span><br><span class="line">           <span class="keyword">if</span>(arr[mIndex]&gt;arr[j])&#123;</span><br><span class="line">               mIndex=j;</span><br><span class="line">           &#125;</span><br><span class="line">       &#125;</span><br><span class="line">        <span class="comment">//找到了最小元素坐标，替换到乱序数组头部。</span></span><br><span class="line">        <span class="keyword">let</span> m=arr[i];</span><br><span class="line">        arr[i]=arr[mIndex];</span><br><span class="line">        arr[mIndex]=m;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="3、快速排序"><a href="#3、快速排序" class="headerlink" title="3、快速排序"></a>3、快速排序</h4><ul>
<li>在待排序数组中找一个基准值；</li>
<li>比这个基准值小的放左边，大的放右边；</li>
<li>重复操作，直至数组有序</li>
</ul>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> arr=[<span class="number">8</span>,<span class="number">0</span>,<span class="number">4</span>,<span class="number">6</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">7</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">9</span>];</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fn</span>(<span class="params">arr</span>)</span>&#123;</span><br><span class="line">    <span class="comment">//如果数组长度&lt;=1，则不需要排序</span></span><br><span class="line">    <span class="keyword">if</span>(arr.length&lt;=<span class="number">1</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> arr;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">let</span> len=arr.length;</span><br><span class="line">    <span class="keyword">let</span> mIndex=Match.floor(arr.length/<span class="number">2</span>);</span><br><span class="line">    <span class="keyword">let</span> mVal=arr[mIndex];</span><br><span class="line">    <span class="keyword">let</span> left=[];</span><br><span class="line">    <span class="keyword">let</span> right=[];</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">let</span> i=<span class="number">0</span>;i&lt;len;i++)&#123;</span><br><span class="line">        <span class="comment">//如果i为基准索引值，跳过操作</span></span><br><span class="line">        <span class="keyword">if</span>(i===mIndex)&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//将小于基准值放入左边数组中，大于的放入右边数组中。</span></span><br><span class="line">        <span class="keyword">if</span>(arr[i]&lt;mVal)&#123;</span><br><span class="line">            left.push(arr[i]);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            right.push(arr[i]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//将数组整合到一起</span></span><br><span class="line">    <span class="keyword">return</span> fn(left).concat([mVal],fn(right));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="4、插入排序"><a href="#4、插入排序" class="headerlink" title="4、插入排序"></a>4、插入排序</h4><ul>
<li>获取一个目标值</li>
<li>从后往前遍历，大于目标值将元素后移一个单位</li>
<li>遇到目标值小于或等于的元素，将目标值放入其后。</li>
</ul>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> arr=[<span class="number">8</span>,<span class="number">0</span>,<span class="number">4</span>,<span class="number">6</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">7</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">9</span>];</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fn</span>(<span class="params">arr</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">let</span> len=arr.length;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">let</span> i=<span class="number">1</span>;i&lt;len;i++)&#123;</span><br><span class="line">        <span class="comment">//获取目标值</span></span><br><span class="line">        <span class="keyword">let</span> mVal=arr[i];</span><br><span class="line">        <span class="comment">//待插入坐标</span></span><br><span class="line">        <span class="keyword">let</span> mIndex;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//从i向前遍历，如果大于目标值，则后移一位</span></span><br><span class="line">        <span class="keyword">for</span>(mIndex=i;mIndex&gt;<span class="number">0</span> &amp;&amp; (arr[mIndex<span class="number">-1</span>]&gt;mVal);mIndex--)&#123;</span><br><span class="line">            arr[mIndex]=arr[mIndex<span class="number">-1</span>];</span><br><span class="line">        &#125;</span><br><span class="line">        arr[mIndex]=mVal;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>常用</category>
        <category>知识点</category>
      </categories>
      <tags>
        <tag>js</tag>
      </tags>
  </entry>
  <entry>
    <title>配置域名</title>
    <url>/2020/08/24/%E9%85%8D%E7%BD%AE%E5%9F%9F%E5%90%8D/</url>
    <content><![CDATA[<p><img src="https://s1.ax1x.com/2020/08/24/dyM93R.png" alt="dyM93R.png"></p>
<a id="more"></a>

<h4 id="1、路径"><a href="#1、路径" class="headerlink" title="1、路径"></a>1、路径</h4><p>开发——开发设置——服务器域名。</p>
<h4 id="2、配置"><a href="#2、配置" class="headerlink" title="2、配置"></a>2、配置</h4><p><img src="https://s1.ax1x.com/2020/08/24/dyAY40.png" alt="dyAY40.png"></p>
]]></content>
      <categories>
        <category>wx小程序</category>
      </categories>
      <tags>
        <tag>配置</tag>
      </tags>
  </entry>
  <entry>
    <title>短信验证</title>
    <url>/2020/07/15/%E7%9F%AD%E4%BF%A1%E9%AA%8C%E8%AF%81/</url>
    <content><![CDATA[<p><img src="https://cdn.jsdelivr.net/gh/liebexiao/myImgs/20200717173419.png" alt=""></p>
<a id="more"></a>

<h4 id="1、html"><a href="#1、html" class="headerlink" title="1、html"></a>1、html</h4><blockquote>
<p>验证码渲染</p>
</blockquote>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"get_code"</span> @<span class="attr">click</span>=<span class="string">"getCode"</span>&gt;</span>&#123;&#123;codeDes&#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="2、定义变量"><a href="#2、定义变量" class="headerlink" title="2、定义变量"></a>2、定义变量</h4><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> isClick = <span class="number">0</span>;<span class="comment">//防连击</span></span><br><span class="line"><span class="keyword">let</span> timeOut = <span class="number">60</span>;</span><br><span class="line">codeDes: <span class="string">'获取验证码'</span>,<span class="comment">//验证码描述</span></span><br><span class="line">codeNum: <span class="number">60</span>,<span class="comment">//验证码时间</span></span><br><span class="line">userphone: <span class="string">''</span>,</span><br><span class="line">usercode: <span class="string">''</span>,</span><br></pre></td></tr></table></figure>

<h4 id="3、js"><a href="#3、js" class="headerlink" title="3、js"></a>3、js</h4><blockquote>
<p> 获取验证码并进行验证</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//点击获取验证码倒计时</span></span><br><span class="line">          getCodeNum() &#123;</span><br><span class="line">              <span class="keyword">let</span> timer = setInterval(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">                  <span class="keyword">this</span>.codeNum--;</span><br><span class="line">                  <span class="keyword">if</span> (<span class="keyword">this</span>.codeNum &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">                      <span class="keyword">this</span>.codeDes = <span class="string">"重新获取验证码"</span>;</span><br><span class="line">                      isClick = <span class="number">0</span>;</span><br><span class="line">                      <span class="keyword">this</span>.codeNum = timeOut;</span><br><span class="line">                      clearInterval(timer);</span><br><span class="line">                  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                      <span class="keyword">this</span>.codeDes = <span class="keyword">this</span>.codeNum + <span class="string">"秒"</span>;</span><br><span class="line">                      isClick = <span class="number">1</span>;</span><br><span class="line">                  &#125;</span><br><span class="line">              &#125;, <span class="number">1000</span>);</span><br><span class="line">          &#125;,</span><br><span class="line"></span><br><span class="line">          <span class="comment">//获取验证码</span></span><br><span class="line">          getCode() &#123;</span><br><span class="line">              <span class="keyword">if</span> (<span class="keyword">this</span>.userphone == <span class="string">''</span>) &#123;</span><br><span class="line">                  vant.Toast(<span class="string">'手机号不能为空！'</span>);</span><br><span class="line">              &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                  <span class="keyword">if</span> (isClick == <span class="number">0</span>) &#123;</span><br><span class="line">                      isClick = <span class="number">1</span>;</span><br><span class="line">                      <span class="keyword">this</span>.getCodeNum();</span><br><span class="line">                      <span class="keyword">let</span> obj = &#123;</span><br><span class="line">                          mobile: <span class="keyword">this</span>.userphone,</span><br><span class="line">                          action: <span class="string">"send_code"</span>,</span><br><span class="line">                      &#125;</span><br><span class="line">                      Ajax(<span class="string">'get'</span>, <span class="string">'/api'</span>, obj).then(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">                          isClick = <span class="number">0</span>;</span><br><span class="line">                      &#125;)</span><br><span class="line">                  &#125;</span><br><span class="line"></span><br><span class="line">              &#125;</span><br><span class="line">          &#125;,</span><br><span class="line"></span><br><span class="line">          <span class="comment">//确认</span></span><br><span class="line">          addNewUser() &#123;</span><br><span class="line">              <span class="keyword">if</span> (<span class="keyword">this</span>.userphone == <span class="string">''</span>) &#123;</span><br><span class="line">                  vant.Toast(<span class="string">'手机号不能为空！'</span>);</span><br><span class="line">              &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">this</span>.usercode == <span class="string">''</span>) &#123;</span><br><span class="line">                  vant.Toast(<span class="string">'验证码不能为空！'</span>);</span><br><span class="line">              &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                  <span class="keyword">let</span> obj = &#123;</span><br><span class="line">                      mobile: <span class="keyword">this</span>.userphone,</span><br><span class="line">                      action: <span class="string">'check_code'</span>,</span><br><span class="line">                      code: <span class="keyword">this</span>.usercode,</span><br><span class="line">                  &#125;</span><br><span class="line">                  Ajax(<span class="string">'get'</span>, <span class="string">'/api'</span>, obj).then(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line"></span><br><span class="line">                  &#125;)</span><br><span class="line">              &#125;</span><br><span class="line"></span><br><span class="line">          &#125;,</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>常用</category>
        <category>常用工具</category>
      </categories>
      <tags>
        <tag>js,html</tag>
      </tags>
  </entry>
  <entry>
    <title>视频播放器</title>
    <url>/2020/07/15/%E8%A7%86%E9%A2%91%E6%92%AD%E6%94%BE%E5%99%A8/</url>
    <content><![CDATA[<p><img src="https://s1.ax1x.com/2020/07/15/Ud8tc4.png" alt="播放样式"></p>
<a id="more"></a>

<h3 id="一、渲染"><a href="#一、渲染" class="headerlink" title="一、渲染"></a><strong>一、渲染</strong></h3><h4 id="1、区分-ios-与-Android"><a href="#1、区分-ios-与-Android" class="headerlink" title="1、区分 ios 与 Android"></a>1、区分 ios 与 Android</h4><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"video_box wrap"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"video_cont"</span> <span class="attr">v-if</span>=<span class="string">"isiOS"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">video</span></span></span><br><span class="line"><span class="tag">      <span class="attr">id</span>=<span class="string">"video"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">class</span>=<span class="string">"video_box"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">webkit-playsinline</span>=<span class="string">"true"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">x5-playsinline</span>=<span class="string">""</span></span></span><br><span class="line"><span class="tag">      <span class="attr">x5-video-player-type</span>=<span class="string">"h5-page"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">x5-video-player-fullscreen</span>=<span class="string">"true"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">playsinline</span>=<span class="string">"true"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">poster</span>=<span class="string">"http://bendipin.oss-cn-beijing.aliyuncs.com/images/file-1554818270419.png"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">src</span>=<span class="string">"http://video.jishiyoo.com/customerTrans/2d6d4561e207fdc5bae73662f6543bad/1f242163-169fc168513-0005-5026-102-f36a3.mp4"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">preload</span>=<span class="string">"none"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">x-webkit-airplay</span>=<span class="string">"allow"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">x5-video-orientation</span>=<span class="string">"portrait"</span></span></span><br><span class="line"><span class="tag">      @<span class="attr">click</span>=<span class="string">"pauseVideo"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">loop</span>=<span class="string">"loop"</span></span></span><br><span class="line"><span class="tag">    &gt;</span><span class="tag">&lt;/<span class="name">video</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"video_cont"</span> <span class="attr">v-if</span>=<span class="string">"!isiOS"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">video</span></span></span><br><span class="line"><span class="tag">      <span class="attr">id</span>=<span class="string">"video"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">class</span>=<span class="string">"video_box"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">webkit-playsinline</span>=<span class="string">"true"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">x5-playsinline</span>=<span class="string">""</span></span></span><br><span class="line"><span class="tag">      <span class="attr">playsinline</span>=<span class="string">"true"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">poster</span>=<span class="string">"http://bendipin.oss-cn-beijing.aliyuncs.com/images/file-1554818270419.png"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">src</span>=<span class="string">"http://video.jishiyoo.com/customerTrans/2d6d4561e207fdc5bae73662f6543bad/1f242163-169fc168513-0005-5026-102-f36a3.mp4"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">preload</span>=<span class="string">"none"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">x-webkit-airplay</span>=<span class="string">"allow"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">x5-video-orientation</span>=<span class="string">"portrait"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">x5-video-player-type</span>=<span class="string">"h5-page"</span></span></span><br><span class="line"><span class="tag">      @<span class="attr">click</span>=<span class="string">"pauseVideo"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">loop</span>=<span class="string">"loop"</span></span></span><br><span class="line"><span class="tag">    &gt;</span><span class="tag">&lt;/<span class="name">video</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>在 h5 微信端实现不跳转微信浏览器  ，在 android 有效  x5-video-player-type=”h5-page”</p>
<h3 id="二、操作"><a href="#二、操作" class="headerlink" title="二、操作"></a><strong>二、操作</strong></h3><h4 id="1、全局变量"><a href="#1、全局变量" class="headerlink" title="1、全局变量"></a>1、全局变量</h4><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> u = navigator.userAgent; <span class="comment">//在vue渲染的上面定义</span></span><br><span class="line">isiOS: !!u.match(<span class="regexp">/\(i[^;]+;( U;)? CPU.+Mac OS X/</span>), <span class="comment">// ios终端</span></span><br><span class="line">playOrPause: <span class="literal">false</span>,<span class="comment">//是否正在播放</span></span><br></pre></td></tr></table></figure>

<h4 id="2、播放控制"><a href="#2、播放控制" class="headerlink" title="2、播放控制"></a>2、播放控制</h4><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">pauseVideo() &#123; <span class="comment">//暂停\播放</span></span><br><span class="line"><span class="keyword">let</span> video = <span class="built_in">document</span>.getElementById(<span class="string">'video'</span>);</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">this</span>.playOrPause) &#123;</span><br><span class="line">    video.pause();</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        video.play();</span><br><span class="line">    &#125;</span><br><span class="line"><span class="keyword">this</span>.playOrPause = !<span class="keyword">this</span>.playOrPause</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<h4 id="3、css"><a href="#3、css" class="headerlink" title="3、css"></a>3、css</h4><figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.wrap</span> &#123;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">0</span> <span class="number">10px</span> <span class="number">20px</span>;</span><br><span class="line">  <span class="attribute">position</span>: relative;</span><br><span class="line">  <span class="attribute">z-index</span>: <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.video_cont</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">200px</span>;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#000</span>;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">0</span> auto;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#video</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>常用</category>
        <category>常用工具</category>
      </categories>
      <tags>
        <tag>js</tag>
      </tags>
  </entry>
  <entry>
    <title>常用方法-js</title>
    <url>/2020/07/15/%E5%B8%B8%E7%94%A8%E6%96%B9%E6%B3%95-js/</url>
    <content><![CDATA[<p><img src="https://s1.ax1x.com/2020/07/17/Uyyv36.jpg" alt=""></p>
<a id="more"></a>

<h3 id="一、点击复制文本"><a href="#一、点击复制文本" class="headerlink" title="一、点击复制文本"></a><strong>一、点击复制文本</strong></h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> httpUrl = <span class="keyword">this</span>.herfAddress; <span class="comment">//此处为需要被复制的文本</span></span><br><span class="line"><span class="keyword">let</span> oInput = <span class="built_in">document</span>.createElement(<span class="string">"input"</span>);</span><br><span class="line">oInput.value = httpUrl;</span><br><span class="line"><span class="built_in">document</span>.body.appendChild(oInput);</span><br><span class="line">oInput.select(); <span class="comment">// 选择对象</span></span><br><span class="line"><span class="built_in">document</span>.execCommand(<span class="string">"Copy"</span>); <span class="comment">// 执行浏览器复制命令</span></span><br><span class="line">oInput.className = <span class="string">"oInput"</span>;</span><br><span class="line">oInput.style.display = <span class="string">"none"</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">"链接复制成功"</span>);</span><br></pre></td></tr></table></figure>

<h3 id="二、ASCII-码排序参数"><a href="#二、ASCII-码排序参数" class="headerlink" title="二、ASCII 码排序参数"></a><strong>二、ASCII 码排序参数</strong></h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> b=&#123;<span class="string">"k"</span>:<span class="number">1</span>,<span class="string">"a"</span>:<span class="number">2</span>&#125;</span><br><span class="line">objKeySort(b);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">objKeySort</span>(<span class="params">obj</span>) </span>&#123;</span><br><span class="line">  <span class="comment">//obj排序对象</span></span><br><span class="line">  <span class="keyword">var</span> newkey = <span class="built_in">Object</span>.keys(obj).sort();</span><br><span class="line">  <span class="keyword">var</span> newObj = &#123;&#125;; <span class="comment">//创建一个新的对象，用于存放排好序的键值对</span></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; newkey.length; i++) &#123;</span><br><span class="line">    newObj[newkey[i]] = obj[newkey[i]];</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> newObj; <span class="comment">//返回排好序的新对象</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//输出结果 &#123;a: 2, k: 1&#125;</span></span><br></pre></td></tr></table></figure>

<h3 id="三、如何平滑滚动到页面顶部"><a href="#三、如何平滑滚动到页面顶部" class="headerlink" title="三、如何平滑滚动到页面顶部"></a><strong>三、如何平滑滚动到页面顶部</strong></h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> scrollToTop = <span class="function"><span class="params">()</span> =&gt;</span> &#123;  </span><br><span class="line">  <span class="keyword">const</span> c = <span class="built_in">document</span>.documentElement.scrollTop || <span class="built_in">document</span>.body.scrollTop;  </span><br><span class="line">  <span class="keyword">if</span> (c &gt; <span class="number">0</span>) &#123;  </span><br><span class="line">    <span class="built_in">window</span>.requestAnimationFrame(scrollToTop);  </span><br><span class="line">    <span class="built_in">window</span>.scrollTo(<span class="number">0</span>, c - c / <span class="number">8</span>);  </span><br><span class="line">  &#125;  </span><br><span class="line">&#125;  </span><br><span class="line"><span class="comment">// 事例  </span></span><br><span class="line">scrollToTop(); <span class="comment">//返回排好序的新对象</span></span><br></pre></td></tr></table></figure>

<hr>
<h3 id="四、禁止微信用户修改字体大小"><a href="#四、禁止微信用户修改字体大小" class="headerlink" title="四、禁止微信用户修改字体大小"></a><strong>四、禁止微信用户修改字体大小</strong></h3><p>微信 webview 内置了调整字体大小的功能，用户可以根据实际情况进行调整。</p>
<h4 id="1、android-手机"><a href="#1、android-手机" class="headerlink" title="1、android 手机"></a>1、android 手机</h4><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">       (<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">           <span class="keyword">if</span> (<span class="keyword">typeof</span> WeixinJSBridge == <span class="string">"object"</span> &amp;&amp; <span class="keyword">typeof</span> WeixinJSBridge.invoke == <span class="string">"function"</span>) &#123;</span><br><span class="line">               handleFontSize();</span><br><span class="line">           &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">               <span class="keyword">if</span> (<span class="built_in">document</span>.addEventListener) &#123;</span><br><span class="line">                   <span class="built_in">document</span>.addEventListener(<span class="string">"WeixinJSBridgeReady"</span>, handleFontSize, <span class="literal">false</span>);</span><br><span class="line">               &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="built_in">document</span>.attachEvent) &#123;</span><br><span class="line">                   <span class="built_in">document</span>.attachEvent(<span class="string">"WeixinJSBridgeReady"</span>, handleFontSize);</span><br><span class="line">                   <span class="built_in">document</span>.attachEvent(<span class="string">"onWeixinJSBridgeReady"</span>, handleFontSize);  &#125;</span><br><span class="line">           &#125;</span><br><span class="line">           <span class="function"><span class="keyword">function</span> <span class="title">handleFontSize</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">               <span class="comment">// 设置网页字体为默认大小</span></span><br><span class="line">               WeixinJSBridge.invoke(<span class="string">'setFontSizeCallback'</span>, &#123; <span class="string">'fontSize'</span> : <span class="number">0</span> &#125;);</span><br><span class="line">               <span class="comment">// 重写设置网页字体大小的事件</span></span><br><span class="line">               WeixinJSBridge.on(<span class="string">'menu:setfont'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">                   WeixinJSBridge.invoke(<span class="string">'setFontSizeCallback'</span>, &#123; <span class="string">'fontSize'</span> : <span class="number">0</span> &#125;);</span><br><span class="line">               &#125;);</span><br><span class="line">           &#125;</span><br><span class="line">       &#125;)();</span><br><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="2、IOS"><a href="#2、IOS" class="headerlink" title="2、IOS"></a>2、IOS</h4><figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">body</span> &#123;</span><br><span class="line">  <span class="comment">/* IOS禁止微信调整字体大小 */</span></span><br><span class="line">  <span class="attribute">-webkit-text-size-adjust</span>: <span class="number">100%</span> <span class="meta">!important</span>;</span><br><span class="line">  <span class="attribute">text-size-adjust</span>: <span class="number">100%</span> <span class="meta">!important</span>;</span><br><span class="line">  <span class="attribute">-moz-text-size-adjust</span>: <span class="number">100%</span> <span class="meta">!important</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="五、px-与-rem-换算"><a href="#五、px-与-rem-换算" class="headerlink" title="五、px 与 rem 换算"></a><strong>五、px 与 rem 换算</strong></h3><p>rem 是根据 iPhone6 换算的，根据设计出的 px 尺寸除以 100 带上 rem 单位即可，平常 14px 换算成 rem 是 0.28rem</p>
<h4 id="1、在-style-js-里面引用"><a href="#1、在-style-js-里面引用" class="headerlink" title="1、在 style.js 里面引用"></a>1、在 style.js 里面引用</h4><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//rem换算</span></span><br><span class="line">(<span class="function"><span class="keyword">function</span> (<span class="params">doc, win</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> docEl = doc.documentElement,</span><br><span class="line">    resizeEvt = <span class="string">"orientationchange"</span> <span class="keyword">in</span> <span class="built_in">window</span> ? <span class="string">"orientationchange"</span> : <span class="string">"resize"</span>,</span><br><span class="line">    recalc = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="keyword">var</span> clientWidth = docEl.clientWidth;</span><br><span class="line">      <span class="keyword">if</span> (!clientWidth) <span class="keyword">return</span>;</span><br><span class="line">      <span class="keyword">if</span> (clientWidth &gt;= <span class="number">750</span>) &#123;</span><br><span class="line">        docEl.style.fontSize = <span class="string">"100px"</span>;</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        docEl.style.fontSize = <span class="number">100</span> * (clientWidth / <span class="number">750</span>) + <span class="string">"px"</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">  <span class="keyword">if</span> (!doc.addEventListener) <span class="keyword">return</span>;</span><br><span class="line">  win.addEventListener(resizeEvt, recalc, <span class="literal">false</span>);</span><br><span class="line">  doc.addEventListener(<span class="string">"DOMContentLoaded"</span>, recalc, <span class="literal">false</span>);</span><br><span class="line">&#125;)(<span class="built_in">document</span>, <span class="built_in">window</span>);</span><br></pre></td></tr></table></figure>

<h4 id="2、在-style-css-里面"><a href="#2、在-style-css-里面" class="headerlink" title="2、在 style.css 里面"></a>2、在 style.css 里面</h4><figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">html</span> &#123;</span><br><span class="line">  <span class="attribute">line-height</span>: initial;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>返回上层路由：</p>
<h3 id="六、获取链接参数"><a href="#六、获取链接参数" class="headerlink" title="六、获取链接参数"></a>六、获取链接参数</h3><h4 id="1、原生"><a href="#1、原生" class="headerlink" title="1、原生"></a>1、原生</h4><blockquote>
<p>1、定义方法</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">GetQueryString</span>(<span class="params">name</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> reg = <span class="keyword">new</span> <span class="built_in">RegExp</span>(<span class="string">"(^|&amp;)"</span> + name + <span class="string">"=([^&amp;]*)(&amp;|$)"</span>);</span><br><span class="line">  <span class="keyword">var</span> r = <span class="built_in">window</span>.location.search.substr(<span class="number">1</span>).match(reg);</span><br><span class="line">  <span class="keyword">if</span> (r != <span class="literal">null</span>) <span class="keyword">return</span> <span class="built_in">unescape</span>(r[<span class="number">2</span>]);</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>2、使用</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> a=GetQueryString(<span class="string">"name"</span>)；</span><br></pre></td></tr></table></figure>

<h4 id="2、vue"><a href="#2、vue" class="headerlink" title="2、vue"></a>2、vue</h4><blockquote>
<p>1、跳转页面并传参</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">this</span>.$router.push(&#123;</span><br><span class="line">    path: <span class="string">'/PC/wish/fill/collegesPriority'</span>,</span><br><span class="line">    query: &#123;</span><br><span class="line">        filltype: <span class="string">''</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>2、取参</p>
</blockquote>
<p>其中 ‘filltype’ 为链接参数。</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">this</span>.$route.query.filltype</span><br></pre></td></tr></table></figure>

<h3 id="七、修改参数"><a href="#七、修改参数" class="headerlink" title="七、修改参数"></a>七、修改参数</h3><h4 id="1、修改链接及参数"><a href="#1、修改链接及参数" class="headerlink" title="1、修改链接及参数"></a>1、修改链接及参数</h4><p>*<em>/m/m_url_example *</em>是相对链接，</p>
<p>此方法是直接替换域名后面的链接。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">history.replaceState(&#123;&#125;,&#39;&#39;, &#39;&#x2F;m&#x2F;m_url_example&#39;);</span><br></pre></td></tr></table></figure>

<h4 id="2、添加参数"><a href="#2、添加参数" class="headerlink" title="2、添加参数"></a>2、添加参数</h4><blockquote>
<p>1、定义方法</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">changeURLArg</span>(<span class="params">url, arg, arg_val</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> pattern = arg + <span class="string">"=([^&amp;]*)"</span>;</span><br><span class="line">  <span class="keyword">var</span> replaceText = arg + <span class="string">"="</span> + arg_val;</span><br><span class="line">  <span class="keyword">if</span> (url.match(pattern)) &#123;</span><br><span class="line">    <span class="keyword">var</span> tmp = <span class="string">"/("</span> + arg + <span class="string">"=)([^&amp;]*)/gi"</span>;</span><br><span class="line">    tmp = url.replace(<span class="built_in">eval</span>(tmp), replaceText);</span><br><span class="line">    <span class="keyword">return</span> tmp;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (url.match(<span class="string">"[?]"</span>)) &#123;</span><br><span class="line">      <span class="keyword">return</span> url + <span class="string">"&amp;"</span> + replaceText;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> url + <span class="string">"?"</span> + replaceText;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>2、使用</p>
</blockquote>
<p>此方法是在当前链接后面追加参数 ，“name” 为参数名，“123” 为值。</p>
<p>若连接上没有“name”参数，则会添加这个参数并赋值，若链接本就有这个参数，则会将值替换为“123”。</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="built_in">window</span>.location.href = changeURLArg(<span class="built_in">window</span>.location.href, <span class="string">"name"</span>, <span class="number">123</span>);</span><br></pre></td></tr></table></figure>

<h3 id="八、时间转化"><a href="#八、时间转化" class="headerlink" title="八、时间转化"></a><strong>八、时间转化</strong></h3><blockquote>
<p>获取当前整形时间戳</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="built_in">parseInt</span>(<span class="keyword">new</span> <span class="built_in">Date</span>().getTime())</span><br></pre></td></tr></table></figure>

<h4 id="1、时间戳转化为时间"><a href="#1、时间戳转化为时间" class="headerlink" title="1、时间戳转化为时间"></a><strong>1、时间戳转化为时间</strong></h4><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//将时间戳转化为日期</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">timestampToTime</span>(<span class="params">timestamp</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> date = <span class="keyword">new</span> <span class="built_in">Date</span>(timestamp); <span class="comment">//时间戳为10位需*1000，时间戳为13位的话不需乘1000</span></span><br><span class="line">  <span class="keyword">var</span> Y = date.getFullYear() + <span class="string">"-"</span>;</span><br><span class="line">  <span class="keyword">var</span> M =</span><br><span class="line">    (date.getMonth() + <span class="number">1</span> &lt; <span class="number">10</span></span><br><span class="line">      ? <span class="string">"0"</span> + (date.getMonth() + <span class="number">1</span>)</span><br><span class="line">      : date.getMonth() + <span class="number">1</span>) + <span class="string">"-"</span>;</span><br><span class="line">  <span class="keyword">var</span> D = (date.getDate() &lt; <span class="number">10</span> ? <span class="string">"0"</span> + date.getDate() : date.getDate()) + <span class="string">" "</span>;</span><br><span class="line">  <span class="keyword">var</span> h =</span><br><span class="line">    (date.getHours() &lt; <span class="number">10</span> ? <span class="string">"0"</span> + date.getHours() : date.getHours()) + <span class="string">":"</span>;</span><br><span class="line">  <span class="keyword">var</span> m =</span><br><span class="line">    (date.getMinutes() &lt; <span class="number">10</span> ? <span class="string">"0"</span> + date.getMinutes() : date.getMinutes()) +</span><br><span class="line">    <span class="string">":"</span>;</span><br><span class="line">  <span class="keyword">var</span> s = date.getSeconds() &lt; <span class="number">10</span> ? <span class="string">"0"</span> + date.getSeconds() : date.getSeconds();</span><br><span class="line">  <span class="keyword">return</span> Y + M + D + h + m + s;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="2、计算两个时间相差日期"><a href="#2、计算两个时间相差日期" class="headerlink" title="2、计算两个时间相差日期"></a><strong>2、计算两个时间相差日期</strong></h4><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//startData,endData均为时间戳</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">timesDiffer</span>(<span class="params">startData, endData</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> date1 = startData; <span class="comment">//开始时间</span></span><br><span class="line">  <span class="keyword">var</span> date2 = endData; <span class="comment">//结束时间</span></span><br><span class="line">  <span class="keyword">var</span> date3 = <span class="built_in">parseInt</span>(date2) - <span class="built_in">parseInt</span>(date1); <span class="comment">//时间差的毫秒数</span></span><br><span class="line">  <span class="comment">//计算出相差天数</span></span><br><span class="line">  <span class="keyword">var</span> days = <span class="built_in">Math</span>.floor(date3 / (<span class="number">24</span> * <span class="number">3600</span> * <span class="number">1000</span>));</span><br><span class="line">  <span class="comment">//计算出小时数</span></span><br><span class="line">  <span class="keyword">var</span> leave1 = date3 % (<span class="number">24</span> * <span class="number">3600</span> * <span class="number">1000</span>); <span class="comment">//计算天数后剩余的毫秒数</span></span><br><span class="line">  <span class="keyword">var</span> hours = <span class="built_in">Math</span>.floor(leave1 / (<span class="number">3600</span> * <span class="number">1000</span>));</span><br><span class="line">  <span class="comment">//计算相差分钟数</span></span><br><span class="line">  <span class="keyword">var</span> leave2 = leave1 % (<span class="number">3600</span> * <span class="number">1000</span>); <span class="comment">//计算小时数后剩余的毫秒数</span></span><br><span class="line">  <span class="keyword">var</span> minutes = <span class="built_in">Math</span>.floor(leave2 / (<span class="number">60</span> * <span class="number">1000</span>));</span><br><span class="line"></span><br><span class="line">  <span class="comment">//计算相差秒数</span></span><br><span class="line">  <span class="keyword">var</span> leave3 = leave2 % (<span class="number">60</span> * <span class="number">1000</span>); <span class="comment">//计算分钟数后剩余的毫秒数</span></span><br><span class="line">  <span class="keyword">var</span> seconds = <span class="built_in">Math</span>.round(leave3 / <span class="number">1000</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (hours &lt;= <span class="number">0</span> &amp;&amp; minutes &lt;= <span class="number">0</span> &amp;&amp; seconds &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="comment">//时间小于0s的操作</span></span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    hours = hours &lt; <span class="number">10</span> ? <span class="string">"0"</span> + hours : hours;</span><br><span class="line">    minutes = minutes &lt; <span class="number">10</span> ? <span class="string">"0"</span> + minutes : minutes;</span><br><span class="line">    seconds = seconds &lt; <span class="number">10</span> ? <span class="string">"0"</span> + seconds : seconds;</span><br><span class="line">    <span class="keyword">return</span> hours + <span class="string">":"</span> + minutes + <span class="string">":"</span> + seconds;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="3、计算-n-天前后的日期"><a href="#3、计算-n-天前后的日期" class="headerlink" title="3、计算 n 天前后的日期"></a>3、计算 n 天前后的日期</h4><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getBeforeDate</span>(<span class="params">strDate, n</span>) </span>&#123;</span><br><span class="line">  <span class="comment">//strDate 为字符串日期 如:'2020-01-01' n为你要传入的参数，当前为0，前一天为-1，后一天为1</span></span><br><span class="line">  <span class="keyword">let</span> datt = strDate.split(<span class="string">"-"</span>); <span class="comment">//这边给定一个特定时间</span></span><br><span class="line">  <span class="keyword">var</span> newDate = <span class="keyword">new</span> <span class="built_in">Date</span>(datt[<span class="number">0</span>], datt[<span class="number">1</span>] - <span class="number">1</span>, datt[<span class="number">2</span>]);</span><br><span class="line">  <span class="keyword">let</span> befminuts = newDate.getTime() + <span class="number">1000</span> * <span class="number">60</span> * <span class="number">60</span> * <span class="number">24</span> * <span class="built_in">parseInt</span>(n); <span class="comment">//计算前几天用减，计算后几天用加，最后一个就是多少天的数量</span></span><br><span class="line">  <span class="keyword">let</span> beforeDat = <span class="keyword">new</span> <span class="built_in">Date</span>();</span><br><span class="line">  beforeDat.setTime(befminuts);</span><br><span class="line">  <span class="keyword">let</span> befMonth = beforeDat.getMonth() + <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">let</span> mon = befMonth &gt;= <span class="number">10</span> ? befMonth : <span class="string">"0"</span> + befMonth;</span><br><span class="line">  <span class="keyword">let</span> befDate = beforeDat.getDate();</span><br><span class="line">  <span class="keyword">let</span> da = befDate &gt;= <span class="number">10</span> ? befDate : <span class="string">"0"</span> + befDate;</span><br><span class="line">  <span class="keyword">var</span> newDate = beforeDat.getFullYear() + <span class="string">"-"</span> + mon + <span class="string">"-"</span> + da;</span><br><span class="line">  <span class="built_in">console</span>.log(newDate);</span><br><span class="line">  <span class="keyword">return</span> newDate;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="4、获得两个日期之间的差异（以天为单位）"><a href="#4、获得两个日期之间的差异（以天为单位）" class="headerlink" title="4、获得两个日期之间的差异（以天为单位）"></a>4、获得两个日期之间的差异（以天为单位）</h4><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> getDaysDiffBetweenDates = <span class="function">(<span class="params">dateInitial, dateFinal</span>) =&gt;</span>  </span><br><span class="line">  (dateFinal - dateInitial) / (<span class="number">1000</span> * <span class="number">3600</span> * <span class="number">24</span>);  </span><br><span class="line"><span class="comment">// 事例  </span></span><br><span class="line">getDaysDiffBetweenDates(<span class="keyword">new</span> <span class="built_in">Date</span>(<span class="string">'2020-12-13'</span>), <span class="keyword">new</span> <span class="built_in">Date</span>(<span class="string">'2020-12-22'</span>)); <span class="comment">// 9</span></span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>常用</category>
        <category>常用方法</category>
      </categories>
      <tags>
        <tag>js</tag>
      </tags>
  </entry>
  <entry>
    <title>视频上传</title>
    <url>/2020/09/04/%E8%A7%86%E9%A2%91%E4%B8%8A%E4%BC%A0/</url>
    <content><![CDATA[<p>该视频上传至阿里云服务器。</p>
<a id="more"></a>

<h3 id="一、html"><a href="#一、html" class="headerlink" title="一、html"></a>一、html</h3><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">"本地上传"</span> <span class="attr">class</span>=<span class="string">"input_li"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span></span></span><br><span class="line"><span class="tag">    <span class="attr">type</span>=<span class="string">"file"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">name</span>=<span class="string">"file"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">id</span>=<span class="string">"files"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">multiple</span></span></span><br><span class="line"><span class="tag">    <span class="attr">style</span>=<span class="string">"display: none"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">class</span>=<span class="string">"video_file"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">ref</span>=<span class="string">"video_file_button"</span></span></span><br><span class="line"><span class="tag">  /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"video_list"</span>&gt;</span></span><br><span class="line">    &#123;&#123;video_name&#125;&#125;</span><br><span class="line">  <span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">el-button</span></span></span><br><span class="line"><span class="tag">    <span class="attr">class</span>=<span class="string">"add_video_span check_pic"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">size</span>=<span class="string">"small"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">type</span>=<span class="string">"primary"</span></span></span><br><span class="line"><span class="tag">    @<span class="attr">click</span>=<span class="string">"uploadVideo"</span></span></span><br><span class="line"><span class="tag">    &gt;</span>&#123;&#123;uploadButtonWord&#125;&#125;</span><br><span class="line">  <span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"clear"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"aplayer_box video_box"</span> <span class="attr">v-if</span>=<span class="string">"ruleForm.video_url!=''"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">video</span></span></span><br><span class="line"><span class="tag">      @<span class="attr">click</span>=<span class="string">"pauseVideo"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">ref</span>=<span class="string">"videoOnly"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">id</span>=<span class="string">"video"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">webkit-playsinline</span>=<span class="string">"true"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">x5-playsinline</span>=<span class="string">""</span></span></span><br><span class="line"><span class="tag">      <span class="attr">x5-video-player-type</span>=<span class="string">"h5"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">x5-video-player-fullscreen</span>=<span class="string">"true"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">playsinline</span>=<span class="string">"true"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">poster</span>=<span class="string">"http://oss.jishiyoo.com/images/file-1563705935105.jpg"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">:src</span>=<span class="string">"ruleForm.video_url"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">preload</span>=<span class="string">"none"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">x-webkit-airplay</span>=<span class="string">"allow"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">x5-video-orientation</span>=<span class="string">"portrait"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">loop</span>=<span class="string">"loop"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">class</span>=<span class="string">"template_video"</span></span></span><br><span class="line"><span class="tag">    &gt;</span><span class="tag">&lt;/<span class="name">video</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--页面加载完成前动画--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"hover_all"</span> <span class="attr">v-show</span>=<span class="string">"animationStyle"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"file_loading_box"</span> <span class="attr">v-show</span>=<span class="string">"animationStyle"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"spinner8"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"spinner-container container1"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"circle1"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"circle2"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"circle3"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"circle4"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"spinner-container container2"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"circle1"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"circle2"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"circle3"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"circle4"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"spinner-container container3"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"circle1"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"circle2"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"circle3"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"circle4"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"file_percent"</span>&gt;</span>&#123;&#123;filePercent&#125;&#125;%<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="二、data"><a href="#二、data" class="headerlink" title="二、data"></a>二、data</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> loadingInstance;<span class="comment">//定时器</span></span><br><span class="line"><span class="keyword">let</span> vm = <span class="string">''</span>;</span><br><span class="line"><span class="keyword">let</span> uploadAuth;<span class="comment">//上传凭证</span></span><br><span class="line"><span class="keyword">let</span> uploadAddress;<span class="comment">//上传地址</span></span><br><span class="line"><span class="keyword">let</span> global_video_size;</span><br><span class="line"><span class="keyword">let</span> global_video_name = <span class="string">""</span>;</span><br><span class="line"><span class="keyword">let</span> global_video_id = <span class="string">''</span>;</span><br><span class="line"></span><br><span class="line">statusText: <span class="string">''</span>,</span><br><span class="line">uploadButtonWord: <span class="string">'本地上传'</span>,</span><br><span class="line">videoId: <span class="string">''</span>,<span class="comment">//回调返回视频id</span></span><br><span class="line">video_name: <span class="string">''</span>,</span><br><span class="line">animationStyle: <span class="literal">true</span>,<span class="comment">//上传视频动画是否展示</span></span><br><span class="line">filePercent: <span class="string">''</span>,<span class="comment">//上传进度</span></span><br><span class="line">ruleForm: &#123;</span><br><span class="line">	video_url: <span class="string">''</span>,<span class="comment">//视频链接</span></span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<h3 id="三、js"><a href="#三、js" class="headerlink" title="三、js"></a>三、js</h3><h4 id="1、mounted，在需要上传视频的地方"><a href="#1、mounted，在需要上传视频的地方" class="headerlink" title="1、mounted，在需要上传视频的地方"></a>1、mounted，在需要上传视频的地方</h4><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="built_in">document</span>.getElementById(<span class="string">"files"</span>).addEventListener(<span class="string">"change"</span>, (event) =&gt; &#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; event.target.files.length; i++) &#123;</span><br><span class="line">    <span class="comment">// 逻辑代码</span></span><br><span class="line">    <span class="comment">//                console.log(event.target.files)</span></span><br><span class="line">    <span class="keyword">let</span> userData =</span><br><span class="line">      <span class="string">'&#123;"Vod":&#123;"UserData":&#123;"IsShowWaterMark":"false","Priority":"7"&#125;&#125;&#125;'</span>;</span><br><span class="line">    uploader.addFile(event.target.files[<span class="number">0</span>], <span class="literal">null</span>, <span class="literal">null</span>, <span class="literal">null</span>, userData);</span><br><span class="line">    global_video_size = event.target.files[<span class="number">0</span>].size;</span><br><span class="line">    global_video_name = event.target.files[<span class="number">0</span>].name;</span><br><span class="line">    <span class="keyword">this</span>.video_name = event.target.files[<span class="number">0</span>].name;</span><br><span class="line">    <span class="keyword">this</span>.uploadButtonWord = <span class="string">"重新上传"</span>;</span><br><span class="line">    <span class="comment">/* document.getElementsByClassName('.video_list').remove();</span></span><br><span class="line"><span class="comment">                                 document.getElementsByClassName('.add_video_span').before('&lt;span class="video_list"&gt;' +</span></span><br><span class="line"><span class="comment">                                     '&lt;i class="iconfont iconshipin-tianchong"&gt;&lt;/i&gt;' + global_video_name + '&lt;/span&gt;');</span></span><br><span class="line"><span class="comment">                                 document.getElementsByClassName('.add_video_span').text("重新上传");*/</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h4 id="2、方法"><a href="#2、方法" class="headerlink" title="2、方法"></a>2、方法</h4><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">pauseVideo() &#123; <span class="comment">//暂停\播放</span></span><br><span class="line">                <span class="keyword">let</span> video = <span class="built_in">document</span>.getElementById(<span class="string">'video'</span>);</span><br><span class="line">                <span class="keyword">if</span> (<span class="keyword">this</span>.playOrPause) &#123;</span><br><span class="line">                    video.pause();</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    video.play();</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">this</span>.playOrPause = !<span class="keyword">this</span>.playOrPause</span><br><span class="line">            &#125;,</span><br><span class="line">            handleVideoProgress(event) &#123;</span><br><span class="line">                loadingInstance = Loading.service(&#123;</span><br><span class="line">                    lock: <span class="literal">true</span>,</span><br><span class="line">                    text: <span class="string">'努力上传中 ~&gt;_&lt;~'</span>,</span><br><span class="line">                    background: <span class="string">'rgba(255, 255, 255, 0.1)'</span></span><br><span class="line">                &#125;);</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="comment">//上传本地视频</span></span><br><span class="line">            handleVideoSuccess(res, file) &#123;</span><br><span class="line">                <span class="keyword">let</span> url = res.data;</span><br><span class="line">                <span class="keyword">this</span>.ruleForm.video_url = url</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="comment">//点击上传视频</span></span><br><span class="line">            uploadVideo() &#123;</span><br><span class="line">                <span class="keyword">this</span>.$refs.video_file_button.click();</span><br><span class="line">            &#125;,</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//回显-获取详情</span></span><br><span class="line">            getDetail() &#123;</span><br><span class="line">                <span class="keyword">let</span> obj = &#123;</span><br><span class="line">                    video_id: <span class="keyword">this</span>.video_id_detail,</span><br><span class="line">                    videoId: <span class="keyword">this</span>.videoIdDetail,</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">this</span>.$http.get(<span class="string">"/api/release/video/list"</span>, obj).then(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">                    <span class="keyword">let</span> data = res.data.data[<span class="number">0</span>];</span><br><span class="line">                    <span class="keyword">this</span>.baseSetForm = &#123;</span><br><span class="line">                        video_url: data.video_url,<span class="comment">//视频url</span></span><br><span class="line"></span><br><span class="line">                    &#125;;</span><br><span class="line">                    <span class="keyword">this</span>.videoId = data.videoId;<span class="comment">//视频Id</span></span><br><span class="line">                &#125;)</span><br><span class="line">            &#125;,</span><br><span class="line"><span class="comment">//发布按钮</span></span><br><span class="line">            groupSetSubmitForm(baseSetForm) &#123;</span><br><span class="line">                <span class="keyword">this</span>.$refs[baseSetForm].validate(<span class="function">(<span class="params">valid</span>) =&gt;</span> &#123;</span><br><span class="line">                    <span class="keyword">if</span> (valid) &#123;</span><br><span class="line">                        <span class="keyword">if</span>(<span class="keyword">this</span>.video_name!=<span class="string">''</span>)&#123;</span><br><span class="line">                            <span class="comment">//如果已上传视频，请求接口获取上传凭证</span></span><br><span class="line">                            <span class="keyword">this</span>.getUploadMessage();</span><br><span class="line">                        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">             <span class="comment">//如果没有上传，执行提交表单接口，也许是回显过来的视频，所以没有视频名称</span></span><br><span class="line">                            <span class="keyword">this</span>.groupSubmitForm();</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        <span class="built_in">console</span>.log(<span class="string">'error submit!!'</span>);</span><br><span class="line">                        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;);</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="comment">//获取上传凭证</span></span><br><span class="line">            getUploadMessage() &#123;</span><br><span class="line">                <span class="keyword">let</span> obj = &#123;&#125;;</span><br><span class="line">                obj.filename = <span class="keyword">this</span>.video_name;</span><br><span class="line">                obj.title = <span class="keyword">this</span>.video_name;</span><br><span class="line">                <span class="comment">/*if (this.video_name == '') &#123;</span></span><br><span class="line"><span class="comment">                    this.$message.error('视频不能为空！')</span></span><br><span class="line"><span class="comment">                &#125; else &#123;*/</span></span><br><span class="line">                <span class="keyword">this</span>.$http.post(<span class="string">"/video/upload"</span>, obj).then(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">                    <span class="keyword">let</span> data = res.data.data;</span><br><span class="line">                    uploadAuth = data.uploadAuth;</span><br><span class="line">                    uploadAddress = data.uploadAddress;</span><br><span class="line">                    global_video_id = data.videoId;</span><br><span class="line">                    <span class="keyword">this</span>.videoId = data.videoId;</span><br><span class="line">                    <span class="keyword">this</span>.groupSubmitForm();</span><br><span class="line">                &#125;)</span><br><span class="line">                <span class="comment">// &#125;</span></span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="comment">//发布</span></span><br><span class="line">            groupSubmitForm() &#123;</span><br><span class="line">                <span class="keyword">let</span> obj = &#123;</span><br><span class="line">                    <span class="comment">// videoId: this.videoId,</span></span><br><span class="line">                    video_desc: <span class="keyword">this</span>.baseSetForm.video_desc,</span><br><span class="line">                    cover_url: <span class="keyword">this</span>.cover_url,</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (<span class="keyword">this</span>.video_id_detail != <span class="number">0</span>) &#123;</span><br><span class="line">                    <span class="comment">//回显过来链接上会有video_id_detail</span></span><br><span class="line">                    obj.video_id = <span class="keyword">this</span>.video_id_detail</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (<span class="keyword">this</span>.videoId == <span class="string">''</span>) &#123;</span><br><span class="line">                    <span class="comment">//回显过来的视频没有名称但是有videoId</span></span><br><span class="line">                    <span class="keyword">this</span>.$message.error(<span class="string">'视频不能为空！'</span>)</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">/* else if (this.baseSetForm.item_images == '') &#123;</span></span><br><span class="line"><span class="comment">                     this.$message.error('封面图不能为空！')</span></span><br><span class="line"><span class="comment">                 &#125;*/</span></span><br><span class="line">                <span class="keyword">else</span> &#123;</span><br><span class="line">                    obj.videoId = <span class="keyword">this</span>.videoId;</span><br><span class="line">                    <span class="keyword">this</span>.$http.post(<span class="string">"/video"</span>, obj).then(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">                        <span class="keyword">if</span>(<span class="keyword">this</span>.video_name!=<span class="string">''</span>)&#123;</span><br><span class="line">                            <span class="comment">//上传视频，，这是第一次上传视频，需要把视频上传到阿里云上</span></span><br><span class="line">                            upLoadVideo();</span><br><span class="line">                        &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">                      <span class="comment">//此时是回显过来的视频没有名称，但有videoId，所以不需要重新上传至阿里云</span></span><br><span class="line">                            <span class="keyword">this</span>.$router.go(<span class="number">-1</span>);</span><br><span class="line">                        &#125;</span><br><span class="line"></span><br><span class="line">                    &#125;)</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;,</span><br></pre></td></tr></table></figure>

<h3 id="四、在-export-default-外面，在-script-里面"><a href="#四、在-export-default-外面，在-script-里面" class="headerlink" title="四、在 export default 外面，在 script 里面"></a>四、在 export default 外面，在 script 里面</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> uploader = <span class="keyword">new</span> AliyunUpload.Vod(&#123;</span><br><span class="line">  userId: <span class="string">"1495499294062243"</span>,</span><br><span class="line">  <span class="comment">// 开始上传</span></span><br><span class="line">  onUploadstarted: <span class="function"><span class="keyword">function</span> (<span class="params">uploadInfo</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(</span><br><span class="line">      <span class="string">"开始上传，uploadInfo："</span> +</span><br><span class="line">        uploadInfo +</span><br><span class="line">        <span class="string">"，uploadAuth:"</span> +</span><br><span class="line">        uploadAuth +</span><br><span class="line">        <span class="string">"，uploadAddress:"</span> +</span><br><span class="line">        uploadAddress</span><br><span class="line">    );</span><br><span class="line">    <span class="built_in">console</span>.log(</span><br><span class="line">      <span class="string">"onUploadStarted:"</span> +</span><br><span class="line">        uploadInfo.file.name +</span><br><span class="line">        <span class="string">", endpoint:"</span> +</span><br><span class="line">        uploadInfo.endpoint +</span><br><span class="line">        <span class="string">", bucket:"</span> +</span><br><span class="line">        uploadInfo.bucket +</span><br><span class="line">        <span class="string">", object:"</span> +</span><br><span class="line">        uploadInfo.object</span><br><span class="line">    );</span><br><span class="line">    uploader.setUploadAuthAndAddress(</span><br><span class="line">      uploadInfo,</span><br><span class="line">      uploadAuth,</span><br><span class="line">      uploadAddress,</span><br><span class="line">      global_video_id</span><br><span class="line">    );</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// 文件上传成功</span></span><br><span class="line">  onUploadSucceed: <span class="function"><span class="keyword">function</span> (<span class="params">uploadInfo</span>) </span>&#123;</span><br><span class="line">    vm.$notify(&#123;</span><br><span class="line">      title: <span class="string">"上传成功"</span>,</span><br><span class="line">      type: <span class="string">"success"</span>,</span><br><span class="line">    &#125;);</span><br><span class="line">    hideFileLoading();</span><br><span class="line">    localStorage.setItem(<span class="string">"hasNewVideo"</span>, <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">if</span> (vm.continueIndex == <span class="number">1</span>) &#123;</span><br><span class="line">      history.go(<span class="number">-1</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (vm.continueIndex == <span class="number">2</span>) &#123;</span><br><span class="line">      vm.$refs.ruleForm.resetFields();</span><br><span class="line">      vm.video_name = <span class="string">""</span>;</span><br><span class="line">      vm.ruleForm.video_url = <span class="string">""</span>;</span><br><span class="line">      vm.ruleForm.audio_url = <span class="string">""</span>;</span><br><span class="line">      vm.ruleForm.task = <span class="string">""</span>;</span><br><span class="line">      vm.ruleForm.answer = <span class="string">""</span>;</span><br><span class="line">      vm.audio_url = &#123;</span><br><span class="line">        artist: <span class="string">"讲述人"</span>,</span><br><span class="line">        src: <span class="string">""</span>,</span><br><span class="line">        title: <span class="string">"课程音频"</span>,</span><br><span class="line">      &#125;;</span><br><span class="line">      vm.ruleForm.sequence = <span class="built_in">parseInt</span>(vm.ruleForm.sequence) + <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">console</span>.log(</span><br><span class="line">      <span class="string">"onUploadSucceed: "</span> +</span><br><span class="line">        uploadInfo.file.name +</span><br><span class="line">        <span class="string">", endpoint:"</span> +</span><br><span class="line">        uploadInfo.endpoint +</span><br><span class="line">        <span class="string">", bucket:"</span> +</span><br><span class="line">        uploadInfo.bucket +</span><br><span class="line">        <span class="string">", object:"</span> +</span><br><span class="line">        uploadInfo.object</span><br><span class="line">    );</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// 文件上传失败</span></span><br><span class="line">  onUploadFailed: <span class="function"><span class="keyword">function</span> (<span class="params">uploadInfo, code, message</span>) </span>&#123;</span><br><span class="line">    vm.$notify(&#123;</span><br><span class="line">      title: <span class="string">"上传失败"</span>,</span><br><span class="line">      type: <span class="string">"warning"</span>,</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="built_in">console</span>.log(</span><br><span class="line">      <span class="string">"onUploadFailed: file:"</span> +</span><br><span class="line">        uploadInfo.file.name +</span><br><span class="line">        <span class="string">",code:"</span> +</span><br><span class="line">        code +</span><br><span class="line">        <span class="string">", message:"</span> +</span><br><span class="line">        message</span><br><span class="line">    );</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// 文件上传进度，单位：字节</span></span><br><span class="line">  onUploadProgress: <span class="function"><span class="keyword">function</span> (<span class="params">uploadInfo, totalSize, loadedPercent</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"loadedPercent:"</span> + loadedPercent);</span><br><span class="line">    vm.filePercent = (loadedPercent * <span class="number">100</span>).toFixed(<span class="number">2</span>);</span><br><span class="line">    <span class="comment">// document.getElementsByClassName('.file_percent').text((loadedPercent * 100).toFixed(2) + "%");</span></span><br><span class="line">    <span class="comment">// console.log("onUploadProgress:file:" + uploadInfo.file.name + ", fileSize:" + totalSize + ", percent:" + Math.ceil(uploadedSize * 100 / totalSize) + "%");</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// 上传凭证超时</span></span><br><span class="line">  onUploadTokenExpired: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    vm.$notify(&#123;</span><br><span class="line">      title: <span class="string">"上传凭证超时"</span>,</span><br><span class="line">      type: <span class="string">"warning"</span>,</span><br><span class="line">    &#125;);</span><br><span class="line">    resumeMessage();</span><br><span class="line">    uploader.resumeUploadWithAuth(uploadAuth);</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">upLoadVideo</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  showFileLoading();</span><br><span class="line">  uploader.startUpload();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//展示上传进度</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">showFileLoading</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  vm.animationStyle = <span class="literal">true</span>;</span><br><span class="line">  <span class="comment">// document.getElementsByClassName('.hover_all').style.display = "";</span></span><br><span class="line">  <span class="comment">// document.getElementsByClassName('.file_loading_box').style.display = "";</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//隐藏上传进度</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">hideFileLoading</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  vm.animationStyle = <span class="literal">false</span>;</span><br><span class="line">  <span class="comment">// document.getElementsByClassName('.hover_all').style.display = "none";</span></span><br><span class="line">  <span class="comment">// document.getElementsByClassName('.file_loading_box').style.display = "none";</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//重新获取凭证</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">resumeMessage</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> obj = &#123;&#125;;</span><br><span class="line">  obj.video_id = global_video_id;</span><br><span class="line">  obj.table = <span class="string">"course_article"</span>;</span><br><span class="line">  operation.operation_ajax_async(</span><br><span class="line">    <span class="string">"/api/release/video/upload"</span>,</span><br><span class="line">    obj,</span><br><span class="line">    resumeMessageSuccess</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">resumeMessageSuccess</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  uploadAuth = global_data.result.upload_auth;</span><br><span class="line">  uploader.resumeUploadWithAuth(uploadAuth);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="五、css"><a href="#五、css" class="headerlink" title="五、css"></a>五、css</h3><figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*视频*/</span></span><br><span class="line"><span class="selector-class">.aplayer_box</span> &#123;</span><br><span class="line">  <span class="attribute">float</span>: left;</span><br><span class="line">  <span class="attribute">margin-top</span>: <span class="number">10px</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">404px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.video_box</span> &#123;</span><br><span class="line">  <span class="attribute">float</span>: left;</span><br><span class="line">  <span class="attribute">margin-top</span>: <span class="number">10px</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">350px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">200px</span>;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#000</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#video</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.hover_all</span> &#123;</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#fff</span>;</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">40px</span>;</span><br><span class="line">  <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">z-index</span>: <span class="number">100</span>;</span><br><span class="line">  <span class="attribute">opacity</span>: <span class="number">0.6</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.video_list</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: inline-block;</span><br><span class="line">  <span class="attribute">line-height</span>: <span class="number">30px</span>;</span><br><span class="line">  <span class="attribute">margin-right</span>: <span class="number">20px</span>;</span><br><span class="line">  <span class="attribute">float</span>: left;</span><br><span class="line">  <span class="attribute">margin-top</span>: <span class="number">6px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.video_des</span> &#123;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100px</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">480px</span>;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">14px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.file_loading_box</span> &#123;</span><br><span class="line">  <span class="attribute">position</span>: fixed;</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">25%</span>;</span><br><span class="line">  <span class="attribute">left</span>: <span class="number">50%</span>;</span><br><span class="line">  <span class="comment">/*display: none;*/</span></span><br><span class="line">  <span class="attribute">text-align</span>: center;</span><br><span class="line">  <span class="attribute">z-index</span>: <span class="number">1000</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*动画*/</span></span><br><span class="line"><span class="selector-class">.video_list</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: inline-block;</span><br><span class="line">  <span class="attribute">line-height</span>: <span class="number">30px</span>;</span><br><span class="line">  <span class="attribute">margin-right</span>: <span class="number">20px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.iconshipin-tianchong</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#169bd5</span>;</span><br><span class="line">  <span class="attribute">margin-right</span>: <span class="number">6px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.video_des</span> &#123;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100px</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">480px</span>;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">14px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*动画效果8*/</span></span><br><span class="line"><span class="selector-class">.spinner8</span> &#123;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">100px</span> auto;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">90px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">90px</span>;</span><br><span class="line">  <span class="attribute">position</span>: relative;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.container1</span> &gt; <span class="selector-tag">div</span>,</span><br><span class="line"><span class="selector-class">.container2</span> &gt; <span class="selector-tag">div</span>,</span><br><span class="line"><span class="selector-class">.container3</span> &gt; <span class="selector-tag">div</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">14px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">14px</span>;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#169bd5</span>;</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="attribute">-webkit-animation</span>: bouncedelay <span class="number">1.2s</span> infinite ease-in-out;</span><br><span class="line">  <span class="attribute">animation</span>: bouncedelay <span class="number">1.2s</span> infinite ease-in-out;</span><br><span class="line">  <span class="attribute">-webkit-animation-fill-mode</span>: both;</span><br><span class="line">  <span class="attribute">animation-fill-mode</span>: both;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.spinner8</span> <span class="selector-class">.spinner-container</span> &#123;</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.container2</span> &#123;</span><br><span class="line">  <span class="attribute">-webkit-transform</span>: <span class="built_in">rotateZ</span>(<span class="number">45deg</span>);</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">rotateZ</span>(<span class="number">45deg</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.container3</span> &#123;</span><br><span class="line">  <span class="attribute">-webkit-transform</span>: <span class="built_in">rotateZ</span>(<span class="number">90deg</span>);</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">rotateZ</span>(<span class="number">90deg</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.circle1</span> &#123;</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.circle2</span> &#123;</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">right</span>: <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.circle3</span> &#123;</span><br><span class="line">  <span class="attribute">right</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">bottom</span>: <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.circle4</span> &#123;</span><br><span class="line">  <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">bottom</span>: <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.container2</span> <span class="selector-class">.circle1</span> &#123;</span><br><span class="line">  <span class="attribute">-webkit-animation-delay</span>: -<span class="number">1.1s</span>;</span><br><span class="line">  <span class="attribute">animation-delay</span>: -<span class="number">1.1s</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.container3</span> <span class="selector-class">.circle1</span> &#123;</span><br><span class="line">  <span class="attribute">-webkit-animation-delay</span>: -<span class="number">1s</span>;</span><br><span class="line">  <span class="attribute">animation-delay</span>: -<span class="number">1s</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.container1</span> <span class="selector-class">.circle2</span> &#123;</span><br><span class="line">  <span class="attribute">-webkit-animation-delay</span>: -<span class="number">0.9s</span>;</span><br><span class="line">  <span class="attribute">animation-delay</span>: -<span class="number">0.9s</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.container2</span> <span class="selector-class">.circle2</span> &#123;</span><br><span class="line">  <span class="attribute">-webkit-animation-delay</span>: -<span class="number">0.8s</span>;</span><br><span class="line">  <span class="attribute">animation-delay</span>: -<span class="number">0.8s</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.container3</span> <span class="selector-class">.circle2</span> &#123;</span><br><span class="line">  <span class="attribute">-webkit-animation-delay</span>: -<span class="number">0.7s</span>;</span><br><span class="line">  <span class="attribute">animation-delay</span>: -<span class="number">0.7s</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.container1</span> <span class="selector-class">.circle3</span> &#123;</span><br><span class="line">  <span class="attribute">-webkit-animation-delay</span>: -<span class="number">0.6s</span>;</span><br><span class="line">  <span class="attribute">animation-delay</span>: -<span class="number">0.6s</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.container2</span> <span class="selector-class">.circle3</span> &#123;</span><br><span class="line">  <span class="attribute">-webkit-animation-delay</span>: -<span class="number">0.5s</span>;</span><br><span class="line">  <span class="attribute">animation-delay</span>: -<span class="number">0.5s</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.container3</span> <span class="selector-class">.circle3</span> &#123;</span><br><span class="line">  <span class="attribute">-webkit-animation-delay</span>: -<span class="number">0.4s</span>;</span><br><span class="line">  <span class="attribute">animation-delay</span>: -<span class="number">0.4s</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.container1</span> <span class="selector-class">.circle4</span> &#123;</span><br><span class="line">  <span class="attribute">-webkit-animation-delay</span>: -<span class="number">0.3s</span>;</span><br><span class="line">  <span class="attribute">animation-delay</span>: -<span class="number">0.3s</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.container2</span> <span class="selector-class">.circle4</span> &#123;</span><br><span class="line">  <span class="attribute">-webkit-animation-delay</span>: -<span class="number">0.2s</span>;</span><br><span class="line">  <span class="attribute">animation-delay</span>: -<span class="number">0.2s</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.container3</span> <span class="selector-class">.circle4</span> &#123;</span><br><span class="line">  <span class="attribute">-webkit-animation-delay</span>: -<span class="number">0.1s</span>;</span><br><span class="line">  <span class="attribute">animation-delay</span>: -<span class="number">0.1s</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@-webkit-keyframes</span> bouncedelay &#123;</span><br><span class="line">  0%,</span><br><span class="line">  80%,</span><br><span class="line">  100% &#123;</span><br><span class="line">    <span class="attribute">-webkit-transform</span>: <span class="built_in">scale</span>(<span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  40% &#123;</span><br><span class="line">    <span class="attribute">-webkit-transform</span>: <span class="built_in">scale</span>(<span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@keyframes</span> bouncedelay &#123;</span><br><span class="line">  0%,</span><br><span class="line">  80%,</span><br><span class="line">  100% &#123;</span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">scale</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="attribute">-webkit-transform</span>: <span class="built_in">scale</span>(<span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  40% &#123;</span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">scale</span>(<span class="number">1</span>);</span><br><span class="line">    <span class="attribute">-webkit-transform</span>: <span class="built_in">scale</span>(<span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.file_percent</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#409eff</span>;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">24px</span>;</span><br><span class="line">  <span class="attribute">line-height</span>: <span class="number">90px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.product_cat</span> &#123;</span><br><span class="line">  <span class="attribute">margin-left</span>: <span class="number">10px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>常用</category>
        <category>常用工具</category>
      </categories>
      <tags>
        <tag>js</tag>
      </tags>
  </entry>
  <entry>
    <title>前端性能优化</title>
    <url>/2020/09/10/%E5%89%8D%E7%AB%AF%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/</url>
    <content><![CDATA[<p><img src="https://cdn.jsdelivr.net/gh/superliebe/picGo/20200731112441.jpeg" alt="img"></p>
<p>网站性能的好坏可以说直接决定了用户体验的好坏，而互联网的本质还是为人服务，因此极致的用户体验我想是每个公司都在追求的目标</p>
<a id="more"></a>

<p><strong>打开一个 url 地址，浏览器都做了什么，只有理解了做了哪些事情，才知道如何针对优化。</strong></p>
<p>浏览器能访问的资源都是通过 IP 访问的，但是为了方便我们记忆和使用网站都是使用的域名，所以当我们输入一个域名的时候就需要浏览器进行域名解析。</p>
<ol>
<li><strong>缓存中查找</strong></li>
</ol>
<p>浏览器缓存中查找（浏览器会缓存 DNS 一段时间）–&gt;系统 host 文件缓存中查找–&gt;路由器缓存中查找–&gt;</p>
<ol start="2">
<li><strong>DNS 域名解析</strong></li>
</ol>
<p>本地域名服务器–&gt;其他服务器查找（根域名服务器，一级域名服务器，二级域名服务器，三级域名服务器）。</p>
<p>从而解析到对应的 IP，浏览器主机根据 ip 地址与服务器建立 TCP 连接。</p>
<ol start="3">
<li><strong>TCP 三次握手</strong></li>
</ol>
<p>域名解析成功之后，客户端和服务器端就会有三次握手，试探链接，用语义化的语言解释就是。</p>
<blockquote>
<p>客户端 —-&gt; 服务器端 你好，我们可以链接吗</p>
<p>服务器端 —-&gt;客户端 可以，你确定要连接是吧？</p>
<p>客户端—-&gt;服务器端 确定，我们链接吧</p>
</blockquote>
<ol start="4">
<li><strong>发送 http 请求，接收 http 响应</strong></li>
</ol>
<p>连接成功之后就可以开始传输数据了，传输数据需要将用户输入的 URL 封装成 HTTP Request 请求报文，发送到服务器，服务器收到请求后会发出应答，即响应数据。</p>
<ol start="5">
<li><p><strong>断开 TCP 连接（4 次挥手）</strong></p>
<p>客户端—&gt; 服务器端 好了，我们断开连接吧？</p>
<p>服务端—&gt; 客户端 好的，我在检查一哈有没有需要在发给你的信息？</p>
<p>服务端—&gt; 客户端 好了，我们可以断开连接了</p>
<p>客户端—&gt; 服务端 好的</p>
</li>
<li><p><strong>浏览器解析</strong></p>
</li>
</ol>
<p>浏览器通过解析<code>HTML</code>，生成 DOM 树，解析<code>CSS</code>，生成 CSS 规则树，然后通过 DOM 树和 CSS 规则树生成渲染树。</p>
<p>根据渲染树布局，计算 CSS 样式，即每个节点在页面中的大小和位置等几何信息。HTML 默认是<code>流式布局</code>的，<strong>CSS 和 js 会打破这种布局</strong>，改变 DOM 的外观样式以及大小和位置。这时就要提到两个重要概念：repaint(重绘)和 reflow(回流)。</p>
<blockquote>
<p>repaint：屏幕的一部分重画，不影响整体布局，比如某个 CSS 的背景色变了，但元素的几何尺寸和位置不变。</p>
<p>reflow： 意味着元件的几何尺寸变了，我们需要重新验证并计算渲染树。是渲染树的一部分或全部发生了变化。这就是 Reflow，或是 Layout。</p>
</blockquote>
<h2 id="性能优化工具-LightHouse"><a href="#性能优化工具-LightHouse" class="headerlink" title="性能优化工具 LightHouse"></a>性能优化工具 LightHouse</h2><blockquote>
<p>LightHouse 是 Google 开源的一个自动化工具，用于改进网络应用的质量。你可以将其作为一个 Chrome 扩展程序运行，或从命令行运行。 当为 Lighthouse 提供一个要审查的网址，它将针对此页面运行一连串的测试，然后生成一个有关页面性能的报告。可以参考失败的测试，看看可以采取哪些措施来改进应用。</p>
<p>——谷歌应用商店介绍</p>
</blockquote>
<ul>
<li>首先我们可以到谷歌应用商店安装 LightHouse，点击添加至 Chrome 即可</li>
<li>如果你的浏览器版本较新的话，可以直接打开 Chrome 开发者工具 (F12)，然后打开 Audits 面板即可。Audits 面板就是集成了 LightHouse 功能的面板，我们可以根据自己的需要，选择对应的限制条件，运行 Run audits</li>
</ul>
<p><img src="https://cdn.jsdelivr.net/gh/superliebe/picGo/20200731113042.png" alt="image-20200731113042053"></p>
<p>点击 run audits 就会自动帮我们生成性能优化报告。</p>
<p>这里推荐我们使用下一代图片格式化的技术，原因是 JPEG 2000、JPEG XR 和 WebP 等图像格式通常比 PNG 或 JPEG 提供更好的压缩，这意味着更快的下载速度和更少的数据消耗。</p>
<h2 id="网络部分"><a href="#网络部分" class="headerlink" title="网络部分"></a>网络部分</h2><h3 id="DNS-Prefetch-优化"><a href="#DNS-Prefetch-优化" class="headerlink" title="DNS Prefetch 优化"></a>DNS Prefetch 优化</h3><p><strong>原理</strong></p>
<p>当我们访问<a href="https://www.baidu.com的时候，首先就需要把域名转化为对应的IP地址，DNS本身的解析是一个非常耗时的过程，打开DNS" target="_blank" rel="noopener">https://www.baidu.com的时候，首先就需要把域名转化为对应的IP地址，DNS本身的解析是一个非常耗时的过程，打开DNS</a> Prefetch 之后，浏览器会在空闲时间提前将这些域名转化为对应的 IP 地址，这里为了防止 DNS Prefetch 阻塞页面渲染影响用户体验，Chrome 浏览器的引擎并没有使用它的网络堆栈去进行预解析，而是单独开了 8 个完全异步的 Worker 线程专门负责 DNS Prefetch。</p>
<p><strong>如何使用</strong></p>
<ul>
<li><p><strong>浏览器自动解析：</strong>浏览器引擎在解析 HTML 页面的时候，会自动获取当前页面所有的 a 标签 herf 属性当中的域名，然后进行 DNS Prefetch。这里需要注意的是如果你的页面是 HTTPS，那么浏览器为了确保安全是不会开启自动解析的，这个时候我们就需要在页面头部添加如下的 meta 标签：</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"x-dns-prefetch-control"</span> <span class="attr">content</span>=<span class="string">"on"</span> /&gt;</span></span><br></pre></td></tr></table></figure>

<p>如果你不希望浏览器开启自动解析，我们添加如下 meta 标签：</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"x-dns-prefetch-control"</span> <span class="attr">content</span>=<span class="string">"off"</span> /&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>手动解析：</strong>直接添加如下 link 标签即可：</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"dns-prefetch"</span> <span class="attr">href</span>=<span class="string">"//www.baidu.com"</span> /&gt;</span></span><br></pre></td></tr></table></figure>

</li>
</ul>
<blockquote>
<p>DNS Prefetch 通过提前解析我们用到的一些常见域名，大大减少了实际访问时所花费的时间，是一个非常好的解决方案，而且如果你所在的公司有国际化的业务，合理地运用 DNS Prefetch 相信可以带来不错的效果。最后这里要说明一点，DNS Prefetch 的数量不是越多越好，大多数情况下我们设置 3-5 个常用的即可，多了反而会适得其反，毕竟 DNS Prefetch 也是会占用设备宽带。</p>
</blockquote>
<h3 id="Webpack-性能优化"><a href="#Webpack-性能优化" class="headerlink" title="Webpack 性能优化"></a>Webpack 性能优化</h3><h4 id="构建速度优化"><a href="#构建速度优化" class="headerlink" title="构建速度优化"></a><strong>构建速度优化</strong></h4><ul>
<li>npm install 过程中的优化</li>
</ul>
<p>现在一个普通的前端项目中就有几百个包，加上每个包都有相关的依赖，可想而知工作量有多大。优化的办法也很简单，就是增加版本描述文件。</p>
<ul>
<li>具体仓库地址的选择</li>
</ul>
<p>推荐使用淘宝提供的 npm 仓库</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">npm config <span class="keyword">set</span> registry https://registry.npm.taobao.org</span><br></pre></td></tr></table></figure>

<ul>
<li>提升 Webpack 构建速度</li>
</ul>
<blockquote>
<p>Webpack 的打包流程</p>
<p>可以将其理解为一个函数，配置文件则是其参数，传入合理的参数后，运行函数就能得到我们想要的结果。</p>
</blockquote>
<ol>
<li>减少不必要的编译，我们在使用 loader 处理文件的时候，应该尽量把文件范围缩小，对于一些不需要处理的文件直接忽略。</li>
</ol>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="built_in">module</span>: &#123;</span><br><span class="line">  rules: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="comment">//处理后缀名为js的文件</span></span><br><span class="line">      test: <span class="regexp">/\.js$/</span>,</span><br><span class="line">      <span class="comment">//exclude去掉不需要转译的第三方包 &amp;&amp; 或者这里使用include去声明哪些文件需要被处理</span></span><br><span class="line">      exclude: <span class="regexp">/(node_modules|bower_components)/</span>,</span><br><span class="line">      <span class="comment">//babel的常用配置项</span></span><br><span class="line">      use: &#123;</span><br><span class="line">        loader: <span class="string">"babel-loader"</span>,</span><br><span class="line">        options: &#123;</span><br><span class="line">          presets: [<span class="string">"@babel/preset-env"</span>],</span><br><span class="line">          <span class="comment">//缓存设置为开启</span></span><br><span class="line">          cacheDirectory: <span class="literal">true</span>,</span><br><span class="line">        &#125;,</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">  ];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这里我们对于不需要处理的第三方包直接使用 exclude 属性排除在外，或者需要处理的文件使用 include 属性去包含，此外上面我们在 options 配置当中增加了 cacheDirectory: true，这样对于转译结果就可以直接缓存到文件系统当中，在我们下次需要的时候直接到缓存当中读取即可。</p>
<ol start="2">
<li>使用模块热替换(HMR)，传统的如果我们没有配置模块热替换，则需要每次刷新整个页面，效率很低。而使用模块热替换之后，我们只需要重新编译发生变化的模块，不需要编译所有模块，速度上面大大提高。具体配置方法如下：</li>
</ol>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  ......</span><br><span class="line">  plugins: [</span><br><span class="line">    <span class="keyword">new</span> webpack.HotModuleReplacementPlugin(), <span class="comment">// 引入模块热替换插件</span></span><br><span class="line">  ],</span><br><span class="line">  devServer: &#123;</span><br><span class="line">    hot: <span class="literal">true</span> <span class="comment">// 开启模块热替换模式</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol start="3">
<li><p>由于现在的项目都会引用大量的第三方包，这些包基本都是不会变的，我们完全把他们打包到单独的文件当中，这就涉及到了公共代码的提取,optimization.splitChunks 插件</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">optimization: &#123;</span><br><span class="line">        splitChunks: &#123;</span><br><span class="line">          	<span class="comment">//设置那些代码用于分割</span></span><br><span class="line">            chunks: <span class="string">"all"</span>,</span><br><span class="line">         		<span class="comment">// 指定最小共享模块数(与CommonsChunkPlugin的minChunks类似)</span></span><br><span class="line">            minChunks: <span class="number">1</span>,</span><br><span class="line">         		<span class="comment">// 形成一个新代码块最小的体积</span></span><br><span class="line">            minSize: <span class="number">0</span>,</span><br><span class="line">            cacheGroups: &#123;</span><br><span class="line">                framework: &#123;</span><br><span class="line">                    test: <span class="regexp">/lodash/</span>,</span><br><span class="line">                    name: <span class="string">"vendor"</span>,</span><br><span class="line">                    enforce: <span class="literal">true</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

</li>
</ol>
<h4 id="打包文件质量优化"><a href="#打包文件质量优化" class="headerlink" title="打包文件质量优化"></a>打包文件质量优化</h4><p>如何使打包出的文件尽可能的小，这样我们在加载文件的时候才能更快。</p>
<p>1.压缩 JavaScript 代码，在压缩 JavaScript 代码的时候我们需要先将代码解析成<a href="https://segmentfault.com/a/1190000016231512?utm_source=tag-newest" target="_blank" rel="noopener">AST 语法树</a>，这个过程计算量非常大，我们常用的插件是 webpack-uglify-parallel 。通过 webpack-uglify-parallel 我们可以将每个资源的压缩过程交给单独的进程，以此来提升整体的压缩效率。这个插件并不在 Webpack 内部，需要我们单独安装。配置方法也比较简单，如下：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> os = <span class="built_in">require</span>(<span class="string">"os"</span>);</span><br><span class="line"><span class="keyword">const</span> UglifyJsParallelPlugin = <span class="built_in">require</span>(<span class="string">"webpack-uglify-parallel"</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">new</span> UglifyJsParallelPlugin(&#123;</span><br><span class="line">  <span class="comment">//开启多进程</span></span><br><span class="line">  workers: os.cpus().length,</span><br><span class="line">  mangle: <span class="literal">true</span>,</span><br><span class="line">  compressor: &#123;</span><br><span class="line">    <span class="comment">//忽略警告</span></span><br><span class="line">    warnings: <span class="literal">false</span>,</span><br><span class="line">    <span class="comment">//打开console</span></span><br><span class="line">    drop_console: <span class="literal">true</span>,</span><br><span class="line">    <span class="comment">//打开debugger</span></span><br><span class="line">    drop_debugger: <span class="literal">true</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>2.压缩 CSS 代码，上面我们介绍了压缩 JavaScript 代码的方法， 同样 CSS 代码同样也可以被压缩。WebPack4.x 我们用 MiniCssExtractPlugin 和 OptimizeCSSAssetsPlugin，具体配置如下：</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> OptimizeCSSAssetsPlugin = <span class="built_in">require</span>(<span class="string">"optimize-css-assets-webpack-plugin"</span>);</span><br><span class="line"><span class="keyword">const</span> MiniCssExtractPlugin = <span class="built_in">require</span>(<span class="string">"mini-css-extract-plugin"</span>);</span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  <span class="built_in">module</span>: &#123;</span><br><span class="line">    rules: [</span><br><span class="line">      &#123;</span><br><span class="line">        test: <span class="regexp">/\.css$/</span>,</span><br><span class="line">        use: [</span><br><span class="line">          MiniCssExtractPlugin.loader, <span class="comment">// 分离css代码</span></span><br><span class="line">          <span class="string">"css-loader"</span>,</span><br><span class="line">        ],</span><br><span class="line">      &#125;,</span><br><span class="line">    ],</span><br><span class="line">  &#125;,</span><br><span class="line">  plugins: [</span><br><span class="line">    <span class="keyword">new</span> MiniCssExtractPlugin(&#123;</span><br><span class="line">      filename: <span class="string">"static/css/[name].[contenthash:8].css"</span>, <span class="comment">//提取css存放目录</span></span><br><span class="line">    &#125;),</span><br><span class="line">    <span class="keyword">new</span> OptimizeCssAssetsPlugin(), <span class="comment">// 使用OptimizeCssAssetsPlugin对CSS进行压缩</span></span><br><span class="line">  ],</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>3.压缩图片，图片在一般项目当中都是最大的静态资源，所以图片的压缩就显得非常重要。图片压缩插件我们常用的是 imagemin-webpack-plugin。配置较为简单，如下：</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> ImageminPlugin = <span class="built_in">require</span>(<span class="string">"imagemin-webpack-plugin"</span>).default;</span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  plugins: [</span><br><span class="line">    <span class="keyword">new</span> ImageminPlugin(&#123;</span><br><span class="line">      pngquant: &#123;</span><br><span class="line">        <span class="comment">//指定压缩后的图片质量</span></span><br><span class="line">        quality: <span class="string">"95-100"</span>,</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;),</span><br><span class="line">  ],</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<ol start="4">
<li>及时升级你的 Webpack 版本来获得更优的打包速度</li>
</ol>
<h3 id="图片优化"><a href="#图片优化" class="headerlink" title="图片优化"></a>图片优化</h3><h4 id="图片格式介绍"><a href="#图片格式介绍" class="headerlink" title="图片格式介绍"></a>图片格式介绍</h4><ul>
<li><strong>PNG</strong>：是一种无损压缩的位图图形格式，因此 PNG 格式的图片色彩表现力要比其他格式的图片更好，PNG 下又细分为 PNG-8、PNG-24、PNG-32。</li>
<li><strong>JPG/JPEG</strong>：一种有损压缩的格式，在不影响人们可分辨图片质量的前提下，尽可能的压缩文件的大小，因此图片大小不会太大，图片质量也适中，换句话说，就是可以用最少的磁盘空间得到较好的图像质量。</li>
<li><strong>GIF</strong>：一种基于 LZW 算法的连续色调的无损压缩格式，应用场景主要是一些动画的展示。</li>
<li><strong>APNG</strong>：使用多个单张 PNG 连接起来的动画图片格式，支持全透明通道动画。相比于 GIF 动画，没有毛刺，质量更高，色彩效果也更好，而且它的体积相比 GIF 来说也小很多，但目前支持的浏览器并不完全。</li>
</ul>
<p><img src="https://img-blog.csdnimg.cn/20200801114411828.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3N1cGVyS00=,size_16,color_FFFFFF,t_70" alt=""></p>
<ul>
<li><p><strong>SVG</strong>：是一种基于 XML 语法的图像格式，全称是可缩放矢量图。SVG 本身是可编程性的语言(支持直接插入 DOM 当中)，可被非常多的工具读取和修改。SVG 与 JPEG 和 GIF 图像比起来，尺寸更小，且可压缩性更强，而且 SVG 图像可在任何的分辨率下被高质量地打印，SVG 可在图像质量不下降的情况下被放大，SVG 图像中的文本也是可选的，同时也是可搜索的（很适合制作地图）。</p>
</li>
<li><p><strong>WebP</strong>：谷歌开发的一种旨在加快图片加载速度的图片格式，WebP 为网络图片提供了无损和有损压缩能力，同时在有损条件下支持透明通道。据官方实验显示：无损 WebP 相比 PNG 减少 26%大小；有损 WebP 在相同的 SSIM（Structural Similarity Index，结构相似性）下相比 JPG/JPEG 减少 25%~34%的大小；有损 WebP 也支持透明通道，大小通常约为对应 PNG 的 1/3。支持动图能力，并且也占用更小空间，更适应移动网络的动图播放。但是好东西兼容性往往都不好。</p>
</li>
<li><p><strong>Base64</strong>：一种基于 64 个可打印字符来表示二进制数据的方法。实际上是一种“二进制到文本”的编码方法，它能够将给定的任意二进制数据转换（映射）为 ASCII 字符串的形式，以便在只支持文本的环境中也能够顺利地传输二进制数据。</p>
</li>
<li><p><strong>BPG</strong>： 是一个新的图片格式。用来代替 jpeg 和 webp 的方案，缺点–浏览器对其的支持程度是非常低的，目前还没有大范围使用</p>
<p><strong>优势</strong></p>
<ul>
<li>压缩比高。对于类似的质量，文件比 JPEG 小得多。</li>
<li>支持与 JPEG（灰度，YCbCr 4：2：0,4：2：2,4：4：4）相同的色度格式，以减少转换过程中的损耗。支持 Alpha 通道。还支持 RGB，YCgCo 和 CMYK 颜色空间。</li>
<li>支持无损压缩。</li>
<li>可以包括各种元数据（例如 EXIF，ICC 配置文件，XMP）。</li>
<li>动画支持。</li>
<li>相近画质前提下比 webp 更小性能。</li>
<li>据 mozilla 的研究，bpg 使用的 HEVC 编码比原生的 HEVC 性能更好，因为 BPG 的头部比 HEVC 的头部更小。</li>
<li>BPG 可以用于硬件上支持 HEVC 编解码器这种图片格式目前还没有被浏览器支持，需要 JavaScript 解码，但其优势非常明显。</li>
</ul>
</li>
</ul>
<h4 id="优化方法："><a href="#优化方法：" class="headerlink" title="优化方法："></a>优化方法：</h4><p><strong>图片懒加载</strong></p>
<p>图片懒加载是现在最常用的性能优化手段之一，对于首屏用不到的图片，我们完全可以使用懒加载在用户下拉到对应位置的时候再进行加载，避免网页打开时一下子加载过多资源。</p>
<p><strong>图片渐进显示</strong></p>
<p>JPEG 还可以细分为 Baseline JPEG（标准型）、Progressive JPEG（渐进式）。</p>
<p>Baseline JPEG 格式：</p>
<p><img src="http://img1.sycdn.imooc.com/5d27f7a60001205c03100008.gif" alt="img"></p>
<p>Progressive JPEG（渐进式）：使用了渐进显示</p>
<p><img src="https://img-blog.csdnimg.cn/20200801120801213.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3N1cGVyS00=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<p>使用 Progressive JPEG 格式图片，直接使用 Photoshop，然后在保存为 JPEG 格式的时候，将连续这个选项勾选即可。</p>
<h2 id="缓存优化"><a href="#缓存优化" class="headerlink" title="缓存优化"></a>缓存优化</h2><h3 id="CDN-缓存"><a href="#CDN-缓存" class="headerlink" title="CDN 缓存"></a>CDN 缓存</h3><p>CDN 的全称是 Content Delivery Network，即内容分发网络，基本原理是避开互联网上有可能影响数据传输速度和稳定性的瓶颈和环节，使内容能够传输的更快，更加稳定。</p>
<p><strong>原理：</strong>通过在各个地方部署相应的服务器，形成 CDN 集群，从而提高访问速度。</p>
<p><img src="https://cdn.jsdelivr.net/gh/superliebe/picGo/20200802154615.jpeg" alt="img"></p>
<p>客户端在获得 IP 地址之后，访问最近的边缘节点。边缘节点是最小的，规模也是最小的，不会缓存所有东西。如果没有找到对应资源就会去它的上一层区域节点去寻找，如果依然没有则去中心节点寻找，如果中心节点也没有，最后再去原网站去访问。这一层一层向上找的过程我们称为<strong>回源</strong>。</p>
<p><strong>优化方案：</strong></p>
<ul>
<li>使用<a href="https://www.bootcdn.cn/" target="_blank" rel="noopener">第三方的 CDN 服务</a>不妨也是一个好的选择。</li>
<li>CDN 进行静态资源缓存</li>
<li>直播传送</li>
</ul>
<h3 id="本地缓存"><a href="#本地缓存" class="headerlink" title="本地缓存"></a>本地缓存</h3><h4 id="LocalStorage"><a href="#LocalStorage" class="headerlink" title="LocalStorage"></a>LocalStorage</h4><p><strong>优势</strong></p>
<ul>
<li>大小方面相比，LocalStorage 突破了 4KB 大小体积限制，一般是 5MB(不同的浏览器大小有所区别)，这相当于一个 5MB 大小的数据库提供给我们来使用，我们可以存储更多信息，这方面我们可以有更多的想象；</li>
<li>LocalStorage 是持久存储，它并不会随着页面的关闭而消失，除非我们主动去清理，不然它会一直在本地，不会过期；</li>
<li>仅仅存储于本地，不会像 Cookie 那样，每次的 HTTP 请求都会携带。</li>
</ul>
<p><strong>劣势</strong></p>
<ul>
<li>浏览器兼容性问题，IE 只有在 IE8 以上的版本才会支持；</li>
<li>如果浏览器设置为隐私模式，那么我们无法读取 LocalStorage；</li>
<li>LocalStorage 受同源策略的限制，即协议、端口、主机地址有任何一个不同，则无法访问。</li>
</ul>
<h4 id="SessionStorage"><a href="#SessionStorage" class="headerlink" title="SessionStorage"></a>SessionStorage</h4><p>SessionStorage 只在当前会话下才会起作用，一旦我们关闭当前的 Tab，SessionStorage 也就失效了。因此，SessionStorage 是一个有时效性的存储方案。</p>
<p>使用场景：由于 SessionStorage 具有时效性，常用的业务场景比如网站常见的游客登录，就可以存储在 SessionStorage 当中，还有网站的一些临时浏览记录都可以使用 SessionStorage 来进行记录。</p>
<h4 id="Cookie"><a href="#Cookie" class="headerlink" title="Cookie"></a>Cookie</h4><p>Cookie 的大小最大只有 4KB，而且它是纯文本的文件，我们每次发起 HTTP 请求都会携带 Cookie。</p>
<p><strong>特性</strong></p>
<ul>
<li>Cookie 一旦创建成功，那么名字无法进行修改；</li>
<li>Cookie 无法跨域名，这是由 Cookie 隐私安全性所决定的，这样能够阻止非法获取其它网站的 Cookie；</li>
<li>每个单独的域名下面的 Cookie 数量不能超过 20 个。</li>
</ul>
<h4 id="IndexedDB"><a href="#IndexedDB" class="headerlink" title="IndexedDB"></a>IndexedDB</h4><p>IndexedDB 是非关系型数据库(类 NOSQL)，其实它和我们当下非常流行的 MongoDB 非常相似，我们直接使用 JavaScript 语言就可以直接进行相关的操作，不需要别的语言，大大降低了学习成本。</p>
<blockquote>
<p><strong>合理利用缓存是前端工程师的必修课</strong></p>
</blockquote>
<h3 id="HTTP-缓存策略"><a href="#HTTP-缓存策略" class="headerlink" title="HTTP 缓存策略"></a>HTTP 缓存策略</h3><p>在概念层面 HTTP 缓存策略又细分为强制缓存和协商缓存</p>
<p>最完美的效果就是我们发起请求然后取到相应的静态资源。如果服务端的静态资源没有更新，我们就下次访问的时候直接从本地读取即可；如果服务端的静态资源已经更新，那么我们再次请求的时候就要到服务器请求最新的资源，然后进行拉取。</p>
<h4 id="强制缓存"><a href="#强制缓存" class="headerlink" title="强制缓存"></a>强制缓存</h4><p>强缓存直接从缓存数据库中取出资源，无需再发送请求到服务器上</p>
<ul>
<li>*<em>expires *</em></li>
</ul>
<p>expires 是 HTTP1.0 的字段，通过指定一个具体的绝对时间值作为缓存资源的过期时间</p>
<p><img src="https://cdn.jsdelivr.net/gh/superliebe/picGo/20200802181956.jpeg" alt="img"></p>
<ul>
<li><strong>Cache-Control</strong></li>
</ul>
<p>Cache-Control 是 HTTP1.1 才有的字段，Cache-Control 设置的是一个相对时间，单位是秒，可以更加精准地控制资源缓存</p>
<p><img src="https://cdn.jsdelivr.net/gh/superliebe/picGo/20200802182325.jpeg" alt="img"></p>
<p>Cache-Control 可设置的字段值较多，下面我们一一来介绍。</p>
<ul>
<li>public：设置了该字段值的资源表示可以被任何对象（包括：发送请求的客户端、代理服务器等等）缓存。这个字段值不常用，一般还是使用<strong>max-age=</strong>来精确控制；</li>
<li>private：设置了该字段值的资源只能被用户浏览器缓存，不允许任何代理服务器缓存。在实际开发当中，对于一些含有用户信息的 HTML，通常都要设置这个字段值，避免代理服务器(CDN)缓存；</li>
<li>no-cache：设置了该字段需要先和服务端确认返回的资源是否发生了变化，如果资源未发生变化，则直接使用缓存好的资源；</li>
<li>no-store：设置了该字段表示禁止任何缓存，每次都会向服务端发起新的请求，拉取最新的资源；</li>
<li>max-age=：设置缓存的最大有效期，单位为秒；</li>
<li>s-maxage=：优先级高于 max-age=，仅适用于共享缓存(CDN)，优先级高于<code>max-age</code>或者<code>Expires</code>头；</li>
<li>max-stale[=]：设置了该字段表明客户端愿意接收已经过期的资源，但是不能超过给定的时间限制。</li>
</ul>
<p>上面就是强制缓存的常用字段，实际开发当中 expires 和 Cache-Control 一般都要进行设置，这是为了兼容不支持 HTTP1.1 的环境。两者同时存在，Cache-Control 的优先级要高于 expires。</p>
<p><strong>强缓存状态码为<code>200</code></strong></p>
<ul>
<li>from memory cache（缓存资源在内存中）</li>
<li>from disk cache（缓存资源在硬盘中）</li>
</ul>
<p><img src="https://img-blog.csdnimg.cn/20200802182647710.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3N1cGVyS00=,size_16,color_FFFFFF,t_70" alt=""></p>
<h4 id="协商缓存"><a href="#协商缓存" class="headerlink" title="协商缓存"></a>协商缓存</h4><p>对比缓存是需要经过服务器确认是否使用缓存的机制，其 http 状态码为<code>304</code>，意为<code>not modified</code>。</p>
<p>如果没有命中强制缓存，如果设置了协商缓存，这个时候协商缓存就会发挥作用了。</p>
<ul>
<li><strong>Last-Modified/If-Modified-Since</strong></li>
</ul>
<p>最后一次的修改时间，设置方法和我们上面讲的强制缓存的设置方法一样，都是设置一个时间戳，同样它也是由服务端放到 Response Headers 返回给我们</p>
<p><img src="https://cdn.jsdelivr.net/gh/superliebe/picGo/20200802183724.png" alt="image-20200802183724257"></p>
<p>如果有设置协商缓存，我们在首次请求的时候，返回的 Response Headers 会带有 Last-Modified。当再次请求没有命中强制缓存的时候，这个时候我们的 Request Headers 就会携带 If-Modified-Since 字段，它的值就是我们第一次请求返回给我们的 Last-Modified 值。服务端接收到资源请求之后，根据 If-Modified-Since 的字段值和服务端资源最后的修改时间是否一致来判断资源是否有修改。<strong>如果没有修改，则返回的状态码为 304；如果有修改，则返回新的资源，状态码为 200</strong>。</p>
<p><strong>缺陷</strong></p>
<ol>
<li>服务端对 Last-Modified 标注的最后修改时间只能精确到秒级，如果某些文件在 1 秒钟以内被修改多次的话，这个时候服务端无法准确标注文件的修改时间。</li>
<li>服务端有时候会定期生成一些文件，有时候文件的内容并没有任何变化，但这个时候 Last-Modified 会发生改变，导致文件无法使用缓存。</li>
</ol>
<ul>
<li><strong>Etag/If-None-Match</strong></li>
</ul>
<p>通常是根据文件的具体内容计算出一个 hash 值，只要文件的内容不变，它就不会发生改变，保证了唯一性，这一点可以类比人的指纹。</p>
<p><img src="https://cdn.jsdelivr.net/gh/superliebe/picGo/20200802184000.png" alt="image-20200802184000092"></p>
<p>如果我们有设置协商缓存，在首次请求的时候，返回的 Response Headers 会带有 Etag 值。当再次请求没有命中强制缓存的时候，这个时候我们的 Request Headers 就会携带 If-None-Match 字段，它的值就是我们第一次请求返回给我们的 Etag 值。服务端再用 Etag 来进行比较，如果相同就直接使用缓存，如果不同再从服务端拉取新的资源。</p>
<h4 id="nginx-缓存配置"><a href="#nginx-缓存配置" class="headerlink" title="nginx 缓存配置"></a>nginx 缓存配置</h4><ul>
<li><strong>expires 和 cache-control</strong></li>
</ul>
<p>打开 Nginx 的配置文件 nginx.conf</p>
<figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">// expires:给图片设置过期时间30天，这里也可以设置其它类型文件</span><br><span class="line"><span class="attribute">location</span> <span class="regexp">~ \.(gif|jpg|jpeg|png)$</span> &#123;</span><br><span class="line">        <span class="attribute">root</span> /var/www/img/;</span><br><span class="line">        <span class="attribute">expires</span> <span class="number">30d</span>;</span><br><span class="line">&#125;</span><br><span class="line">// cache-control:给图片设置过期时间36秒，这里也可以设置其它类型文件</span><br><span class="line"><span class="attribute">location</span> <span class="regexp">~ \.(gif|jpg|jpeg|png)$</span> &#123;</span><br><span class="line">        <span class="attribute">root</span> /var/www/img/;</span><br><span class="line">        <span class="attribute">add_header</span>    Cache-Control  max-age=<span class="number">3600</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><strong>Last-Modified 和 Etag</strong></li>
</ul>
<p>Last-Modified 在 Nginx 当中是默认启用的。</p>
<p>Etag 需要单独配置</p>
<p>需要先安装 Etag 模块；安装成功之后，仍然打开 nginx.conf 文件，确保当中没有出现 etgoff，然后添加如下配置，即可开启 Etag：</p>
<figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line"><span class="attribute">location</span> <span class="regexp">~ .*\.(gif|jpg|jpeg|png)$</span> &#123;</span><br><span class="line">   <span class="attribute">FileETag</span> <span class="literal">on</span>;</span><br><span class="line">   etag_format "%X%X%X"; //这里格式化规则可以修改</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>

<h4 id="webpack-打包缓存配置"><a href="#webpack-打包缓存配置" class="headerlink" title="webpack 打包缓存配置"></a>webpack 打包缓存配置</h4><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    entry: &#123;</span><br><span class="line">        index: <span class="string">'./test/test.js'</span>,</span><br><span class="line">        about： <span class="string">'./test/about.js'</span></span><br><span class="line">    &#125;,</span><br><span class="line">    output: &#123;</span><br><span class="line">    		<span class="comment">// 打包出来的JavaScript文件用chunkhash</span></span><br><span class="line">        filename: <span class="string">'[name].[chunkhash:8].js'</span>,</span><br><span class="line">        path: path.resolve(__dirname, <span class="string">'dist'</span>)</span><br><span class="line">    &#125;,</span><br><span class="line">  	<span class="built_in">module</span>: &#123;</span><br><span class="line">        rules: [</span><br><span class="line">            &#123;</span><br><span class="line">              	test: <span class="regexp">/\.css$/</span>,</span><br><span class="line">               	use: [&#123;<span class="attr">loader</span>: MiniCssExtractPlugin.loader&#125;,<span class="string">'css-loader'</span>]</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">              	 test: <span class="regexp">/\.(png|jpe?g|gif|svg)(\?.*)?$/</span>,</span><br><span class="line">       					 loader: <span class="string">'file-loader'</span>,</span><br><span class="line">                 query: &#123;</span><br><span class="line">                     <span class="comment">// 图片文件使用hash</span></span><br><span class="line">                     name: <span class="string">'[name].[ext]?[hash]'</span>,</span><br><span class="line">                     outputPath: <span class="string">'static/img/'</span>,</span><br><span class="line">                     publicPath: <span class="string">'/dist/static/img/'</span></span><br><span class="line">                 &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        ]</span><br><span class="line">    &#125;,</span><br><span class="line">   plugins: [</span><br><span class="line">        <span class="keyword">new</span> CleanWebpackPlugin(),</span><br><span class="line">     		<span class="keyword">new</span> MiniCssExtractPlugin(&#123;</span><br><span class="line">     		    <span class="comment">// 抽离的CSS文件用contenthash</span></span><br><span class="line">            filename: <span class="string">'[name].[contenthash:8].css'</span>,</span><br><span class="line">	          chunkFilename: <span class="string">'[id].css'</span></span><br><span class="line">        &#125;),</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="渲染与性能优化"><a href="#渲染与性能优化" class="headerlink" title="渲染与性能优化"></a>渲染与性能优化</h2><p>浏览器的渲染引擎</p>
<ul>
<li>IE（Trident）</li>
<li>Chrome（Blink）</li>
<li>Firefox（Gecko）</li>
<li>Opera（Blink）</li>
<li>Safari（Webkit）</li>
<li>UC（U3）</li>
<li>QQ 浏览器微信（X5/Blink）</li>
</ul>
<p><img src="https://cdn.jsdelivr.net/gh/superliebe/picGo/20200802191520.jpeg" alt="img"></p>
<p>解析 HTML 和解析 CSS 是并行处理的，如果遇到 <code>&lt;script&gt;</code>标签会停止解析，先执行标签当中 JavaScript；如果是外联方式，也需要等待下载并且执行完对应的 JavaScript 代码，然后才能够继续执行解析 HTML 的工作。</p>
<h3 id="针对渲染原理进行相关优化"><a href="#针对渲染原理进行相关优化" class="headerlink" title="针对渲染原理进行相关优化"></a>针对渲染原理进行相关优化</h3><h4 id="css-优化"><a href="#css-优化" class="headerlink" title="css 优化"></a>css 优化</h4><p>CSS 解析和 HTML 解析是同步进行的，那么一个 HTML 文档首先解析的肯定是 HTML，然后才是 CSS，这就导致了 HTML 解析完成后，往往需要等待 CSS 解析。如果 CSS 没有解析完成，我们就需要一直等，这里就是 CSS 阻塞了相关的渲染。因此针对这种情况，我们往往把 CSS 样式表全部通过 <code>&lt;style&gt;</code> 标签内联到网页当中</p>
<h4 id="js-优化"><a href="#js-优化" class="headerlink" title="js 优化"></a>js 优化</h4><p>JavaScript 既会阻塞 HTML 解析，也会阻塞 CSS 解析。因此我们可以改变 JavaScript 的加载方式或者加载时机来进行优化：</p>
<ol>
<li>尽量将 JavaScript 文件放在 body 的底部；</li>
<li>body 中间尽量不要写 <code>&lt;script&gt;</code> 标签；</li>
<li>我们都知道通过 <code>&lt;script&gt;</code> 标签引入 JavaScript 代码的方式共有 3 种，一个就是直接引入，另外两种分别用添加 async 属性和 defer 属性的方式引入。如果设置为 defer，那么整个 JavaScript 的加载是异步的，并且在 DOMContentLoaded 事件之后才会执行当中的代码；如果设置为 async，整个 JavaScript 的加载是异步的，但是不会阻塞浏览器的任何操作，加载完成后执行相关代码。所以这里的最佳实践是 async 执行时机不确定，不建议用于业务代码，但可用于单独的代码，如第三方统计代码。而 defer 是在 DOMContentLoaded 事件之后执行，所以 defer 一般用于业务代码。</li>
</ol>
<h3 id="首屏空白优化"><a href="#首屏空白优化" class="headerlink" title="首屏空白优化"></a>首屏空白优化</h3><p>随着 React、Vue 等框架的流行，SPA 应用越来越多，由于 SPA 应用打包生成的 JavaScript 文件非常大，首屏都是等这个巨大的 JavaScript 文件加载完成之后，才能够开始渲染，这就导致首屏加载必然会出现白屏问题。</p>
<h4 id="骨架屏"><a href="#骨架屏" class="headerlink" title="骨架屏"></a>骨架屏</h4><p>骨架屏就是我们页面在未完成加载的时候，先用一些简单图形大概勾勒出整个页面，给用户视觉上更好的体验，而不是整个页面都是白屏。等到资源加载完毕，再把骨架屏替换掉即可。整个过程我们用一张图来表示就非常容易理解</p>
<p><img src="https://cdn.jsdelivr.net/gh/superliebe/picGo/20200802192923.jpeg" alt="img"></p>
<p>目前使用比较广泛的是 <a href="https://github.com/ElemeFE/page-skeleton-webpack-plugin" target="_blank" rel="noopener"><strong>page-skeleton-webpack-plugin</strong></a> 这个插件，它是一个 Webpack 插件，可以根据具体的页面生成对应的骨架屏。具体的<a href="https://github.com/ElemeFE/page-skeleton-webpack-plugin" target="_blank" rel="noopener">配置方案</a>这里写得非常详细，这里不再详细罗列，而且它支持动态调试，对于多个页面的使用非常方便。</p>
<h4 id="使用-Code-Splitting"><a href="#使用-Code-Splitting" class="headerlink" title="使用 Code Splitting"></a><strong>使用 Code Splitting</strong></h4><p>代码分割（Code Splitting）是指将项目代码构建打包（Bundling）后，根据指定规则分割成多个 bundles（输出文件），这些模块文件可以被按需动态加载或者并行加载，可以用来优化代码加载时的资源大小及优先级。正确使用代码分割，可以优化提升资源加载效率。</p>
<p>使用按需加载。按需加载的方案非常多，最常用的就是使用 ES6 新增的 import() 方法。使用方法也非常简单，我们只需要在我们的路由文件当中引入即可，如下：</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> Test1 = <span class="function"><span class="params">()</span> =&gt;</span></span><br><span class="line">  <span class="keyword">import</span>(</span><br><span class="line">    <span class="comment">/* webpackChunkName: "Test1" */</span></span><br><span class="line">    <span class="string">"./pages/Test1.vue"</span></span><br><span class="line">  );</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> Test2 = <span class="function"><span class="params">()</span> =&gt;</span></span><br><span class="line">  <span class="keyword">import</span>(</span><br><span class="line">    <span class="comment">/* webpackChunkName: "Test2" */</span></span><br><span class="line">    <span class="string">"./pages/Test2.vue"</span></span><br><span class="line">  );</span><br></pre></td></tr></table></figure>

<p>这里 Webpack 配置的输出也要做对应的修改，如下：</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  output: &#123;</span><br><span class="line">    chunkFilename: <span class="string">"[name].chunk.js"</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h4 id="使用资源预加载"><a href="#使用资源预加载" class="headerlink" title="使用资源预加载"></a><strong>使用资源预加载</strong></h4><p>简单来说就是在当前页面加载完成后或者其它空闲时间，我们可以加载下面页面会用到的资源。</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&lt;link rel=<span class="string">"preload"</span> href=<span class="string">"style.css"</span> <span class="keyword">as</span>=<span class="string">"style"</span>&gt;</span><br><span class="line">&lt;link rel=<span class="string">"preload"</span> href=<span class="string">"main.js"</span> <span class="keyword">as</span>=<span class="string">"script"</span>&gt;</span><br></pre></td></tr></table></figure>

<p>我们预加载了 CSS 和 JavaScript 文件。所以在随后的页面渲染中，一旦需要使用它们，它们就会立即可用。</p>
<h3 id="DOM-的优化"><a href="#DOM-的优化" class="headerlink" title="DOM 的优化"></a>DOM 的优化</h3><p>在日常开发当中，不管我们是否使用框架，书写 HTML 是不可避免的，并且操作 DOM 是非常耗费性能的，如果操作错误还会引起回流。</p>
<ol>
<li>注意语义化：有利于浏览器解析时间，而且对搜索引擎的抓取也是十分友好的。</li>
<li>尽量减少无用的标签：不要嵌套多个无用的 div，对一下没有用的 div 要及时删除，能用 CSS 实现的，尽量不要使用相关的 HTML 元素。</li>
</ol>
<h3 id="重绘与回流"><a href="#重绘与回流" class="headerlink" title="重绘与回流"></a>重绘与回流</h3><p>回流：当有元素的大小、布局、结构等发生改变时，就会触发回流，每个页面在首次加载的时候都需要进行至少一次回流。</p>
<p>重绘：有元素属性需要更新，这些属性只是影响元素的外观、风格，那么则会触发重绘。</p>
<p><strong>如何减少重绘与回流</strong></p>
<ul>
<li>避免使用表格布局方法</li>
<li>减少触发它们操作的次数</li>
<li>把相关的属性的缓存起来，然后最后在对其进行处理</li>
<li>修改样式的时候使用类名的方式一次性进行修改，而不是使用 style 的方式</li>
<li>对一些涉及到复杂动画的元素，在不影响相关布局的情况下，尽量将其 position 属性设置为 absolute 或者 fixed</li>
</ul>
<h3 id="Event-Loop"><a href="#Event-Loop" class="headerlink" title="Event Loop"></a>Event Loop</h3><p>JavaScript 是单线程的语言，它在一个时间点只能处理一件事情，完成一件事情之后才可以继续另外一件事情。JavaScript 为了解决这个问题，于是产生了使用异步这种方式来模拟多线程，而支撑异步的就是 Event Loop。</p>
<p><img src="http://img1.sycdn.imooc.com/5d522d1000013e8c06830503.png" alt="img"></p>
<ul>
<li>heap</li>
</ul>
<p>heap 是堆这种数据结构，堆其实就是我们平时所说的二叉树，这里存放的主要是 JavaScript 当中的对象，也是 Event Loop 当中一个重要的环节。</p>
<ul>
<li>stack</li>
</ul>
<p>栈，后进先出，代码执行的时候，会将代码压入栈中进行执行，当任务完成之后，根据栈后进先出的特点，再将各个任务进行出栈。</p>
<p>假定没有异步任务的情况下 JavaScript 的执行顺序，当我们遇到异步任务，比如：setTimeout、addEventListener 这类异步任务的时候，这个时候异步任务不会直接被压入到栈中，而是会交给浏览器的 Web API 进行维护，当这些异步任务执行完成之后，会在任务队列当中放置对应事件。当执行栈当中任务为空的时候，然后浏览器读取任务队列，再把对应的异步任务压入到执行栈执行，这就是我们经常说的事件循环。</p>
<ul>
<li>Macrotask/Microtask</li>
</ul>
<p>任务队列 Microtask 优先级是高于 Macrotask 的，Microtask 当中任务不会一个一个压入执行栈，而是所有任务直接压入栈中，当 Microtask 当中的任务执行完毕后，然后我们再从 Macrotask 中取栈顶的第一个任务进行执行。</p>
<p>那么哪些任务属于 Microtask，哪些任务属于 Macrotask 呢，这里我做了一个大概的总结，如下：</p>
<p>Macrotask：<code>setTimeout</code>、<code>setInterval</code>、<code>I/O</code>、<code>UI Rendering</code>、<code>script当中的所有代码</code>、<code>setImmediate(Node)</code></p>
<p>Microtask：<code>process.nextTick(node)</code> 、<code>Promise</code> 、<code>MutationObserver</code></p>
<p><strong>优化方法</strong></p>
<p>当开始执行的时候，首先 script 标签当中的代码出 Macrotask，被压入到执行栈执行，这个时候就会有对应的任务被推入 Macrotask 和 Microtask 当中，上面我们已经说过 Microtask 是所有任务一起执行，而 Macrotask 则是任务一个一个执行，那么页面渲染是在 Microtask 之后才进行的，如果我们在异步操作当中进行 DOM 操作，我们尽量将这个操作用 Microtask 当中的任务包一下，这样我们就可以在页面渲染之前就执行这个 DOM 操作了。</p>
<h3 id="防抖节流"><a href="#防抖节流" class="headerlink" title="防抖节流"></a>防抖节流</h3><p><a href="http://demo.nimius.net/debounce_throttle/" target="_blank" rel="noopener">点击这里</a>可以体验防抖和节流的效果</p>
<h4 id="节流-throttle"><a href="#节流-throttle" class="headerlink" title="节流(throttle)"></a>节流(throttle)</h4><p>不管你在一段时间内如何不停地触发事件，只要设置了节流，就会每隔一段时间执行一次</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//防抖</span></span><br><span class="line"><span class="keyword">const</span> debounce = <span class="function">(<span class="params">(</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">let</span> timeout;</span><br><span class="line">  <span class="keyword">return</span> <span class="function">(<span class="params">callback, wait</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (timeout) clearTimeout(timeout);</span><br><span class="line">    timeout = setTimeout(callback, wait);</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure>

<h4 id="防抖-debounce"><a href="#防抖-debounce" class="headerlink" title="防抖(debounce)"></a>防抖(debounce)</h4><p>防抖的原理则是不管你在一段时间内如何不停的触发事件，只要设置了防抖，则只在触发 n 秒后才执行。</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 防抖</span></span><br><span class="line"><span class="keyword">const</span> debounce = <span class="function">(<span class="params">(</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">let</span> timer = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="function">(<span class="params">callback, wait</span>) =&gt;</span> &#123;</span><br><span class="line">    clearTimeout(timer);</span><br><span class="line">    timer = setTimeout(callback, wait);</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure>

<h3 id="服务端渲染"><a href="#服务端渲染" class="headerlink" title="服务端渲染"></a>服务端渲染</h3><blockquote>
<p>服务端渲染在一般场景下其实是无需使用的，虽然它可以解决白屏问题以及 SEO 优化，但是它对服务端要求非常高</p>
</blockquote>
<ul>
<li><strong>客户端渲染(CSR)</strong></li>
</ul>
<p>页面初始加载的 HTML 文档中无内容，需要下载执行 JS 文件，由浏览器动态生成页面，并通过 JavaScript 进行页面交互事件与状态管理，这样的页面渲染采用的就是客户端渲染。</p>
<ul>
<li><strong>服务端渲染(SSR)</strong></li>
</ul>
<p>在服务器端执行一次，用于实现服务器端渲染（首屏直出）；在客户端再执行一次，用于接管页面交互。这样页面渲染采用的就是服务端渲染。</p>
<ul>
<li><strong>本地离线渲染(NSR)</strong></li>
</ul>
<p>通过离线资源和预加载的方式，native 提前完成渲染页面并放入缓存，等用户点击的时候瞬间呈现页面</p>
]]></content>
      <categories>
        <category>前端性能优化</category>
      </categories>
      <tags>
        <tag>html</tag>
      </tags>
  </entry>
</search>
